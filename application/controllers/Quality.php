<?php
defined('BASEPATH') or exit('No direct script access allowed');

class Quality extends CI_Controller
{
    private $module;

    public function __construct()
    {
        parent::__construct();
        $this->load->library('session');

        if ($this->session->userdata('isLogIn') === false && $this->uri->segment(2) != 'track')
            redirect('login');

        $this->load->model(
            array(
                'dashboard_model',
                'efeedor_model',
                'tickets_model',
                'quality_model',
                'setting_model',
                'departmenthead_model',
            )
        );

        $dates = get_from_to_date();
        if (isset($_SESSION['from_date']) && isset($_SESSION['to_date'])) {
            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
        } else {
            $fdate = date('Y-m-d', time());
            $tdate = date('Y-m-d', strtotime('-365 days'));
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        }

        $this->module = 'inpatient_modules';

        $this->session->set_userdata([
            'active_menu' => array('ip_dashboard', 'ip_ticket', 'ip_reports', 'ip_patients', 'ip_settings', 'ip_dep', 'ip_analysis'),
        ]);

        if (ismodule_active('QUALITY') === false && $this->uri->segment(2) != 'track')
            redirect('dashboard/noaccess');
    }

    // RESERVED FOR DEVELOPER OR COMPANY ACCESS
    public function index()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');

        if (ismodule_active('QUALITY') === true) {

            $data['title'] = 'IP MODULE CONFIGURATION';
            $data['content'] = $this->load->view('qualitymodules/developer', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }



    // SUPER ADMIN AND ADMIN LOGIN
    public function quality_welcome_page()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
		
		
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $data['title'] = 'QUALITY INDICATOR MANAGER DASHBOARD';
            #------------------------------#
            $data['content'] = $this->load->view('quality_welcome_page', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function delete_kpi($id)
    {
        $table = $this->input->get('table');

        if (empty($table)) {
            $this->session->set_flashdata('error', 'No table specified for deletion.');
            redirect($_SERVER['HTTP_REFERER']);
            return;
        }

        $tables = [
        // CQI3a
        'bf_feedback_CQI3a1',
        'bf_feedback_CQI3a2',
        'bf_feedback_CQI3a3',
        'bf_feedback_CQI3a4',
        'bf_feedback_CQI3a5',
        'bf_feedback_CQI3a6',
        'bf_feedback_CQI3a7',
        'bf_feedback_CQI3a8',
        'bf_feedback_CQI3a9',
        'bf_feedback_CQI3a10',
        'bf_feedback_CQI3a11',
        'bf_feedback_CQI3a12',
        'bf_feedback_CQI3a13',
        'bf_feedback_CQI3a14',
        'bf_feedback_CQI3a15',
        'bf_feedback_CQI3a16',
        'bf_feedback_CQI3a17',
        'bf_feedback_CQI3a18',
        'bf_feedback_CQI3a19',
        'bf_feedback_CQI3a20',
        'bf_feedback_CQI3a21',
        'bf_feedback_CQI3a22',

        // CQI3b
        'bf_feedback_CQI3b1',
        'bf_feedback_CQI3b2',
        'bf_feedback_CQI3b3',
        'bf_feedback_CQI3b4',
        'bf_feedback_CQI3b5',
        'bf_feedback_CQI3b6',
        'bf_feedback_CQI3b7',
        'bf_feedback_CQI3b8',
        'bf_feedback_CQI3b9',
        'bf_feedback_CQI3b10',
        'bf_feedback_CQI3b11',
        'bf_feedback_CQI3b12',
        'bf_feedback_CQI3b13',

        // CQI3c
        'bf_feedback_CQI3c1',
        'bf_feedback_CQI3c2',
        'bf_feedback_CQI3c3',
        'bf_feedback_CQI3c4',
        'bf_feedback_CQI3c5',
        'bf_feedback_CQI3c6',
        'bf_feedback_CQI3c7',
        'bf_feedback_CQI3c8',
        'bf_feedback_CQI3c9',
        'bf_feedback_CQI3c10',
        'bf_feedback_CQI3c11',
        'bf_feedback_CQI3c12',
        'bf_feedback_CQI3c13',
        'bf_feedback_CQI3c14',

        // CQI3d
        'bf_feedback_CQI3d1',
        'bf_feedback_CQI3d2',
        'bf_feedback_CQI3d3',
        'bf_feedback_CQI3d4',
        'bf_feedback_CQI3d5',

        // CQI3e
        'bf_feedback_CQI3e1',
        'bf_feedback_CQI3e2',
        'bf_feedback_CQI3e3',
        'bf_feedback_CQI3e4',
        'bf_feedback_CQI3e5',
        'bf_feedback_CQI3e6',
        'bf_feedback_CQI3e7',
        'bf_feedback_CQI3e8',
        'bf_feedback_CQI3e9',

        // CQI3f
        'bf_feedback_CQI3f1',
        'bf_feedback_CQI3f2',
        'bf_feedback_CQI3f3',
        'bf_feedback_CQI3f4',
        'bf_feedback_CQI3f5',
        'bf_feedback_CQI3f6',
        'bf_feedback_CQI3f7',
        'bf_feedback_CQI3f8',
        'bf_feedback_CQI3f9',
        'bf_feedback_CQI3f10',

        // CQI3g
        'bf_feedback_CQI3g1',
        'bf_feedback_CQI3g2',
        'bf_feedback_CQI3g3',
        'bf_feedback_CQI3g4',
        'bf_feedback_CQI3g5',
        'bf_feedback_CQI3g6',

        // CQI3h
        'bf_feedback_CQI3h1',
        'bf_feedback_CQI3h2',
        'bf_feedback_CQI3h3',
        'bf_feedback_CQI3h4',
        'bf_feedback_CQI3h5',
        'bf_feedback_CQI3h6',
        'bf_feedback_CQI3h7',
        'bf_feedback_CQI3h8',
        'bf_feedback_CQI3h9',

        // CQI3j
        'bf_feedback_CQI3j1',
        'bf_feedback_CQI3j2',
        'bf_feedback_CQI3j3',
        'bf_feedback_CQI3j4',
        'bf_feedback_CQI3j5',
        'bf_feedback_CQI3j6',
        'bf_feedback_CQI3j7',
        'bf_feedback_CQI3j8',
        'bf_feedback_CQI3j9',
        'bf_feedback_CQI3j10',
        'bf_feedback_CQI3j11',
        'bf_feedback_CQI3j12',
        'bf_feedback_CQI3j13',
        'bf_feedback_CQI3j14',
        'bf_feedback_CQI3j15',
        'bf_feedback_CQI3j16',
        'bf_feedback_CQI3j17',
        'bf_feedback_CQI3j18',
        'bf_feedback_CQI3j19',
        'bf_feedback_CQI3j20',
        'bf_feedback_CQI3j21',
        'bf_feedback_CQI3j22',
        'bf_feedback_CQI3j23',
        'bf_feedback_CQI3j24',
        'bf_feedback_CQI3j25',
        'bf_feedback_CQI3j26',
        'bf_feedback_CQI3j27',
        'bf_feedback_CQI3j28',
        'bf_feedback_CQI3j29',
        'bf_feedback_CQI3j30',
        'bf_feedback_CQI3j31',
        'bf_feedback_CQI3j32',
        'bf_feedback_CQI3j33',
        'bf_feedback_CQI3j34',

        // CQI4a
        'bf_feedback_CQI4a1',
        'bf_feedback_CQI4a2',
        'bf_feedback_CQI4a3',
        'bf_feedback_CQI4a4',
        'bf_feedback_CQI4a5',

        // CQI4b
        'bf_feedback_CQI4b1',
        'bf_feedback_CQI4b2',
        'bf_feedback_CQI4b3',
        'bf_feedback_CQI4b4',
        'bf_feedback_CQI4b5',
        'bf_feedback_CQI4b6',
        'bf_feedback_CQI4b7',
        'bf_feedback_CQI4b8',

        // CQI4c
        'bf_feedback_CQI4c1',
        'bf_feedback_CQI4c2',
        'bf_feedback_CQI4c3',
        'bf_feedback_CQI4c4',
        'bf_feedback_CQI4c5',
        'bf_feedback_CQI4c6',
        'bf_feedback_CQI4c7',
        'bf_feedback_CQI4c8',
        'bf_feedback_CQI4c9',
        'bf_feedback_CQI4c10',
        'bf_feedback_CQI4c11',
        'bf_feedback_CQI4c12',
        'bf_feedback_CQI4c13',
        'bf_feedback_CQI4c14',

        // CQI4d
        'bf_feedback_CQI4d1',
        'bf_feedback_CQI4d2',
        'bf_feedback_CQI4d3',
        'bf_feedback_CQI4d4',
        'bf_feedback_CQI4d5',
        'bf_feedback_CQI4d6',
        'bf_feedback_CQI4d7',
        'bf_feedback_CQI4d8',
        'bf_feedback_CQI4d9',
        'bf_feedback_CQI4d10',
        'bf_feedback_CQI4d11',

        // CQI4e
        'bf_feedback_CQI4e1',
        'bf_feedback_CQI4e2',
        'bf_feedback_CQI4e3',
        'bf_feedback_CQI4e4',
        'bf_feedback_CQI4e5',
        'bf_feedback_CQI4e6',
        'bf_feedback_CQI4e7',
        'bf_feedback_CQI4e8',

        // CQI4f
        'bf_feedback_CQI4f1',
        'bf_feedback_CQI4f2',
        'bf_feedback_CQI4f3',
        'bf_feedback_CQI4f4',
        'bf_feedback_CQI4f5',
        'bf_feedback_CQI4f6',
        'bf_feedback_CQI4f7',

        // CQI4g
        'bf_feedback_CQI4g1',
        'bf_feedback_CQI4g2',
        'bf_feedback_CQI4g3',
        'bf_feedback_CQI4g4',
        'bf_feedback_CQI4g5',
        'bf_feedback_CQI4g6',

        // CQI3k
        'bf_feedback_CQI3k1',
        'bf_feedback_CQI3k2',
        'bf_feedback_CQI3k3',
        'bf_feedback_CQI3k4',
        'bf_feedback_CQI3k5',
        'bf_feedback_CQI3k6',
        'bf_feedback_CQI3k7',
        'bf_feedback_CQI3k8',
        'bf_feedback_CQI3k9',
        'bf_feedback_CQI3k10',
        'bf_feedback_CQI3k11',
        'bf_feedback_CQI3k12',
        'bf_feedback_CQI3k13',
        'bf_feedback_CQI3k14',
        'bf_feedback_CQI3k15',
        'bf_feedback_CQI3k16',
        'bf_feedback_CQI3k17',
        'bf_feedback_CQI3k18',
        'bf_feedback_CQI3k19',
        'bf_feedback_CQI3k20',
        'bf_feedback_CQI3k21',
        'bf_feedback_CQI3k22',
        'bf_feedback_CQI3k23',
        'bf_feedback_CQI3k24',
        'bf_feedback_CQI3k25',
        'bf_feedback_CQI3k26',
        'bf_feedback_CQI3k27',
        'bf_feedback_CQI3k28',
        'bf_feedback_CQI3k29',
        'bf_feedback_CQI3k30',
        'bf_feedback_CQI3k31',
        'bf_feedback_CQI3k32',
        'bf_feedback_CQI3k33',
        'bf_feedback_CQI3k34',
        'bf_feedback_CQI3k35',
        'bf_feedback_CQI3k36',
        'bf_feedback_CQI3k37',
        'bf_feedback_CQI3k38',
        'bf_feedback_CQI3k39',
        'bf_feedback_CQI3k40',
        'bf_feedback_CQI3k41',
        'bf_feedback_CQI3k42',
        'bf_feedback_CQI3k43',
        'bf_feedback_CQI3k44',
        'bf_feedback_CQI3k45',
        'bf_feedback_CQI3k46',
        'bf_feedback_CQI3k47',
        'bf_feedback_CQI3k48',
        'bf_feedback_CQI3k49',
        'bf_feedback_CQI3k50',
        'bf_feedback_CQI3k51',
        'bf_feedback_CQI3k52',
        'bf_feedback_CQI3k53',
        'bf_feedback_CQI3k54',
        'bf_feedback_CQI3k55',
        'bf_feedback_CQI3k56',
        'bf_feedback_CQI3k57',
        'bf_feedback_CQI3k58',
        'bf_feedback_CQI3k59',
        'bf_feedback_CQI3k60',
        'bf_feedback_CQI3k61',
        'bf_feedback_CQI3k62',
        'bf_feedback_CQI3k63',
        'bf_feedback_CQI3k64',
        'bf_feedback_CQI3k65',
        'bf_feedback_CQI3k66',



        
        // CQI4h
        'bf_feedback_CQI4h1',
        'bf_feedback_CQI4h2',
        'bf_feedback_CQI4h3',
        'bf_feedback_CQI4h4',
        'bf_feedback_CQI4h5',
        'bf_feedback_CQI4h6',
        'bf_feedback_CQI4h7',
        'bf_feedback_CQI4h8',
        'bf_feedback_CQI4h9',
        'bf_feedback_CQI4h10',
        'bf_feedback_CQI4h11',
        'bf_feedback_CQI4h12',
        'bf_feedback_CQI4h13',
        'bf_feedback_CQI4h14',
        'bf_feedback_CQI4h15',
        'bf_feedback_CQI4h16',
        'bf_feedback_CQI4h17',
        'bf_feedback_CQI4h18',
        'bf_feedback_CQI4h19',
        'bf_feedback_CQI4h20',
        'bf_feedback_CQI4h21',
        'bf_feedback_CQI4h22',
        'bf_feedback_CQI4h23',
        'bf_feedback_CQI4h24',
        'bf_feedback_CQI4h25',
        'bf_feedback_CQI4h26',
        'bf_feedback_CQI4h27',
        'bf_feedback_CQI4h28',
        'bf_feedback_CQI4h29',
        'bf_feedback_CQI4h30',
        'bf_feedback_CQI4h31',
        'bf_feedback_CQI4h32',
        'bf_feedback_CQI4h33',
        'bf_feedback_CQI4h34',
        'bf_feedback_CQI4h35',
        'bf_feedback_CQI4h36',
        'bf_feedback_CQI4h37',
        'bf_feedback_CQI4h38',
        'bf_feedback_CQI4h39',
        'bf_feedback_CQI4h40',
        'bf_feedback_CQI4h41',
        'bf_feedback_CQI4h42',
        'bf_feedback_CQI4h43',
        'bf_feedback_CQI4h44',
        'bf_feedback_CQI4h45',
        'bf_feedback_CQI4h46',
        'bf_feedback_CQI4h47',
        'bf_feedback_CQI4h48',
        'bf_feedback_CQI4h49',
        'bf_feedback_CQI4h50',
        'bf_feedback_CQI4h51',
        'bf_feedback_CQI4h52',
        'bf_feedback_CQI4h53',
        'bf_feedback_CQI4h54',
        'bf_feedback_CQI4h55',
        'bf_feedback_CQI4h56',

        // CLOTCM
        'bf_feedback_CLOTCM1',
        'bf_feedback_CLOTCM2',
        'bf_feedback_CLOTCM3',
        'bf_feedback_CLOTCM4',
        'bf_feedback_CLOTCM5',
        'bf_feedback_CLOTCM6',
        'bf_feedback_CLOTCM7',
        'bf_feedback_CLOTCM8',
        'bf_feedback_CLOTCM9',
        'bf_feedback_CLOTCM10',
        'bf_feedback_CLOTCM11',
        'bf_feedback_CLOTCM12',
        'bf_feedback_CLOTCM13',
        'bf_feedback_CLOTCM14',
        'bf_feedback_CLOTCM15',
        'bf_feedback_CLOTCM16',
        'bf_feedback_CLOTCM17',
        'bf_feedback_CLOTCM18',
        'bf_feedback_CLOTCM19',
        'bf_feedback_CLOTCM20',
        'bf_feedback_CLOTCM21',
        'bf_feedback_CLOTCM22',
        'bf_feedback_CLOTCM23',
        'bf_feedback_CLOTCM24',
        'bf_feedback_CLOTCM25',
        'bf_feedback_CLOTCM26',
        'bf_feedback_CLOTCM27',
        'bf_feedback_CLOTCM28',
        'bf_feedback_CLOTCM29',
        'bf_feedback_CLOTCM30',

        // CQI4i
        'bf_feedback_CQI4i1',
        'bf_feedback_CQI4i2',
        'bf_feedback_CQI4i3',
        'bf_feedback_CQI4i4',
        'bf_feedback_CQI4i5',
        'bf_feedback_CQI4i6',
        'bf_feedback_CQI4i7',
        'bf_feedback_CQI4i8',
        'bf_feedback_CQI4i9',
        'bf_feedback_CQI4i10',
        'bf_feedback_CQI4i11',
        'bf_feedback_CQI4i12',
        'bf_feedback_CQI4i13',
        'bf_feedback_CQI4i14',

        // CQI4j
        'bf_feedback_CQI4j1',
        'bf_feedback_CQI4j2',
        'bf_feedback_CQI4j3',
        'bf_feedback_CQI4j4',
        'bf_feedback_CQI4j5',
        'bf_feedback_CQI4j6',
        'bf_feedback_CQI4j7',
        'bf_feedback_CQI4j8',
        'bf_feedback_CQI4j9',
        'bf_feedback_CQI4j10',
        'bf_feedback_CQI4j11',
        'bf_feedback_CQI4j12',
        'bf_feedback_CQI4j13',
        'bf_feedback_CQI4j14',
        'bf_feedback_CQI4j15',
        'bf_feedback_CQI4j16',
        'bf_feedback_CQI4j17',
        'bf_feedback_CQI4j18',
        'bf_feedback_CQI4j19',
        'bf_feedback_CQI4j20',
        'bf_feedback_CQI4j21',
        'bf_feedback_CQI4j22'
    ];

        if (!in_array($table, $tables)) {
            $this->session->set_flashdata('error', 'Invalid table specified for deletion.');
            redirect($_SERVER['HTTP_REFERER']);
            return;
        }

        $this->db->trans_start();
        $this->db->where('id', $id);
        $deleted = $this->db->delete($table);
        $this->db->trans_complete();

        if ($deleted) {
            $this->session->set_flashdata('message', 'KPI record deleted successfully.');
        } else {
            $this->session->set_flashdata('error', 'Unable to delete the KPI record.');
        }

        redirect($_SERVER['HTTP_REFERER']); // back to same KPI page
    }



    //main page for all KPI
    public function feedbacks_report_CQI3a1()
    {
        		
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Average Time for initial assessment of in-patients in MRD (ICU)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a2()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Average Time for initial assessment of in-patients (Doctors)- (MRI WARD)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a3()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Average Time for initial assessment of emergency patients (Doctors)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a4()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Percentage of Care-plan is documented for inpatients';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a5()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Percentage of Nutritional assessment is documented for inpatients';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a6()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Percentage of Nursing care is documented for inpatients';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a7()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Average Time for initial assessment of Emergency patients';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a8()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Average Time for initial assessment of in-patients (Nurses)-(Nursing-ICU) ';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a9()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Average Time for initial assessment of in-patients (Nurses)-(Nursing-Ward)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a10()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Percentage of Blood culture contamination rate(Lab Service)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a11()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = ' Percentage of Beta-blocker prescriptions with a diagnosis of CHF with reduced EF (Cardiology - Emergency Department)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a12()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = ' Percentage of Hospitalized patients with hypoglycemia who achieved targeted blood glucose level (Endocrinology and Diabetes - Emergency Department)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a13()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Percentage of Spontaneous perineal Tear Rate';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a14()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Percentage of sepsis patients who receive care as per the HOUR-1 sepsis bundle (Critical Care Medicine - Medical records)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a14', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a15()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Percentage of COPD patients receiving COPD Action plan at the time of discharge (Pulmonary Medicine)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a15', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a16()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Percentage of bronchiolitis patients treated inappropriately (Pediatrics) ';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a16', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a17()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = ' Percentage of oncology patients who had treatment initiated following multidisciplinary meeting(Tumour board)-(Oncology - Gastro surgery)  ';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a17', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a18()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Percentage of Intravenous Contrast Media Extravasation (Radiology)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a18', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a19()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Average Time taken for triage(Emergency Department)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a19', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a20()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Percentage of patients undergoing dialysis who are able to achieve target hemoglobin levels(Nephrology) ';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a20', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3a21()
    {
        

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";

            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }

            $data['title'] = 'Percentage of Compliance rate of timeliness of physician responding to the reported critical results (JCI8-IPSG 2.0)-(Medical Administration)  ';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a21', $data, true);
            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/feedbacks_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
                public function feedbacks_report_CQI3a22()
            {
                $fdate = date('Y-m-d');
                $tdate = date('Y-m-01');
                $_SESSION['from_date'] = $fdate;
                $_SESSION['to_date'] = $tdate;
                if ($this->session->userdata('isLogIn') == false)
                    redirect('login');
                if (ismodule_active('QUALITY') === true) {
                    $dateInfo = get_from_to_date();
                    $pagetitle = $dateInfo['pagetitle'];
                    $titleSuffix = "";
            
                    if ($pagetitle === "Current Month") {
                        $titleSuffix = strtoupper(date('F Y'));
                    } elseif ($pagetitle === "Previous Month") {
                        $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                    } elseif ($pagetitle === "Last 365 Days") {
                        $titleSuffix = "LAST 365 DAYS";
                    } elseif ($pagetitle === "Last 30 Days") {
                        $titleSuffix = "LAST 30 DAYS";
                    } elseif ($pagetitle === "Custom") {
                        $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                    } elseif ($pagetitle === "Last 24 Hours") {
                        $titleSuffix = "LAST 24 HOURS";
                    } elseif ($pagetitle === "Quaterly") {
                        $titleSuffix = "LAST 90 DAYS";
                    } else {
                        $titleSuffix = $pagetitle;
                    }
            
                    $data['title'] = 'Percentage of compliance to Holding area care (ACC2-JCI8)-(Nursing)';
                    $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3a22', $data, true);
                    $this->load->view('layout/main_wrapper', $data);
                } else {
                    redirect('dashboard/noaccess');
                }
            }
            
            public function feedbacks_report_CQI3b1()
            {
                $fdate = date('Y-m-d');
                $tdate = date('Y-m-01');
                $_SESSION['from_date'] = $fdate;
                $_SESSION['to_date'] = $tdate;
                if ($this->session->userdata('isLogIn') == false)
                    redirect('login');
                if (ismodule_active('QUALITY') === true) {
                    $dateInfo = get_from_to_date();
                    $pagetitle = $dateInfo['pagetitle'];
                    $titleSuffix = "";
            
                    if ($pagetitle === "Current Month") {
                        $titleSuffix = strtoupper(date('F Y'));
                    } elseif ($pagetitle === "Previous Month") {
                        $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                    } elseif ($pagetitle === "Last 365 Days") {
                        $titleSuffix = "LAST 365 DAYS";
                    } elseif ($pagetitle === "Last 30 Days") {
                        $titleSuffix = "LAST 30 DAYS";
                    } elseif ($pagetitle === "Custom") {
                        $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                    } elseif ($pagetitle === "Last 24 Hours") {
                        $titleSuffix = "LAST 24 HOURS";
                    } elseif ($pagetitle === "Quaterly") {
                        $titleSuffix = "LAST 90 DAYS";
                    } else {
                        $titleSuffix = $pagetitle;
                    }
            
                    $data['title'] = 'Number of reporting errors per 1000 investigations (Lab)-(Lab Services)';
                    $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3b1', $data, true);
                    $this->load->view('layout/main_wrapper', $data);
                } else {
                    redirect('dashboard/noaccess');
                }
            }
            
            public function feedbacks_report_CQI3b2()
            {
                $fdate = date('Y-m-d');
                $tdate = date('Y-m-01');
                $_SESSION['from_date'] = $fdate;
                $_SESSION['to_date'] = $tdate;
                if ($this->session->userdata('isLogIn') == false)
                    redirect('login');
                if (ismodule_active('QUALITY') === true) {
                    $dateInfo = get_from_to_date();
                    $pagetitle = $dateInfo['pagetitle'];
                    $titleSuffix = "";
            
                    if ($pagetitle === "Current Month") {
                        $titleSuffix = strtoupper(date('F Y'));
                    } elseif ($pagetitle === "Previous Month") {
                        $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                    } elseif ($pagetitle === "Last 365 Days") {
                        $titleSuffix = "LAST 365 DAYS";
                    } elseif ($pagetitle === "Last 30 Days") {
                        $titleSuffix = "LAST 30 DAYS";
                    } elseif ($pagetitle === "Custom") {
                        $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                    } elseif ($pagetitle === "Last 24 Hours") {
                        $titleSuffix = "LAST 24 HOURS";
                    } elseif ($pagetitle === "Quaterly") {
                        $titleSuffix = "LAST 90 DAYS";
                    } else {
                        $titleSuffix = $pagetitle;
                    }
            
                    $data['title'] = 'Rate of redo in 1000 tests (Lab)-(Lab Services)';
                    $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3b2', $data, true);
                    $this->load->view('layout/main_wrapper', $data);
                } else {
                    redirect('dashboard/noaccess');
                }
            }
            
            public function feedbacks_report_CQI3b3()
            {
                $fdate = date('Y-m-d');
                $tdate = date('Y-m-01');
                $_SESSION['from_date'] = $fdate;
                $_SESSION['to_date'] = $tdate;
                if ($this->session->userdata('isLogIn') == false)
                    redirect('login');
                if (ismodule_active('QUALITY') === true) {
                    $dateInfo = get_from_to_date();
                    $pagetitle = $dateInfo['pagetitle'];
                    $titleSuffix = "";
            
                    if ($pagetitle === "Current Month") {
                        $titleSuffix = strtoupper(date('F Y'));
                    } elseif ($pagetitle === "Previous Month") {
                        $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                    } elseif ($pagetitle === "Last 365 Days") {
                        $titleSuffix = "LAST 365 DAYS";
                    } elseif ($pagetitle === "Last 30 Days") {
                        $titleSuffix = "LAST 30 DAYS";
                    } elseif ($pagetitle === "Custom") {
                        $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                    } elseif ($pagetitle === "Last 24 Hours") {
                        $titleSuffix = "LAST 24 HOURS";
                    } elseif ($pagetitle === "Quaterly") {
                        $titleSuffix = "LAST 90 DAYS";
                    } else {
                        $titleSuffix = $pagetitle;
                    }
            
                    $data['title'] = 'Percentage of reports correlating to clinical diagnosis (Lab)-(Lab Services)';
                    $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3b3', $data, true);
                    $this->load->view('layout/main_wrapper', $data);
                } else {
                    redirect('dashboard/noaccess');
                }
            }
            public function feedbacks_report_CQI3b4()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Critical value reporting TAT (Lab)-(Lab Services)';
                $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3b4', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3b5()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Sample Rejection Rate per 1000 samples (Lab)-(Lab Services)';
                $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3b5', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        public function feedbacks_report_CQI3b6()
    {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Number of reporting errors per 1000 investigations (Radiology)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3b6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3b7()
    {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of reports correlating to clinical diagnosis (Radiology)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3b7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3b8()
    {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of employees in diagnostics adhering to safety precautions (Radiology)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3b8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3b9()
    {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of employees in diagnostics adhering to safety precautions (Radiology)-(OT)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3b9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3b10()
    {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of employees in diagnostics adhering to safety precautions (Radiology)-(Nursing)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3b10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3b11()
    {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Number of reporting errors before dispatch (Lab)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3b11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3b12()
    {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Waiting time for Laboratory services';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3b12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3b13()
    {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Patient safety events or errors related to pathology samples, such as biopsy or other tissue specimens (JCI8-QPS 3.04)-(Lab Services)';
            $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3b13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }



        
        public function feedbacks_report_CQI3c1()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Medication Error';
                $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3c1', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3c2()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Incidence of medication errors - Prescription Errors(IP) (As per NABH 4th edition) -(Clinical Pharmacy)';
                $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3c2', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3c3()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Incidence of medication errors - Dispensing Errors(IP) (As per NABH 4th edition) -(Clinical Pharmacy)';
                $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3c3', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        public function feedbacks_report_CQI3c4()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of admissions with ADR- (Clinical Pharmacy)';
                $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3c4', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3c5()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of medication charts with error prone abbreviations- (Clinical Pharmacy)';
                $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3c5', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3c6()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of patients receiving high risk medication developing adverse drug event- (Clinical Pharmacy)';
                $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3c6', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3c7()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Incidence of Medication Administering errors (NABH 4th edition)- (Clinical Pharmacy)';
                $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3c7', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3c8()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of in-patients developing adverse drug reaction- (Clinical Pharmacy)';
                $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3c8', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3c9()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Incidence of Medication Administering errors- (Clinical Pharmacy)';
                $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3c9', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3c10()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Incidence of medication errors - Dispensing errors (IP)- (Clinical Pharmacy)';
                $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3c10', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3c11()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Incidence of medication errors - Prescription errors(IP)- (Clinical Pharmacy)';
                $data['content']  = $this->load->view('qualitymodules/feedbacks_report_CQI3c11', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        public function feedbacks_report_CQI3c12()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Empirical Antibiotics therapy compliance rate for high risk infections- (Clinical Pharmacy)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3c12', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3c13()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Restricted antibiotics usage compliance rate(JCI8-MMU1.1)-(Clinical Pharmacy)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3c13', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3c14()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Monitor data related to appropriateness of indication for the new drugs(JCI8-MMU2.0)-(Clinical Pharmacy)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3c14', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        public function feedbacks_report_CQI3d1()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of modification of anaesthesia plan (OT - Anasthesia)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3d1', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3d2()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of unplanned ventilation following anaesthesia (OT - Anasthesia)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3d2', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3d3()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of adverse anaesthesia events following anaesthesia (OT - Anasthesia)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3d3', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3d4()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Anaesthesia related mortality rate (OT - Anasthesia)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3d4', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3d5()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of safe and rational prescriptions (Clinical Pharmacy - IP - Pharmacy)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3d5', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        public function feedbacks_report_CQI3e1()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of unplanned return to OT';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3e1', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3e2()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of rescheduling of surgeries (OT)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3e2', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3e3()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of cases where organisations procedure to prevent surgery errors (wrong site, wrong procedure, wrong patient) have been adhered (OT)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3e3', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3e4()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of cases receiving appropriate prophylactic antibiotics with specified time frame (Clinical Pharmacy)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3e4', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3e5()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of cases where the planned surgery were changed intraoperatively (OT)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3e5', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3e6()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Re-exploration rate (OT)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3e6', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3e7()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Primary Cesarean Rate (Nursing - OBG)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3e7', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3e8()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Adverse events related to implant devices (JCI8 - ASC 4.4) - (OT)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3e8', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3e9()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false)
                redirect('login');
            if (ismodule_active('QUALITY') === true) {
        
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'All major patient safety events or errors related to surgical procedures (JCI8 - QPS 3.04)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3e9', $data, true);
                $this->load->view('layout/main_wrapper', $data);
        
            } else {
                redirect('dashboard/noaccess');
            }
        }
        public function feedbacks_report_CQI3f1()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false) redirect('login');
            if (ismodule_active('QUALITY') === true) {
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of transfusion reactions (PSQ3a) - (Blood Center)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3f1', $data, true);
                $this->load->view('layout/main_wrapper', $data);
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3f2()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false) redirect('login');
            if (ismodule_active('QUALITY') === true) {
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of waste of blood and blood components among those issued (Blood Center)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3f2', $data, true);
                $this->load->view('layout/main_wrapper', $data);
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3f3()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false) redirect('login');
            if (ismodule_active('QUALITY') === true) {
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of waste of blood and blood components among those stored (Blood Center)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3f3', $data, true);
                $this->load->view('layout/main_wrapper', $data);
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3f4()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false) redirect('login');
            if (ismodule_active('QUALITY') === true) {
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Percentage of number of blood component units used (Blood Center)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3f4', $data, true);
                $this->load->view('layout/main_wrapper', $data);
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3f5()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false) redirect('login');
            if (ismodule_active('QUALITY') === true) {
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Turn-around time for blood and blood components cross matched / reserved (Blood Center)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3f5', $data, true);
                $this->load->view('layout/main_wrapper', $data);
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3f6()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false) redirect('login');
            if (ismodule_active('QUALITY') === true) {
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Adverse events and near miss events involving blood bank and/or transfusion services (Transfusion to the wrong patient, Mislabeled blood product, Contaminated blood product) (JCI8-AOP 4.00) - (Blood Center)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3f6', $data, true);
                $this->load->view('layout/main_wrapper', $data);
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3f7()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false) redirect('login');
            if (ismodule_active('QUALITY') === true) {
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Blood availability rate (JCI8-AOP 4.00) - (Blood Center)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3f7', $data, true);
                $this->load->view('layout/main_wrapper', $data);
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3f8()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false) redirect('login');
            if (ismodule_active('QUALITY') === true) {
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'CT Ratio (cross match to transfusion) (JCI8-AOP 4.00) - (Blood Center)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3f8', $data, true);
                $this->load->view('layout/main_wrapper', $data);
            } else {
                redirect('dashboard/noaccess');
            }
        }
        
        public function feedbacks_report_CQI3f9()
        {
            $fdate = date('Y-m-d');
            $tdate = date('Y-m-01');
            $_SESSION['from_date'] = $fdate;
            $_SESSION['to_date'] = $tdate;
        
            if ($this->session->userdata('isLogIn') == false) redirect('login');
            if (ismodule_active('QUALITY') === true) {
                $dateInfo = get_from_to_date();
                $pagetitle = $dateInfo['pagetitle'];
                $titleSuffix = "";
        
                if ($pagetitle === "Current Month") {
                    $titleSuffix = strtoupper(date('F Y'));
                } elseif ($pagetitle === "Previous Month") {
                    $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
                } elseif ($pagetitle === "Last 365 Days") {
                    $titleSuffix = "LAST 365 DAYS";
                } elseif ($pagetitle === "Last 30 Days") {
                    $titleSuffix = "LAST 30 DAYS";
                } elseif ($pagetitle === "Custom") {
                    $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
                } elseif ($pagetitle === "Last 24 Hours") {
                    $titleSuffix = "LAST 24 HOURS";
                } elseif ($pagetitle === "Quaterly") {
                    $titleSuffix = "LAST 90 DAYS";
                } else {
                    $titleSuffix = $pagetitle;
                }
        
                $data['title'] = 'Turnaround time for Platelet Apheresis (Blood Center)';
                $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3f9', $data, true);
                $this->load->view('layout/main_wrapper', $data);
            } else {
                redirect('dashboard/noaccess');
            }
        }
        public function feedbacks_report_CQI3f10() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Turnaround time for blood donation (Blood Center)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3f10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3g1() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Catheter associated urinary tract infection rate (PSQ 3b) - (Infection Control - Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3g1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3g2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Ventilator associated pneumonias (VAP) in 1000 ventilator days (Infection Control - Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3g2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
        public function feedbacks_report_CQI3g3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Central Line Associated Blood Stream Infection (CLABSI) - (Infection Control - Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3g3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function feedbacks_report_CQI3g4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Surgical site infection rate (Infection Control - Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3g4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3g5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Late Onset Sepsis Rate After 72 Hours (Nursing - NICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3g5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3g6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Environmental cleaning & disinfection compliance rate (JCI8-PCI 4.0) - (House Keeping)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3g6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
        public function feedbacks_report_CQI3h1() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Mortality rate (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3h1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3h2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Return to ICU within 48 hours (Nursing - ICU1)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3h2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3h3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Return to ICU 2 within 48 hours (Nursing - ICU2)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3h3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3h4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Return to ICU 3 within 48 hours (Nursing - CICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3h4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3h5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Return to the emergency department after 72 hours with similar presenting complaints (Emergency - Department)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3h5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3h6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Reintubation rate (Nursing - ICU1)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3h6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3h7() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Reintubation rate (Nursing - ICU2)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3h7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3h8() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Reintubation rate (Nursing - CICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3h8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3h9() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Re Admission Rate (Nursing - NICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3h9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
        public function feedbacks_report_CQI3j1() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Shift change handover communication (Nurses) (ED, ICU, Ward) - (Nursing - Emergency Department)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function feedbacks_report_CQI3j2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Shift change handover communication (Nurses) (ED, ICU, Ward) - (Nursing - ICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Shift change handover communication (Nurses) (ED, ICU, Ward) - (Nursing - Ward)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
        public function feedbacks_report_CQI3j4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Incidence of patient identification error (Quality Office)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Number of missed hand hygiene opportunities (Infection Control - Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance rate to medication prescription in capitals (Clinical Pharmacy)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3j7() {
    $fdate = date('Y-m-d');
    $tdate = date('Y-m-01');
    $_SESSION['from_date'] = $fdate;
    $_SESSION['to_date'] = $tdate;

    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $dateInfo = get_from_to_date();
        $pagetitle = $dateInfo['pagetitle'];
        $titleSuffix = "";

        if ($pagetitle === "Current Month") {
            $titleSuffix = strtoupper(date('F Y'));
        } elseif ($pagetitle === "Previous Month") {
            $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
        } elseif ($pagetitle === "Last 365 Days") {
            $titleSuffix = "LAST 365 DAYS";
        } elseif ($pagetitle === "Last 30 Days") {
            $titleSuffix = "LAST 30 DAYS";
        } elseif ($pagetitle === "Custom") {
            $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
        } elseif ($pagetitle === "Last 24 Hours") {
            $titleSuffix = "LAST 24 HOURS";
        } elseif ($pagetitle === "Quaterly") {
            $titleSuffix = "LAST 90 DAYS";
        } else {
            $titleSuffix = $pagetitle;
        }

        $data['title'] = 'Shift change handover communication (Doctors) (MRD - Emergency Department)';
        $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j7', $data, true);
        $this->load->view('layout/main_wrapper', $data);
    } else {
        redirect('dashboard/noaccess');
    }
}

    public function feedbacks_report_CQI3j8() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Shift change handover communication (Doctors) - (MRD - ICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j9() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to patient identification - IPD (Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j10() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance rate of timeliness of reporting Critical results in Radiology (within 30 min) - (Radiology)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3j11() {
    $fdate = date('Y-m-d');
    $tdate = date('Y-m-01');
    $_SESSION['from_date'] = $fdate;
    $_SESSION['to_date'] = $tdate;

    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $dateInfo = get_from_to_date();
        $pagetitle = $dateInfo['pagetitle'];
        $titleSuffix = "";

        if ($pagetitle === "Current Month") {
            $titleSuffix = strtoupper(date('F Y'));
        } elseif ($pagetitle === "Previous Month") {
            $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
        } elseif ($pagetitle === "Last 365 Days") {
            $titleSuffix = "LAST 365 DAYS";
        } elseif ($pagetitle === "Last 30 Days") {
            $titleSuffix = "LAST 30 DAYS";
        } elseif ($pagetitle === "Custom") {
            $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
        } elseif ($pagetitle === "Last 24 Hours") {
            $titleSuffix = "LAST 24 HOURS";
        } elseif ($pagetitle === "Quaterly") {
            $titleSuffix = "LAST 90 DAYS";
        } else {
            $titleSuffix = $pagetitle;
        }

        $data['title'] = 'IPSG 2.2 - Hand off communication interdepartmental shift (MRD - Emergency Department)';
        $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j11', $data, true);
        $this->load->view('layout/main_wrapper', $data);
    } else {
        redirect('dashboard/noaccess');
    }
}

    public function feedbacks_report_CQI3j12() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG 2.2 - Hand off communication interdepartmental shift (MRD - ICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j13() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG 2.2 - Hand off communication interdepartmental Shift (Nurses) - (Nursing - Emergency Department)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j14() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG 2.2 - Hand off communication interdepartmental Shift (Nurses) - (Nursing - ICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j14', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j15() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG 2.2 - Hand off communication interdepartmental Shift (Nurses) - (Nursing - Ward)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j15', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j16() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG 2.2 - Hand off communication interdepartmental Shift (Doctors) - (MRD - Ward)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j16', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j17() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG 2.2 - Hand off communication interdepartmental Shift (Doctors) - (MRD - ICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j17', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j18() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG 2.2 - Hand off communication among nurses (During shift change)-(Nursing - EmergencyDepartment)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j18', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j19() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG 2.2 - Hand off communication among nurses (During shift change)-(Nursing -ICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j19', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j20() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG 2.2 - Hand off communication among nurses (During shift change)-(Nursing -Ward)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j20', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3j21() {
    $fdate = date('Y-m-d');
    $tdate = date('Y-m-01');
    $_SESSION['from_date'] = $fdate;
    $_SESSION['to_date'] = $tdate;

    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $dateInfo = get_from_to_date();
        $pagetitle = $dateInfo['pagetitle'];
        $titleSuffix = "";

        if ($pagetitle === "Current Month") {
            $titleSuffix = strtoupper(date('F Y'));
        } elseif ($pagetitle === "Previous Month") {
            $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
        } elseif ($pagetitle === "Last 365 Days") {
            $titleSuffix = "LAST 365 DAYS";
        } elseif ($pagetitle === "Last 30 Days") {
            $titleSuffix = "LAST 30 DAYS";
        } elseif ($pagetitle === "Custom") {
            $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
        } elseif ($pagetitle === "Last 24 Hours") {
            $titleSuffix = "LAST 24 HOURS";
        } elseif ($pagetitle === "Quaterly") {
            $titleSuffix = "LAST 90 DAYS";
        } else {
            $titleSuffix = $pagetitle;
        }

        $data['title'] = 'IPSG 4 - Ensure correct site, correct procedure, correct patient surgery-(Quality Office - Endoscopy)';
        $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j21', $data, true);
        $this->load->view('layout/main_wrapper', $data);
    } else {
        redirect('dashboard/noaccess');
    }
}

    public function feedbacks_report_CQI3j22() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG 4 - Ensure correct site, correct procedure, correct patient surgery-(Quality Office - ICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j22', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j23() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG 4 - Ensure correct site, correct procedure, correct patient surgery-(Quality Office - OT)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j23', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j24() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'PSG 6 - Compliance to Fall prevention measures in IPD-(Nursing - IPD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j24', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j25() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'PSG 6 - Compliance to Fall prevention measures in OPD-(Nursing - OPD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j25', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j26() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG 6 - Compliance to Fall prevention measures in Physiotherapy OP patients-(Physical therapy and Rehabilitation Department - Physiotherapy)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j26', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j27() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to hand hygiene practice (New)-(Infection Control - Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j27', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j28() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to patient identification OPD-(Nursing-OPD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j28', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3j29() {
    $fdate = date('Y-m-d');
    $tdate = date('Y-m-01');
    $_SESSION['from_date'] = $fdate;
    $_SESSION['to_date'] = $tdate;

    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $dateInfo = get_from_to_date();
        $pagetitle = $dateInfo['pagetitle'];
        $titleSuffix = "";

        if ($pagetitle === "Current Month") {
            $titleSuffix = strtoupper(date('F Y'));
        } elseif ($pagetitle === "Previous Month") {
            $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
        } elseif ($pagetitle === "Last 365 Days") {
            $titleSuffix = "LAST 365 DAYS";
        } elseif ($pagetitle === "Last 30 Days") {
            $titleSuffix = "LAST 30 DAYS";
        } elseif ($pagetitle === "Custom") {
            $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
        } elseif ($pagetitle === "Last 24 Hours") {
            $titleSuffix = "LAST 24 HOURS";
        } elseif ($pagetitle === "Quaterly") {
            $titleSuffix = "LAST 90 DAYS";
        } else {
            $titleSuffix = $pagetitle;
        }

        $data['title'] = 'Shift change handover communication(Doctors - ward)-(Medical Administration)';
        $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j29', $data, true);
        $this->load->view('layout/main_wrapper', $data);
    } else {
        redirect('dashboard/noaccess');
    }
}

    public function feedbacks_report_CQI3j30() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Incidence of Adverse events in Physiotherapy (IPD)-(Physical therapy and Rehabilitation Department - Physiotherapy)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j30', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j31() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Incidence of Adverse events in Physiotherapy(OPD)-(Physical therapy and Rehabilitation Department - Physiotherapy)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j31', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j32() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG 4 - Ensure correct site, correct procedure, correct patient surgery-(Quality Office - OT)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j32', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j33() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Security incidents rate(JCI8-FMS 4.0)-(Safety & Security)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j33', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3j34() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Safety incidents rate(JCI8-FMS 3.0)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3j34', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4a1() 
    {
    $fdate = date('Y-m-d');
    $tdate = date('Y-m-01');
    $_SESSION['from_date'] = $fdate;
    $_SESSION['to_date'] = $tdate;

    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $dateInfo = get_from_to_date();
        $pagetitle = $dateInfo['pagetitle'];
        $titleSuffix = "";

        if ($pagetitle === "Current Month") {
            $titleSuffix = strtoupper(date('F Y'));
        } elseif ($pagetitle === "Previous Month") {
            $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
        } elseif ($pagetitle === "Last 365 Days") {
            $titleSuffix = "LAST 365 DAYS";
        } elseif ($pagetitle === "Last 30 Days") {
            $titleSuffix = "LAST 30 DAYS";
        } elseif ($pagetitle === "Custom") {
            $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
        } elseif ($pagetitle === "Last 24 Hours") {
            $titleSuffix = "LAST 24 HOURS";
        } elseif ($pagetitle === "Quaterly") {
            $titleSuffix = "LAST 90 DAYS";
        } else {
            $titleSuffix = $pagetitle;
        }

        $data['title'] = 'Percentage of drugs and consumables procured by local purchases within the formulary-(Pharmacy)';
        $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4a1', $data, true);
        $this->load->view('layout/main_wrapper', $data);
    } else {
        redirect('dashboard/noaccess');
    }
}

    public function feedbacks_report_CQI4a2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of drugs and consumables procured by local purchase outside the formulary-(Pharmacy)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4a2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4a3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Stock out rate of emergency medications-(Pharmacy)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4a3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4a4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of drugs and consumables rejected before preparation of Goods Receipt Note(SCM-Store)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4a4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4a5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of variations from procurement process(SCM-Purchase)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4a5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4b1() {
    $fdate = date('Y-m-d');
    $tdate = date('Y-m-01');
    $_SESSION['from_date'] = $fdate;
    $_SESSION['to_date'] = $tdate;

    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $dateInfo = get_from_to_date();
        $pagetitle = $dateInfo['pagetitle'];
        $titleSuffix = "";

        if ($pagetitle === "Current Month") {
            $titleSuffix = strtoupper(date('F Y'));
        } elseif ($pagetitle === "Previous Month") {
            $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
        } elseif ($pagetitle === "Last 365 Days") {
            $titleSuffix = "LAST 365 DAYS";
        } elseif ($pagetitle === "Last 30 Days") {
            $titleSuffix = "LAST 30 DAYS";
        } elseif ($pagetitle === "Custom") {
            $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
        } elseif ($pagetitle === "Last 24 Hours") {
            $titleSuffix = "LAST 24 HOURS";
        } elseif ($pagetitle === "Quaterly") {
            $titleSuffix = "LAST 90 DAYS";
        } else {
            $titleSuffix = $pagetitle;
        }

        $data['title'] = 'Incidence of bed sores (hospital associated pressure ulcers) after admission (in 1000 patient days)-(Nursing)';
        $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4b1', $data, true);
        $this->load->view('layout/main_wrapper', $data);
    } else {
        redirect('dashboard/noaccess');
    }
}

    public function feedbacks_report_CQI4b2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Incidence of falls (in 1000 IPD days)-(Office-Quality)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4b2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4b3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Number of variations observed in mock drill-(Safety & Security)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4b3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4b4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of staff provided with pre-exposure prophylaxis-(Infection Control)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4b4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4b5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Number of Fire Incidents-(Safety & Security)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4b5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4b6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Incidence of device associated pressure ulcer after admission-(Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4b6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4b7() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Number of Extravasation-(Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4b7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4b8() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Monitoring of Clinical Errors (JCI8-PCC 2.3)-(Quality Office)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4b8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4c1() {
    $fdate = date('Y-m-d');
    $tdate = date('Y-m-01');
    $_SESSION['from_date'] = $fdate;
    $_SESSION['to_date'] = $tdate;

    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $dateInfo = get_from_to_date();
        $pagetitle = $dateInfo['pagetitle'];
        $titleSuffix = "";

        if ($pagetitle === "Current Month") {
            $titleSuffix = strtoupper(date('F Y'));
        } elseif ($pagetitle === "Previous Month") {
            $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
        } elseif ($pagetitle === "Last 365 Days") {
            $titleSuffix = "LAST 365 DAYS";
        } elseif ($pagetitle === "Last 30 Days") {
            $titleSuffix = "LAST 30 DAYS";
        } elseif ($pagetitle === "Custom") {
            $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
        } elseif ($pagetitle === "Last 24 Hours") {
            $titleSuffix = "LAST 24 HOURS";
        } elseif ($pagetitle === "Quaterly") {
            $titleSuffix = "LAST 90 DAYS";
        } else {
            $titleSuffix = $pagetitle;
        }

        $data['title'] = 'Bed occupancy rate- (MRD)';
        $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c1', $data, true);
        $this->load->view('layout/main_wrapper', $data);
    } else {
        redirect('dashboard/noaccess');
    }
}

    public function feedbacks_report_CQI4c2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Average length of stay (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4c3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'OT Utilisation Rate (OT)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4c4() {
    $fdate = date('Y-m-d');
    $tdate = date('Y-m-01');
    $_SESSION['from_date'] = $fdate;
    $_SESSION['to_date'] = $tdate;

    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $dateInfo = get_from_to_date();
        $pagetitle = $dateInfo['pagetitle'];
        $titleSuffix = "";

        if ($pagetitle === "Current Month") {
            $titleSuffix = strtoupper(date('F Y'));
        } elseif ($pagetitle === "Previous Month") {
            $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
        } elseif ($pagetitle === "Last 365 Days") {
            $titleSuffix = "LAST 365 DAYS";
        } elseif ($pagetitle === "Last 30 Days") {
            $titleSuffix = "LAST 30 DAYS";
        } elseif ($pagetitle === "Custom") {
            $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
        } elseif ($pagetitle === "Last 24 Hours") {
            $titleSuffix = "LAST 24 HOURS";
        } elseif ($pagetitle === "Quaterly") {
            $titleSuffix = "LAST 90 DAYS";
        } else {
            $titleSuffix = $pagetitle;
        }

        $data['title'] = 'ICU equipment utilisation rate-(Nursing - ICU1)';
        $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c4', $data, true);
        $this->load->view('layout/main_wrapper', $data);
    } else {
        redirect('dashboard/noaccess');
    }
}

    public function feedbacks_report_CQI4c5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'ICU equipment utilisation rate-(Nursing - ICU2)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4c6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'ICU equipment utilisation rate-(Nursing - ICU3)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4c7() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'ICU Bed utilisation rate (Nursing - ICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4c8() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Critical equipment downtime-(Biomedical Engineering)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4c9() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Cath lab utilization rate (Cath Lab - Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4c10() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Nurse patient ratio for ICU Ventilated (Nursing-ICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4c11() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Nurse patient ratio for ICU Non Ventilated (Nursing-ICU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4c12() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Nurse patient ratio for HDU (Nursing-HDU)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4c13() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Nurse patient ratio for Ward (Nursing-Ward)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4c14() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Engineering Critical equipment downtime (Engineering & Maintenance)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4c14', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4d1() {
    $fdate = date('Y-m-d');
    $tdate = date('Y-m-01');
    $_SESSION['from_date'] = $fdate;
    $_SESSION['to_date'] = $tdate;

    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $dateInfo = get_from_to_date();
        $pagetitle = $dateInfo['pagetitle'];
        $titleSuffix = "";

        if ($pagetitle === "Current Month") {
            $titleSuffix = strtoupper(date('F Y'));
        } elseif ($pagetitle === "Previous Month") {
            $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
        } elseif ($pagetitle === "Last 365 Days") {
            $titleSuffix = "LAST 365 DAYS";
        } elseif ($pagetitle === "Last 30 Days") {
            $titleSuffix = "LAST 30 DAYS";
        } elseif ($pagetitle === "Custom") {
            $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
        } elseif ($pagetitle === "Last 24 Hours") {
            $titleSuffix = "LAST 24 HOURS";
        } elseif ($pagetitle === "Quaterly") {
            $titleSuffix = "LAST 90 DAYS";
        } else {
            $titleSuffix = $pagetitle;
        }

        $data['title'] = 'Out patient satisfaction index (Patient Care Services - OPD)';
        $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4d1', $data, true);
        $this->load->view('layout/main_wrapper', $data);
    } else {
        redirect('dashboard/noaccess');
    }
}

    public function feedbacks_report_CQI4d2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Inpatient satisfaction index (Patient Care Services - IPD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4d2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4d3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Time taken for discharge - Cash Patients (Patient Care Services - Cash)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4d3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4d4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Time taken for discharge - Cashless Patients (Patient Care Services - Cashless)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4d4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4d5() {
    $fdate = date('Y-m-d');
    $tdate = date('Y-m-01');
    $_SESSION['from_date'] = $fdate;
    $_SESSION['to_date'] = $tdate;

    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $dateInfo = get_from_to_date();
        $pagetitle = $dateInfo['pagetitle'];
        $titleSuffix = "";

        if ($pagetitle === "Current Month") {
            $titleSuffix = strtoupper(date('F Y'));
        } elseif ($pagetitle === "Previous Month") {
            $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
        } elseif ($pagetitle === "Last 365 Days") {
            $titleSuffix = "LAST 365 DAYS";
        } elseif ($pagetitle === "Last 30 Days") {
            $titleSuffix = "LAST 30 DAYS";
        } elseif ($pagetitle === "Custom") {
            $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
        } elseif ($pagetitle === "Last 24 Hours") {
            $titleSuffix = "LAST 24 HOURS";
        } elseif ($pagetitle === "Quaterly") {
            $titleSuffix = "LAST 90 DAYS";
        } else {
            $titleSuffix = $pagetitle;
        }

        $data['title'] = 'Waiting time for diagnostic services (Radiology - CT)';
        $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4d5', $data, true);
        $this->load->view('layout/main_wrapper', $data);
    } else {
        redirect('dashboard/noaccess');
    }
}

    public function feedbacks_report_CQI4d6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Waiting time for diagnostic services (Radiology - MRI)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4d6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4d7() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Waiting time for diagnostic services (Radiology - USG)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4d7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4d8() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Waiting Time for OPD appointments (Patient Care Services - OPD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4d8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4d9() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Waiting Time for OPD Walkin (Patient Care Services - OPD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4d9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4d10() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Patient Satisfaction Rate-(Nursing - OBG)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4d10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4d11() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Turn-around Time for Nursing call bell responds (Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4d11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4e1() {
    $fdate = date('Y-m-d');
    $tdate = date('Y-m-01');
    $_SESSION['from_date'] = $fdate;
    $_SESSION['to_date'] = $tdate;

    if ($this->session->userdata('isLogIn') == false) redirect('login');

    if (ismodule_active('QUALITY') === true) {
        $dateInfo = get_from_to_date();
        $pagetitle = $dateInfo['pagetitle'];
        $titleSuffix = "";

        if ($pagetitle === "Current Month") {
            $titleSuffix = strtoupper(date('F Y'));
        } elseif ($pagetitle === "Previous Month") {
            $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
        } elseif ($pagetitle === "Last 365 Days") {
            $titleSuffix = "LAST 365 DAYS";
        } elseif ($pagetitle === "Last 30 Days") {
            $titleSuffix = "LAST 30 DAYS";
        } elseif ($pagetitle === "Custom") {
            $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
        } elseif ($pagetitle === "Last 24 Hours") {
            $titleSuffix = "LAST 24 HOURS";
        } elseif ($pagetitle === "Quaterly") {
            $titleSuffix = "LAST 90 DAYS";
        } else {
            $titleSuffix = $pagetitle;
        }

        $data['title'] = 'Employee satisfaction index (HR)';
        $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4e1', $data, true);
        $this->load->view('layout/main_wrapper', $data);
    } else {
        redirect('dashboard/noaccess');
    }
}

    public function feedbacks_report_CQI4e2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Employee attrition rate (HR)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4e2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4e3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Employee absenteeism rate (HR)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4e3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4e4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of employees aware of rights, responsibility and welfare schemes (HR)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4e4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4e5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Average number of training hours (HR)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4e5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4e6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Nurses Attrition Rate (Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4e6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4e7() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Outsourced employee absenteeism rate (Nursing Assistants) (Patient Care Services - OPD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4e7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4e8() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Average number of unpaid leave per month (HR)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4e8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4f1() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Incidence of needle stick injuries IPD area (in 1000 IPD days) (Infection Control - IPD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4f1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4f2() {
    $fdate = date('Y-m-d');
    $tdate = date('Y-m-01');
    $_SESSION['from_date'] = $fdate;
    $_SESSION['to_date'] = $tdate;

    if ($this->session->userdata('isLogIn') == false) redirect('login');

    if (ismodule_active('QUALITY') === true) {
        $dateInfo = get_from_to_date();
        $pagetitle = $dateInfo['pagetitle'];
        $titleSuffix = "";

        if ($pagetitle === "Current Month") {
            $titleSuffix = strtoupper(date('F Y'));
        } elseif ($pagetitle === "Previous Month") {
            $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
        } elseif ($pagetitle === "Last 365 Days") {
            $titleSuffix = "LAST 365 DAYS";
        } elseif ($pagetitle === "Last 30 Days") {
            $titleSuffix = "LAST 30 DAYS";
        } elseif ($pagetitle === "Custom") {
            $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
        } elseif ($pagetitle === "Last 24 Hours") {
            $titleSuffix = "LAST 24 HOURS";
        } elseif ($pagetitle === "Quaterly") {
            $titleSuffix = "LAST 90 DAYS";
        } else {
            $titleSuffix = $pagetitle;
        }

        $data['title'] = 'Incidence of needle stick injuries OPD area (in 1000 OPD days) (Infection Control - OPD)';
        $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4f2', $data, true);
        $this->load->view('layout/main_wrapper', $data);
    } else {
        redirect('dashboard/noaccess');
    }
}
    public function feedbacks_report_CQI4f3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of sentinel events, reported, collected and analysed within the defined time frame (Quality Office)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4f3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4f4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of near misses (Quality Office)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4f4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4f5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Incidence of blood body fluid exposure IPD (Infection Control - IPD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4f5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4f6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Incidence of blood body fluid exposure OPD (Infection Control - OPD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4f6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4f7() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Adverse events related to SUDs (JCI8-PCI 3.1) (CSSD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4f7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4g1() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of Medical records not having discharge summary (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4g1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4g2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of Medical records not having codification as per ICD (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4g2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4g3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of Medical records having improper or incomplete consent (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4g3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4g4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of missing medical records (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4g4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4g5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance rate of adhering with policies and procedures for care of patients at risk for suicide and self-harm (JCI8-COP 5) (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4g5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4g6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Monthly Abbreviation Compliance (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4g6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3k1() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Total number of LAMA cases with Reasons (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Adverse events due to handover (Quality Office)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Inguinal herniorrhaphy with mesh (Infection Control)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Coronary artery bypass grafting (CABG) (Infection Control)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3k5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Laparoscopic cholecystectomy (Infection Control)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Monitoring the duration of antibiotic usage in surgical prophylaxis (After 48 hours) (Clinical Pharmacy)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k7() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'De-escalation of antibiotics (Clinical Pharmacy)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k8() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'High Alert Medication Segregation, storage & labelling Compliance rate (Pharmacy - Store)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k9() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Average recovery time (OT-Post OP)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k10() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Door to thrombolysis time in ischemic stroke in ER (Emergency Department)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k11() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Door to image time in Stroke patients (Emergency Department)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k12() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Average number of patients visiting Emergency per day (Emergency Department)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3k13() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Efficiency of code blue team (Emergency Department)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k14() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Time for first defibrillation (Emergency Department)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k14', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k15() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Door to Balloon time in PTCA (Cath Lab)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k15', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k16() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to diet order (Clinical Nutrition and Dietetics)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k16', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k17() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Case Fatality 1 - CAD (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k17', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3k18() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Case Fatality 2 - Acute coronary syndrome (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k18', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k19() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Case Fatality 3 - Cerebral infarction (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k19', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k20() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Case Fatality 4 - MI (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k20', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k21() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Case Fatality 5 - Heart failure (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k21', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k22() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliances in patient transfer and transportation process (External transfer) - (Emergency Department)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k22', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k23() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Number of Adverse Events During Patient Transfers (Out Side) - (Emergency Department)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k23', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k24() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'ILC/EQAS compliance rate (Lab Services)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k24', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k25() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance with Biological Indicator (CSSD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k25', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3k26() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to risk assessment in reprocessing of SUMD (CSSD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k26', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k27() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Non-compliance to Copy and Paste policy (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k27', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k28() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to POCT IQC Checking (Lab Services)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k28', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k29() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Case Fatality - COVID 19 (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k29', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3k30() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Case Fatality - Stroke (MRD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k30', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k31() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Post procedure complication rate - Colonoscopy (Endoscopy)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k31', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k32() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Polyp retrieval rate after colonoscopic polypectomy (Endoscopy)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k32', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k33() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Survival rate for living donor kidney transplants (Nephrology)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k33', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k34() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'CAUTI Prevention Bundle compliance Rate (Infection Control)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k34', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3k35() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Major Discrepancies between Preoperative and Post operative Diagnosis (OT)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k35', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k36() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Adverse Events Related to patient Identification (Quality Office)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k36', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k37() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'CLABSI Prevention Bundle compliance Rate (Infection Control)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k37', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k38() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'SSI Prevention Bundle compliance Rate (Infection Control)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k38', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k39() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'VAP Prevention Bundle compliance Rate (Infection Control)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k39', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k40() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Restraint related injuries among admitted patients (Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k40', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k41() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Rate of compliance for restraint consent policy (Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k41', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k42() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of Accidental removal of line (Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k42', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k43() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Significant hypotension necessitating termination of dialysis (Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k43', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k44() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'IPSG4 - Time out compliance in outside OT (Nursing)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k44', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k45() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of cases where Initial assessment done in physiotherapy within 24 hours (IPD) (Physical therapy and Rehabilitation Department - Medical records)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k45', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3k46() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Radiology TAT orders for CT (Radiology)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k46', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k47() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Radiology TAT orders for MRI (Radiology)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k47', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3k48() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Radiology TAT orders for USG (Radiology)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k48', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k49() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Radiology TAT orders for X-ray (Radiology)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k49', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k50() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Site Marking Compliance Rate (OT)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k50', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3k51() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Time Out Compliance Rate (OT)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k51', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k52() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Sign Out Compliance Rate (OT)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k52', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k53() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Post transplant complication rate for Donor (Liver) (Transplant Unit)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k53', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k54() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Post transplant complication rate (Heart) (Transplant Unit)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k54', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k55() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of research activities approved by ethics committee (Research)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k55', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI3k56() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of patients withdrawing from the study (Research)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k56', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k57() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of protocol violations/deviations reported (Research)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k57', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k58() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of serious adverse events reported to the ethics committee within the defined timeframe (Research)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k58', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k59() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of cases where Initial assessment done in physiotherapy within 24 hours OPD';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k59', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k60() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Survival rate for living donor Liver transplants (Gastrointestinal Surgery)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k60', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k61() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Return of spontaneous circulation (ROSC) achieving rate (JCI8-COP 4) - Emergency Department';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k61', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k62() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Timeliness of initiation of advanced cardiovascular life support (ACLS) within 5 Min (JCI8-COP 4) - Nursing';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k62', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k63() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Timeliness of staff response to cardiac arrest (JCI8-COP 4) - Emergency Department';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k63', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI3k64() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Rate to RRT response turn to Code blue (JCI8-COP 4) - Nursing';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k64', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function feedbacks_report_CQI3k65() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of patient Identification Errors for Diet patients (IPD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k65', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function feedbacks_report_CQI3k66() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Number of Patient safety events or patterns of events during procedural sedation';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI3k66', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function feedbacks_report_CQI4h1() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Patient satisfaction index - Physiotherapy (Physical therapy and Rehabilitation Department)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'TAT for radiology STAT orders (Radiology - CT)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'TAT for radiology STAT orders (Radiology - MRI)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'TAT for radiology STAT orders (Radiology - USG)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'HAZMAT compliance in radiology';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function feedbacks_report_CQI4h6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'TLD Reading Compliance (Radiology)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h7() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Variance in Financial counselling (Patient Care Services - IPD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h8() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Planned Discharge rate (Patient Care Services - IPD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h9() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Incident report rate (Quality Office)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function feedbacks_report_CQI4h10() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'TAT for dispensing medicine - IP (Pharmacy)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h11() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'TAT for STAT medicine (Pharmacy)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h12() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Average number of Doctors on hospital rolls at any point of time (HR)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h13() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Average Number of Nurses on hospital rolls at any point of time (HR)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h14() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Reason for staff exit (HR)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h14', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function feedbacks_report_CQI4h15() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to Internal complaints committee requirements (HR)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h15', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h16() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Effectiveness in recruitment (MRF submission days - Staff onboarded time) (HR)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h16', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h17() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to Employee Engagement activities (HR)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h17', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h18() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Number of Mandatory training hours coverage / staff (HR)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h18', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h19() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to ACLS training (HR)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h19', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h20() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Average units of electricity consumed/Day (Units) (Engineering & Maintenance)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h20', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h21() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'TAT for complaints on equipment/Utility/Facility (Engineering & Maintenance)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h21', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function feedbacks_report_CQI4h22() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Average units of water consumed/Day (L) (Engineering & Maintenance)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h22', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h23() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Adherence to PPE usage in Engineering and Maintenance department (Engineering & Maintenance)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h23', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h24() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to PM schedule (Engineering & Maintenance)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h24', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h25() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to safe storage of chemicals (Engineering & Maintenance)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h25', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h26() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Outsourced Security service Staff Attendance (Safety & Security - Security)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h26', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h27() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to reporting of critical values in Lab (within 30 min) (Lab Service)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h27', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h28() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to reporting of critical values in POCT (Lab Service)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h28', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h29() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'TAT for Lab tests (Lab Service)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h29', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h30() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'TAT for Lab STAT (Lab Service)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h30', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function feedbacks_report_CQI4h31() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to TAT for lab outsourced test (Lab Service)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h31', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h32() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Lab Specimen Rejection Rate (Lab Service)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h32', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h33() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Insurance Claims Rejection Rate (Insurance)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h33', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h34() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'TPA TAT (Insurance) for the month';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h34', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h35() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Medical Waste Collection Rate (House Keeping)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h35', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function feedbacks_report_CQI4h36() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to MSDS in Facility (House Keeping)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h36', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h37() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Percentage of Pest control Complaints rate (House Keeping)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h37', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h38() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Linen Quality - Compliance Rate (House Keeping)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h38', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h39() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Downtime of EMR (ITD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h39', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h40() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Outsourced staff manpower compliance rate (House Keeping)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h40', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4h41() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'ITD Preventive Maintenance compliance (ITD)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h41', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h42() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Biomedical Preventive Maintenance Completion rate (Biomedical Engineering)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h42', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h43() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Quality of patient transportation by ambulance (Out-sourced) (Lab Service)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h43', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h44() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'F&B Patient complaints rate (Food and Beverage Services)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h44', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h45() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Delay in room services (Food and Beverage Services)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h45', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h46() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = 'Compliance to PCRA (Engineering & Maintenance)';
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h46', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h47() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Compliances in patient room cleaning and hygiene practices (House Keeping)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h47', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h48() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Patient's Complaints Rate (House Keeping)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h48', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h49() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of renewable energy used against total energy used (JCI8-GHI 3) (Engineering & Maintenance)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h49', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h50() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "To Monitor the energy consumption (JCI8-GHI 3) (Engineering & Maintenance)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h50', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4h51() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of Wrong food Delivery for Patients & Bystanders (Food and Beverage Services)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h51', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h52() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of adherence to facility audit observation closure (Safety & Security)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h52', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h53() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Standardised Mortality Ratio for ICU - 1 (Nursing - ICU 1)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h53', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h54() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Standardised Mortality Ratio for ICU - 2 (Actual deaths in ICU-2)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h54', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h55() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Standardised Mortality Ratio for PICU (Actual deaths in PICU)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h55', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4h56() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Standardised Mortality Ratio for NICU (Actual deaths in NICU)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4h56', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CLOTCM1() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - Cardiology)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - CVTS)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CLOTCM3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - Gastro surgery)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - Gastroenterology)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - General Medicine)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - ICU)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM7() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - Nephrology)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM8() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - Neuro Intervention)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM9() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - Neurology)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM10() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - Neurosurgery)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CLOTCM11() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - Ortho neuro integrated spine)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM12() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - Ortho THR)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM13() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - Ortho TKR)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM14() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - Orthopaedics)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM14', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM15() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - Pulmonology)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM15', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM16() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average length of stay (MRD - Urology)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM16', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM17() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Catheter associated urinary tract infection rate (Infection Control - ICU1)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM17', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM18() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Catheter associated urinary tract infection rate (Infection Control - ICU2)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM18', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM19() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Catheter associated urinary tract infection rate (Infection Control - ICU3)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM19', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM20() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Central Line Associated Blood Stream Infection (CLABSI) - (Infection Control - ICU1)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM20', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CLOTCM21() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Central Line Associated Blood Stream Infection (CLABSI) - (Infection Control - ICU2)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM21', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM22() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Central Line Associated Blood Stream Infection (CLABSI) - (Infection Control - ICU3)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM22', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM23() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Surgical Site Infection rate (Infection Control - Ortho THR)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM23', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM24() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Surgical Site Infection rate (Infection Control - Ortho TKR)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM24', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM25() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Ventilator associated pneumonias (VAP) in 1000 ventilator days (Infection Control - ICU1)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM25', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM26() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Ventilator associated pneumonias (VAP) in 1000 ventilator days (Infection Control - ICU2)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM26', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM27() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Ventilator associated pneumonias (VAP) in 1000 ventilator days (Infection Control - ICU3)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM27', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM28() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Ventilator associated pneumonias (VAP) in 1000 ventilator days (Infection Control - Ortho THR)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM28', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM29() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Ventilator associated pneumonias (VAP) in 1000 ventilator days (Infection Control - Ortho TKR)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM29', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CLOTCM30() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Prevalence of transfusion reactions in Leuco depleted PRBC transfusions (Blood Center)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CLOTCM30', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4i1() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Compliance to medical service requests - Heart, Lung transplantation (Medical Administration)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4i2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Compliance to medical service requests - Liver transplantation";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4i3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "TAT compliance for radiology outsourced test (Radiology)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4i4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Food waste collection rate (House Keeping)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4i5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Solid waste collection rate (House Keeping)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4i6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Outsourced GDA (General Duty Assistance) absenteeism rate (House Keeping)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4i7() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Outsourced OPD Assistance attendance (Operation)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4i8() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Outsourced UTIZ staff attendance (House Keeping)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4i9() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Compliance to safe transportation of Oil waste (Engineering & Maintenance)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4i10() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Number of laundry loads reduced by optimizing and sorting laundry (JCI8-GHI 3)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4i11() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of cleaning products used biodegradable (JCI8-GHI 3)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4i12() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average use of Ecofriendly catering supplies in a month (JCI8-GHI 3)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4i13() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Average quantity of Medical waste disposed per month in Kgs (JCI8-GHI 3)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4i14() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Non-Recyclable Waste per Patient Day (Kg) (JCI8-GHI 3)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4i14', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4j1() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Door to Physician 10 min (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j2() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Door to stroke team 15 min (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j3() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Door to CT/MRI initiation 20 min (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j4() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Door to CT/MRI interpretation 30 min (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j5() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Order to lab results 30 min, if ordered (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4j6() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Door to IV thrombolytic bolus (75% compliance) 60 min (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j7() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Door to IV thrombolytic bolus (50% compliance) 45 min (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j8() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Door to puncture time 90 min (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j9() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "The periprocedural complication rates after correcting for various comorbidities (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j10() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "The periprocedural mortality rate for surgical or interventional procedures (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4j11() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of all stroke/TIA patients with a deficit at the time of initial note for whom an NIHSS score is documented (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j12() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of ischemic stroke patients eligible for intravenous thrombolysis who receive it within the appropriate time window (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function feedbacks_report_CQI4j13() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of patients treated for acute ischemic stroke with IV thrombolysis whose treatment is started within 60 minutes after arrival (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j14() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Time from arrival to start of initial imaging workup for patients arriving within 24 hours of last known well (Minutes) (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j14', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j15() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of ischemic stroke patients who develop symptomatic intracranial hemorrhage 36 hours after thrombolytic therapy or mechanical thrombectomy (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j15', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j16() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of patients undergoing CEA, carotid angioplasty or stenting having stroke or death within 30 days of the procedure (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j16', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j17() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of patients undergoing intracranial angioplasty and/or stenting for atherosclerotic disease having stroke or death within 30 days of the procedure (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j17', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j18() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of patients with stroke or death within 24 hours of diagnostic cerebral-angiography (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j18', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j19() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of patients diagnosed with ischemic stroke who undergo EVD and then develop ventriculitis (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j19', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j20() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of ischemic stroke patients with post-treatment reperfusion grade of TICI 2B or higher after intra-arterial thrombolytic therapy or mechanical endovascular reperfusion (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j20', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j21() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of ischemic stroke patients with large vessel cerebral occlusion who receive mechanical endovascular reperfusion therapy within 120 minutes and achieve TICI 2B or higher (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j21', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function feedbacks_report_CQI4j22() {
        $fdate = date('Y-m-d');
        $tdate = date('Y-m-01');
        $_SESSION['from_date'] = $fdate;
        $_SESSION['to_date'] = $tdate;
    
        if ($this->session->userdata('isLogIn') == false) redirect('login');
    
        if (ismodule_active('QUALITY') === true) {
            $dateInfo = get_from_to_date();
            $pagetitle = $dateInfo['pagetitle'];
            $titleSuffix = "";
    
            if ($pagetitle === "Current Month") {
                $titleSuffix = strtoupper(date('F Y'));
            } elseif ($pagetitle === "Previous Month") {
                $titleSuffix = strtoupper(date('F Y', strtotime('-1 month')));
            } elseif ($pagetitle === "Last 365 Days") {
                $titleSuffix = "LAST 365 DAYS";
            } elseif ($pagetitle === "Last 30 Days") {
                $titleSuffix = "LAST 30 DAYS";
            } elseif ($pagetitle === "Custom") {
                $titleSuffix = date('F Y', strtotime($dateInfo['tdate'])) . " - " . date('F Y', strtotime($dateInfo['fdate']));
            } elseif ($pagetitle === "Last 24 Hours") {
                $titleSuffix = "LAST 24 HOURS";
            } elseif ($pagetitle === "Quaterly") {
                $titleSuffix = "LAST 90 DAYS";
            } else {
                $titleSuffix = $pagetitle;
            }
    
            $data['title'] = "Percentage of ischemic stroke patients with large vessel cerebral occlusion who receive mechanical endovascular reperfusion therapy and achieve TICI 2B or higher 60 minutes from skin puncture (Stroke Unit)";
            $data['content'] = $this->load->view('qualitymodules/feedbacks_report_CQI4j22', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }




    


    

















































    
























        

        



    



    //individual page for all KPI
    public function patient_feedback_CQI3a1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $data['title'] = 'QUALITY KPI ANALYSIS';
            #------------------------------#

            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a1', $data, true);


            $this->load->view('layout/main_wrapper', $data);
            // redirect('report/ip_patient_feedback');

        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function patient_feedback_CQI3a2()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function patient_feedback_CQI3a3()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a4()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a5()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a6()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a7()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a8()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a9()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a10()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function patient_feedback_CQI3a11()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a12()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a13()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a14()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a14', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a15()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a15', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a16()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a16', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a17()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a17', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a18()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a18', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a19()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a19', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a20()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a20', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a21()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a21', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3a22()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3a22', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function patient_feedback_CQI3b1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3b1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3b2()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3b2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3b3()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3b3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3b4()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3b4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3b5()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3b5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3b6()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3b6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3b7()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3b7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3b8()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3b8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3b9()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3b9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3b10()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3b10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3b11()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3b11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3b12()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3b12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3b13()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3b13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3c1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3c2()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3c3()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3c4()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3c5()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3c6()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3c7()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3c8()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3c9()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3c10()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3c11()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function patient_feedback_CQI3c12()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3c13()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3c14()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3c14', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3d1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3d1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3d2()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3d2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3d3()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3d3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3d4()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3d4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3d5()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3d5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3e1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3e1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3e2()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3e2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3e3()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3e3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3e4()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3e4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3e5()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3e5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3e6()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3e6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3e7()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3e7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3e8()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3e8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3e9()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
    
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3e9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
    
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function patient_feedback_CQI3f1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3f1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3f2()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3f2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3f3()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3f3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3f4()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3f4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3f5()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3f5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3f6()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3f6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3f7()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3f7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3f8()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3f8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3f9()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3f9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3f10()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3f10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3g1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3g1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3g2()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3g2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3g3()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3g3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3g4()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3g4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3g5()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3g5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3g6()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3g6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3h1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3h1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3h2()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3h2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3h3()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3h3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3h4()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3h4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3h5()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3h5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3h6()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3h6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3h7()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3h7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3h8()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3h8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3h9()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3h9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function patient_feedback_CQI3j1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j2()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j3()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j4()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j5()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j6()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j7()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j8()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j9()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j10()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j11()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function patient_feedback_CQI3j12()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j13()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j14()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j14', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j15()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j15', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j16()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j16', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j17()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j17', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j18()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j18', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j19()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j19', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j20()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j20', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j21()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j21', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j22()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j22', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j23()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j23', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j24()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j24', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j25()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j25', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j26()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j26', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j27()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j27', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j28()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j28', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j29()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j29', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j30()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j30', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j31()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j31', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j32()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j32', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j33()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j33', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI3j34()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI3j34', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function patient_feedback_CQI4a1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4a1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI4a2()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4a2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    public function patient_feedback_CQI4a3()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4a3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    
    // CQI4a4 - Percentage of drugs and consumables rejected before preparation of Goods Receipt Note(SCM-Store)
    public function patient_feedback_CQI4a4()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4a4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4a5 - Percentage of variations from procurement process(SCM-Purchase)
    public function patient_feedback_CQI4a5()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4a5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4b1 - Incidence of bed sores (hospital associated pressure ulcers) after admission (in 1000 patient days)-(Nursing)
    public function patient_feedback_CQI4b1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4b1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4b2 - Incidence of falls (in 1000 IPD days)-(Office-Quality)
    public function patient_feedback_CQI4b2()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4b2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4b3 - Number of variations observed in mock drill(Safety & Security)
    public function patient_feedback_CQI4b3()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4b3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4b4 - Percentage of staff provided with pre-exposure prophylaxis(Infection Control)
    public function patient_feedback_CQI4b4()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4b4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4b5 - Number of Fire Incidents (Safety & Security)
    public function patient_feedback_CQI4b5()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4b5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4b6 - Incidence of device associated pressure ulcer after admission(Nursing)
    public function patient_feedback_CQI4b6()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4b6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4b7 - Number of Extravasation (Nursing)
    public function patient_feedback_CQI4b7()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4b7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4b8 - Monitoring of Clinical Errors (JCI8-PCC 2.3)-(Quality Office)
    public function patient_feedback_CQI4b8()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4b8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    // CQI4c1 - Bed occupancy rate (MRD)
    public function patient_feedback_CQI4c1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4c2 - Average length of stay (MRD)
    public function patient_feedback_CQI4c2()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4c3 - OT Utilisation Rate (OT)
    public function patient_feedback_CQI4c3()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4c4 - ICU equipment utilisation rate (Nursing - ICU1)
    public function patient_feedback_CQI4c4()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4c5 - ICU equipment utilisation rate (Nursing - ICU2)
    public function patient_feedback_CQI4c5()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4c6 - ICU equipment utilisation rate (Nursing - ICU3)
    public function patient_feedback_CQI4c6()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4c7 - ICU Bed utilisation rate (Nursing - ICU)
    public function patient_feedback_CQI4c7()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4c8 - Critical equipment downtime (Biomedical Engineering)
    public function patient_feedback_CQI4c8()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4c9 - Cath lab utilization rate (Cath Lab - Nursing)
    public function patient_feedback_CQI4c9()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4c10 - Nurse patient ratio for ICU Ventilated (Nursing-ICU)
    public function patient_feedback_CQI4c10()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4c11 - Nurse patient ratio for ICU Non Ventilated (Nursing-ICU)
    public function patient_feedback_CQI4c11()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4c12 - Nurse patient ratio for HDU (Nursing-HDU)
    public function patient_feedback_CQI4c12()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c12', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4c13 - Nurse patient ratio for Ward (Nursing-Ward)
    public function patient_feedback_CQI4c13()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c13', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4c14 - Engineering Critical equipment downtime (Engineering & Maintenance)
    public function patient_feedback_CQI4c14()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4c14', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    // CQI4d1 - Out patient satisfaction index (Patient Care Services - OPD)
    public function patient_feedback_CQI4d1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4d1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4d2 - Inpatient satisfaction index (Patient Care Services - IPD)
    public function patient_feedback_CQI4d2()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4d2', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4d3 - Time taken for discharge - Cash Patients (Patient Care Services - Cash)
    public function patient_feedback_CQI4d3()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4d3', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4d4 - Time taken for discharge Cashless Patients (Patient Care Services - Cashless)
    public function patient_feedback_CQI4d4()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4d4', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4d5 - Waiting time for diagnostic services (Radiology - CT)
    public function patient_feedback_CQI4d5()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4d5', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4d6 - Waiting time for diagnostic services (Radiology - MRI)
    public function patient_feedback_CQI4d6()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4d6', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4d7 - Waiting time for diagnostic services (Radiology - USG)
    public function patient_feedback_CQI4d7()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4d7', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4d8 - Waiting Time for OPD appointments (Patient Care Services - OPD)
    public function patient_feedback_CQI4d8()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4d8', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4d9 - Waiting Time for OPD Walkin (Patient Care Services - OPD)
    public function patient_feedback_CQI4d9()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4d9', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4d10 - Patient Satisfaction Rate (Nursing - OBG)
    public function patient_feedback_CQI4d10()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4d10', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    
    // CQI4d11 - Turn-around Time for Nursing call bell responds (Nursing)
    public function patient_feedback_CQI4d11()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4d11', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else {
            redirect('dashboard/noaccess');
        }
    }
    // ======================== CQI4e1  CQI4e8 ========================

// CQI4e1 - Employee satisfaction index (HR)
    public function patient_feedback_CQI4e1()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title'] = 'QUALITY KPI ANALYSIS';
            $data['content'] = $this->load->view('qualitymodules/patient_feedback_CQI4e1', $data, true);
            $this->load->view('layout/main_wrapper', $data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4e2 - Employee attrition rate (HR)
    public function patient_feedback_CQI4e2()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY') === true) {
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4e2',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4e3 - Employee absenteeism rate (HR)
    public function patient_feedback_CQI4e3()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4e3',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4e4 - Percentage of employees aware of rights, responsibility and welfare schemes (HR)
    public function patient_feedback_CQI4e4()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4e4',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4e5 - Average number of training hours (HR)
    public function patient_feedback_CQI4e5()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4e5',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4e6 - Nurses Attrition Rate (Nursing)
    public function patient_feedback_CQI4e6()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4e6',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4e7 - Outsourced employee absenteeism rate (Nursing Assistants - Patient Care Services - OPD)
    public function patient_feedback_CQI4e7()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4e7',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4e8 - Average number of unpaid leave per month (HR)
    public function patient_feedback_CQI4e8()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4e8',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // ======================== CQI4f1  CQI4f7 ========================
    
    // CQI4f1 - Incidence of needle stick injuries IPD area (in 1000 IPD days) (Infection Control - IPD)
    public function patient_feedback_CQI4f1()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4f1',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4f2 - Incidence of needle stick injuries OPD area (in 1000 OPD days) (Infection Control - OPD)
    public function patient_feedback_CQI4f2()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4f2',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4f3 - Percentage of sentinel events, reported, collected and analysed within the defined time frame (Quality Office)
    public function patient_feedback_CQI4f3()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4f3',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4f4 - Percentage of near misses (Quality Office)
    public function patient_feedback_CQI4f4()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4f4',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4f5 - Incidence of blood body fluid exposure IPD (Infection Control - IPD)
    public function patient_feedback_CQI4f5()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4f5',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4f6 - Incidence of blood body fluid exposure OPD (Infection Control - OPD)
    public function patient_feedback_CQI4f6()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4f6',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4f7 - Adverse events related to SUDs (JCI8-PCI 3.1) (CSSD)
    public function patient_feedback_CQI4f7()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4f7',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // ======================== CQI4g1  CQI4g6 ========================
    
    // CQI4g1 - Percentage of Medical records not having discharge summary (MRD)
    public function patient_feedback_CQI4g1()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4g1',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4g2 - Percentage of Medical records not having codification as per ICD (MRD)
    public function patient_feedback_CQI4g2()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4g2',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4g3 - Percentage of Medical records having improper or incomplete consent (MRD)
    public function patient_feedback_CQI4g3()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4g3',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4g4 - Percentage of missing medical records (MRD)
    public function patient_feedback_CQI4g4()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4g4',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4g5 - Compliance rate of adhering with policies and procedures for care of patients at risk for suicide and self-harm (JCI8-COP 5) (MRD)
    public function patient_feedback_CQI4g5()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4g5',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4g6 - Monthly Abbreviation Compliance (MRD)
    public function patient_feedback_CQI4g6()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4g6',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    // ======================== CQI3k1  CQI3k20 ========================

// CQI3k1 - Total number of LAMA cases with Reasons (MRD)
    public function patient_feedback_CQI3k1()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k1',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k2 - Adverse events due to handover (Quality Office)
    public function patient_feedback_CQI3k2()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k2',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k3 - Inguinal herniorrhaphy with mesh (Infection Control)
    public function patient_feedback_CQI3k3()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k3',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k4 - Coronary artery bypass grafting (CABG) (Infection Control)
    public function patient_feedback_CQI3k4()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k4',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k5 - Laparoscopic cholecystectomy (Infection Control)
    public function patient_feedback_CQI3k5()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k5',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k6 - Monitoring the duration of antibiotic usage in surgical prophylaxis (After 48 hours) (Clinical Pharmacy)
    public function patient_feedback_CQI3k6()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k6',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k7 - De-escalation of antibiotics (Clinical Pharmacy)
    public function patient_feedback_CQI3k7()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k7',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k8 - High Alert Medication Segregation, storage & labelling Compliance rate (Pharmacy - Store)
    public function patient_feedback_CQI3k8()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k8',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k9 - Average recovery time (OT-Post OP)
    public function patient_feedback_CQI3k9()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k9',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k10 - Door to thrombolysis time in ischemic stroke in ER (Emergency Department)
    public function patient_feedback_CQI3k10()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k10',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k11 - Door to image time in Stroke patients (Emergency Department)
    public function patient_feedback_CQI3k11()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k11',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k12 - Average number of patients visiting Emergency per day (Emergency Department)
    public function patient_feedback_CQI3k12()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k12',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k13 - Efficiency of code blue team (Emergency Department)
    public function patient_feedback_CQI3k13()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k13',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k14 - Time for first defibrillation (Emergency Department)
    public function patient_feedback_CQI3k14()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k14',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k15 - Door to Balloon time in PTCA (Cath Lab)
    public function patient_feedback_CQI3k15()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k15',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k16 - Compliance to diet order (Clinical Nutrition and Dietetics)
    public function patient_feedback_CQI3k16()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k16',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k17 - Case Fatality 1 - CAD (MRD)
    public function patient_feedback_CQI3k17()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k17',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k18 - Case Fatality 2 - Acute coronary syndrome (MRD)
    public function patient_feedback_CQI3k18()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k18',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k19 - Case Fatality 3 - Cerebral infarction (MRD)
    public function patient_feedback_CQI3k19()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k19',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k20 - Case Fatality 4 - MI (MRD)
    public function patient_feedback_CQI3k20()
    {
        if ($this->session->userdata('isLogIn') == false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k20',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    // ======================== CQI3k21  CQI3k40 ========================

// CQI3k21 - Case Fatality 5 - Heart failure (MRD)
    public function patient_feedback_CQI3k21()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k21',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k22 - Compliances in patient transfer and transportation process (External transfer) (Emergency Department)
    public function patient_feedback_CQI3k22()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k22',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k23 - Number of Adverse Events During Patient Transfers (Out Side) (Emergency Department)
    public function patient_feedback_CQI3k23()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k23',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k24 - ILC/EQAS compliance rate (Lab Services)
    public function patient_feedback_CQI3k24()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k24',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k25 - Compliance with Biological Indicator (CSSD)
    public function patient_feedback_CQI3k25()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k25',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k26 - Compliance to risk assessment in reprocessing of SUMD (CSSD)
    public function patient_feedback_CQI3k26()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k26',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k27 - Non-compliance to Copy and paste policy (MRD)
    public function patient_feedback_CQI3k27()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k27',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k28 - Compliance to POCT IQC Checking (Lab Services)
    public function patient_feedback_CQI3k28()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k28',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k29 - Case Fatality - COVID 19 (MRD)
    public function patient_feedback_CQI3k29()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k29',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k30 - Case Fatality - Stroke (MRD)
    public function patient_feedback_CQI3k30()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k30',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k31 - Post procedure complication rate - Colonoscopy (Endoscopy)
    public function patient_feedback_CQI3k31()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k31',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k32 - Polyp retrieval rate after colonoscopic polypectomy (Endoscopy)
    public function patient_feedback_CQI3k32()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k32',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k33 - Survival rate for living donor kidney transplants (Nephrology)
    public function patient_feedback_CQI3k33()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k33',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k34 - CAUTI Prevention Bundle compliance Rate (Infection Control)
    public function patient_feedback_CQI3k34()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k34',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k35 - Major Discrepancies between Preoperative and Post operative Diagnosis (OT)
    public function patient_feedback_CQI3k35()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k35',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k36 - Adverse Events Related to patient Identification (Quality Office)
    public function patient_feedback_CQI3k36()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k36',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k37 - CLABSI Prevention Bundle compliance Rate (Infection Control)
    public function patient_feedback_CQI3k37()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k37',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k38 - SSI Prevention Bundle compliance Rate (Infection Control)
    public function patient_feedback_CQI3k38()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k38',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k39 - VAP Prevention Bundle compliance Rate (Infection Control)
    public function patient_feedback_CQI3k39()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k39',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k40 - Restraint related injuries among admitted patients (Nursing)
    public function patient_feedback_CQI3k40()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k40',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    // ======================== CQI3k41  CQI3k60 ========================

// CQI3k41 - Rate of compliance for restraint consent policy (Nursing)
    public function patient_feedback_CQI3k41()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k41',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k42 - Percentage of Accidental removal of line (Nursing)
    public function patient_feedback_CQI3k42()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k42',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k43 - Significant hypotension necessitating termination of dialysis (Nursing)
    public function patient_feedback_CQI3k43()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k43',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k44 - IPSG4 - Time out compliance in outside OT (Nursing)
    public function patient_feedback_CQI3k44()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k44',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k45 - Percentage of cases where Initial assessment done in physiotherapy within 24 hours (IPD) (Physical therapy and Rehabilitation Department - Medical records)
    public function patient_feedback_CQI3k45()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k45',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k46 - Radiology TAT orders for CT (Radiology)
    public function patient_feedback_CQI3k46()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k46',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k47 - Radiology TAT orders for MRI (Radiology)
    public function patient_feedback_CQI3k47()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k47',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k48 - Radiology TAT orders for USG (Radiology)
    public function patient_feedback_CQI3k48()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k48',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k49 - Radiology TAT orders for X-ray (Radiology)
    public function patient_feedback_CQI3k49()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k49',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k50 - Site Marking Compliance Rate (OT)
    public function patient_feedback_CQI3k50()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k50',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k51 - Time Out Compliance Rate (OT)
    public function patient_feedback_CQI3k51()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k51',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k52 - Sign Out Compliance Rate (OT)
    public function patient_feedback_CQI3k52()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k52',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k53 - Post transplant complication rate for Donor (Liver) (Transplant Unit)
    public function patient_feedback_CQI3k53()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k53',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k54 - Post transplant complication rate (Heart) (Transplant Unit)
    public function patient_feedback_CQI3k54()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k54',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k55 - Percentage of research activities approved by ethics committee (Research)
    public function patient_feedback_CQI3k55()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k55',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k56 - Percentage of patients withdrawing from the study (Research)
    public function patient_feedback_CQI3k56()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k56',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k57 - Percentage of protocol violations/deviations reported (Research)
    public function patient_feedback_CQI3k57()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k57',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k58 - Percentage of serious adverse events reported to ethics committee within defined timeframe (Research)
    public function patient_feedback_CQI3k58()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k58',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k59 - Percentage of cases where Initial assessment done in physiotherapy within 24 hours OPD (Physical therapy and Rehabilitation Department - Medical records)
    public function patient_feedback_CQI3k59()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k59',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k60 - Survival rate for living donor Liver transplants (Gastrointestinal Surgery)
    public function patient_feedback_CQI3k60()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k60',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    // ======================== CQI3k61  CQI4h25 ========================

// CQI3k61 - Return of spontaneous circulation (ROSC) achieving rate (JCI8-COP 4) (Emergency Department)
    public function patient_feedback_CQI3k61()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k61',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k62 - Timeliness of initiation of advanced cardiovascular life support (ACLS) within 5 Min (JCI8-COP 4) (Nursing)
    public function patient_feedback_CQI3k62()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k62',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k63 - Timeliness of staff response to cardiac arrest (JCI8-COP 4) (Emergency Department)
    public function patient_feedback_CQI3k63()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k63',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI3k64 - Rate to RRT response turn to Code blue (JCI8-COP 4) (Nursing)
    public function patient_feedback_CQI3k64()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k64',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }

    public function patient_feedback_CQI3k65()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k65',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }

    public function patient_feedback_CQI3k66()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI3k66',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h1 - Patient satisfaction index - Physiotherapy (Physical therapy and Rehabilitation Department)
    public function patient_feedback_CQI4h1()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h1',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h2 - TAT for radiology STAT orders (Radiology - CT)
    public function patient_feedback_CQI4h2()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h2',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h3 - TAT for radiology STAT orders (Radiology - MRI)
    public function patient_feedback_CQI4h3()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h3',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h4 - TAT for radiology STAT orders (Radiology - USG)
    public function patient_feedback_CQI4h4()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h4',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h5 - HAZMAT compliance in radiology
    public function patient_feedback_CQI4h5()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h5',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h6 - TLD Reading Compliance (Radiology)
    public function patient_feedback_CQI4h6()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h6',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h7 - Variance in Financial counselling (Patient Care Services - IPD)
    public function patient_feedback_CQI4h7()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h7',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h8 - Planned Discharge rate (Patient Care Services - IPD)
    public function patient_feedback_CQI4h8()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h8',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h9 - Incident report rate (Quality Office)
    public function patient_feedback_CQI4h9()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h9',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h10 - TAT for dispensing medicine - IP (Pharmacy)
    public function patient_feedback_CQI4h10()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h10',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h11 - TAT for STAT medicine (Pharmacy)
    public function patient_feedback_CQI4h11()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h11',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h12 - Average number of Doctors on hospital rolls at any point of time (HR)
    public function patient_feedback_CQI4h12()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h12',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h13 - Average Number of Nurses on hospital rolls at any point of time (HR)
    public function patient_feedback_CQI4h13()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h13',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h14 - Reason for staff exit (HR)
    public function patient_feedback_CQI4h14()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h14',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h15 - Compliance to Internal complaints committee requirements (HR)
    public function patient_feedback_CQI4h15()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h15',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    // ======================== CQI4h16  CQI4h40 ========================

// CQI4h16 - Effectiveness in recruitment (MRF submission days - Staff onboarded time) (HR)
    public function patient_feedback_CQI4h16()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h16',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h17 - Compliance to Employee Engagement activities (HR)
    public function patient_feedback_CQI4h17()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h17',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h18 - Number of Mandatory training hours coverage / staff (HR)
    public function patient_feedback_CQI4h18()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h18',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h19 - Compliance to ACLS training (HR)
    public function patient_feedback_CQI4h19()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h19',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h20 - Average units of electricity consumed/Day (Units) (Engineering & Maintenance)
    public function patient_feedback_CQI4h20()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h20',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h21 - TAT for complaints on equipment/Utility/Facility (Engineering & Maintenance)
    public function patient_feedback_CQI4h21()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h21',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h22 - Average units of water consumed/Day (L) (Engineering & Maintenance)
    public function patient_feedback_CQI4h22()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h22',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h23 - Adherence to PPE usage in Engineering and Maintenance department (Engineering & Maintenance)
    public function patient_feedback_CQI4h23()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h23',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h24 - Compliance to PM schedule (Engineering & Maintenance)
    public function patient_feedback_CQI4h24()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h24',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h25 - Compliance to safe storage of chemicals (Engineering & Maintenance)
    public function patient_feedback_CQI4h25()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h25',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h26 - Outsourced Security service Staff Attendance (Safety & Security - Security)
    public function patient_feedback_CQI4h26()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h26',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h27 - Compliance to reporting of critical values in Lab (within 30 min) (Lab Service)
    public function patient_feedback_CQI4h27()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h27',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h28 - Compliance to reporting of critical values in POCT (Lab Service)
    public function patient_feedback_CQI4h28()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h28',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h29 - TAT for Lab tests (Lab Service)
    public function patient_feedback_CQI4h29()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h29',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h30 - TAT for Lab STAT (Lab Service)
    public function patient_feedback_CQI4h30()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h30',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h31 - Compliance to TAT for lab outsourced test (Lab Service)
    public function patient_feedback_CQI4h31()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h31',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h32 - Lab Specimen Rejection Rate (Lab Service)
    public function patient_feedback_CQI4h32()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h32',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h33 - Insurance Claims Rejection Rate (Insurance)
    public function patient_feedback_CQI4h33()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h33',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h34 - TPA TAT (Insurance) for the month
    public function patient_feedback_CQI4h34()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h34',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h35 - Medical Waste Collection Rate (House Keeping)
    public function patient_feedback_CQI4h35()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h35',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h36 - Compliance to MSDS in Facility (House Keeping)
    public function patient_feedback_CQI4h36()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h36',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h37 - Percentage of Pest control Complaints rate (House Keeping)
    public function patient_feedback_CQI4h37()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h37',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h38 - Linen Quality - Compliance Rate (House Keeping)
    public function patient_feedback_CQI4h38()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h38',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h39 - Downtime of EMR (ITD)
    public function patient_feedback_CQI4h39()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h39',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h40 - Outsourced staff manpower compliance rate (House Keeping)
    public function patient_feedback_CQI4h40()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h40',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    // ======================== CQI4h41  CQI4h56 ========================

// CQI4h41 - ITD Preventive Maintenance compliance (ITD)
    public function patient_feedback_CQI4h41()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h41',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h42 - Biomedical Preventive Maintenance Completion rate (Biomedical Engineering)
    public function patient_feedback_CQI4h42()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h42',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h43 - Quality of patient transportation by ambulance (Out-sourced) (Lab Service)
    public function patient_feedback_CQI4h43()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h43',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h44 - F&B Patient complaints rate (Food and Beverage Services)
    public function patient_feedback_CQI4h44()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h44',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h45 - Delay in room services (Food and Beverage Services)
    public function patient_feedback_CQI4h45()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h45',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h46 - Compliance to PCRA (Engineering & Maintenance)
    public function patient_feedback_CQI4h46()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h46',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h47 - Compliances in patient room cleaning and hygiene practices (House Keeping)
    public function patient_feedback_CQI4h47()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h47',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h48 - Patient's Complaints Rate (House Keeping)
    public function patient_feedback_CQI4h48()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h48',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h49 - Percentage of renewable energy used against total energy used (JCI8-GHI 3) (Engineering & Maintenance)
    public function patient_feedback_CQI4h49()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h49',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h50 - To Monitor the energy consumption (JCI8-GHI 3) (Engineering & Maintenance)
    public function patient_feedback_CQI4h50()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h50',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h51 - Percentage of Wrong food Delivery for Patients & Bystanders (Food and Beverage Services)
    public function patient_feedback_CQI4h51()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h51',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h52 - Percentage of adherence to facility audit observation closure (Safety & Security)
    public function patient_feedback_CQI4h52()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h52',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h53 - Standardised Mortality Ratio for ICU - 1 (Nursing - ICU 1)
    public function patient_feedback_CQI4h53()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h53',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h54 - Standardised Mortality Ratio for ICU - 2 (Actual deaths in ICU-2)
    public function patient_feedback_CQI4h54()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h54',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h55 - Standardised Mortality Ratio for PICU (Actual deaths in PICU)
    public function patient_feedback_CQI4h55()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h55',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4h56 - Standardised Mortality Ratio for NICU (Actual deaths in NICU)
    public function patient_feedback_CQI4h56()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4h56',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    // ======================== CLOTCM1  CLOTCM20 ========================

// CLOTCM1 - Average length of stay (MRD - Cardiology)
    public function patient_feedback_CLOTCM1()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM1',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM2 - Average length of stay (MRD - CVTS)
    public function patient_feedback_CLOTCM2()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM2',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM3 - Average length of stay (MRD - Gastro surgery)
    public function patient_feedback_CLOTCM3()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM3',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM4 - Average length of stay (MRD - Gastroenterology)
    public function patient_feedback_CLOTCM4()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM4',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM5 - Average length of stay (MRD - General Medicine)
    public function patient_feedback_CLOTCM5()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM5',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM6 - Average length of stay (MRD - ICU)
    public function patient_feedback_CLOTCM6()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM6',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM7 - Average length of stay (MRD - Nephrology)
    public function patient_feedback_CLOTCM7()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM7',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM8 - Average length of stay (MRD - Neuro Intervention)
    public function patient_feedback_CLOTCM8()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM8',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM9 - Average length of stay (MRD - Neurology)
    public function patient_feedback_CLOTCM9()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM9',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM10 - Average length of stay (MRD - Neurosurgery)
    public function patient_feedback_CLOTCM10()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM10',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM11 - Average length of stay (MRD - Ortho neuro integrated spine)
    public function patient_feedback_CLOTCM11()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM11',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM12 - Average length of stay (MRD - Ortho THR)
    public function patient_feedback_CLOTCM12()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM12',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM13 - Average length of stay (MRD - Ortho TKR)
    public function patient_feedback_CLOTCM13()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM13',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM14 - Average length of stay (MRD - Orthopaedics)
    public function patient_feedback_CLOTCM14()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM14',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM15 - Average length of stay (MRD - Pulmonology)
    public function patient_feedback_CLOTCM15()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM15',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM16 - Average length of stay (MRD - Urology)
    public function patient_feedback_CLOTCM16()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM16',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM17 - Catheter associated urinary tract infection rate (Infection Control - ICU1)
    public function patient_feedback_CLOTCM17()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM17',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM18 - Catheter associated urinary tract infection rate (Infection Control - ICU2)
    public function patient_feedback_CLOTCM18()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM18',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM19 - Catheter associated urinary tract infection rate (Infection Control - ICU3)
    public function patient_feedback_CLOTCM19()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM19',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM20 - Central Line Associated Blood Stream Infection (CLABSI) - (Infection Control - ICU1)
    public function patient_feedback_CLOTCM20()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM20',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    // ======================== CLOTCM21  CLOTCM30 ========================

// CLOTCM21 - Central Line Associated Blood Stream Infection (CLABSI) (Infection Control - ICU2)
    public function patient_feedback_CLOTCM21()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM21',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM22 - Central Line Associated Blood Stream Infection (CLABSI) (Infection Control - ICU3)
    public function patient_feedback_CLOTCM22()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM22',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM23 - Surgical Site Infection rate (Infection Control - Ortho THR)
    public function patient_feedback_CLOTCM23()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM23',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM24 - Surgical Site Infection rate (Infection Control - Ortho TKR)
    public function patient_feedback_CLOTCM24()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM24',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM25 - Ventilator associated pneumonias (VAP) in 1000 ventilator days (Infection Control - ICU1)
    public function patient_feedback_CLOTCM25()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM25',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM26 - Ventilator associated pneumonias (VAP) in 1000 ventilator days (Infection Control - ICU2)
    public function patient_feedback_CLOTCM26()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM26',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM27 - Ventilator associated pneumonias (VAP) in 1000 ventilator days (Infection Control - ICU3)
    public function patient_feedback_CLOTCM27()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM27',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM28 - Ventilator associated pneumonias (VAP) in 1000 ventilator days (Infection Control - Ortho THR)
    public function patient_feedback_CLOTCM28()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM28',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM29 - Ventilator associated pneumonias (VAP) in 1000 ventilator days (Infection Control - Ortho TKR)
    public function patient_feedback_CLOTCM29()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM29',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CLOTCM30 - Prevalence of transfusion reactions in Leuco depleted PRBC transfusions (Blood Center)
    public function patient_feedback_CLOTCM30()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CLOTCM30',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    // ======================== CQI4i1  CQI4i14 ========================

// CQI4i1 - Compliance to medical service requests - Heart, Lung transplantation (Medical Administration)
    public function patient_feedback_CQI4i1()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i1',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4i2 - Compliance to medical service requests - Heart, Lung transplantation (Liver transplantation)
    public function patient_feedback_CQI4i2()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i2',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4i3 - TAT compliance for radiology outsourced test (Radiology)
    public function patient_feedback_CQI4i3()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i3',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4i4 - Food waste collection rate (House Keeping)
    public function patient_feedback_CQI4i4()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i4',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4i5 - Solid waste collection rate (House Keeping)
    public function patient_feedback_CQI4i5()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i5',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4i6 - Outsourced GDA (General Duty Assistance) absenteeism rate (House Keeping)
    public function patient_feedback_CQI4i6()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i6',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4i7 - Outsourced OPD Assistance attendance (Operation)
    public function patient_feedback_CQI4i7()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i7',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4i8 - Outsourced UTIZ staff attendance (House Keeping)
    public function patient_feedback_CQI4i8()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i8',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4i9 - Compliance to safe transportation of Oil waste (Engineering & Maintenance)
    public function patient_feedback_CQI4i9()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i9',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4i10 - Number of laundry loads reduced by optimizing and sorting laundry (GHI 3ME4) (JCI8-GHI 3) - (House Keeping)
    public function patient_feedback_CQI4i10()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i10',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4i11 - Percentage of cleaning products used biodegradable (GHI 3ME4) (JCI8-GHI 3) - (House Keeping)
    public function patient_feedback_CQI4i11()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i11',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4i12 - Average use of Ecofriendly catering supplies in a month (carbon intensity reduction - JCI8-GHI 3) - (House Keeping)
    public function patient_feedback_CQI4i12()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i12',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4i13 - Average quantity of Medical waste disposed per month in Kgs (Clinical practices to reduce the environmental impact - JCI8-GHI 3) - (House Keeping)
    public function patient_feedback_CQI4i13()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i13',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4i14 - Non-Recyclable Waste per Patient Day (Kg) - (JCI8-GHI 3) - (House Keeping)
    public function patient_feedback_CQI4i14()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4i14',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    // ======================== CQI4j1  CQI4j22 ========================

// CQI4j1 - Door to Physician 10 min (Stroke Unit)
    public function patient_feedback_CQI4j1()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j1',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j2 - Door to stroke team 15 min (Stroke Unit)
    public function patient_feedback_CQI4j2()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j2',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j3 - Door to CT/MRI initiation 20 min (Stroke Unit)
    public function patient_feedback_CQI4j3()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j3',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j4 - Door to CT/MRI interpretation 30 min (Stroke Unit)
    public function patient_feedback_CQI4j4()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j4',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j5 - Order to lab results 30 min, if ordered (Stroke Unit)
    public function patient_feedback_CQI4j5()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j5',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j6 - Door to IV thrombolytic bolus (75% compliance) 60 min (Stroke Unit)
    public function patient_feedback_CQI4j6()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j6',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j7 - Door to IV thrombolytic bolus (50% compliance) 45 min (Stroke Unit)
    public function patient_feedback_CQI4j7()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j7',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j8 - Door to puncture time 90 min (Stroke Unit)
    public function patient_feedback_CQI4j8()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j8',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j9 - Periprocedural complication rates (Stroke Unit)
    public function patient_feedback_CQI4j9()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j9',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j10 - Periprocedural mortality rate for surgical/interventional procedures (Stroke Unit)
    public function patient_feedback_CQI4j10()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j10',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j11 - Percentage of all stroke/TIA patients with NIHSS score documented (Stroke Unit)
    public function patient_feedback_CQI4j11()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j11',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j12 - Percentage of ischemic stroke patients receiving thrombolysis within time window (Stroke Unit)
    public function patient_feedback_CQI4j12()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j12',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j13 - Percentage of patients treated for acute ischemic stroke with IV thrombolysis within 60 min (Stroke Unit)
    public function patient_feedback_CQI4j13()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j13',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j14 - Time from arrival to start of initial imaging workup (Stroke Unit)
    public function patient_feedback_CQI4j14()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j14',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j15 - Percentage of ischemic stroke patients developing symptomatic intracranial hemorrhage within 36h (Stroke Unit)
    public function patient_feedback_CQI4j15()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j15',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j16 - Percentage of patients undergoing CEA or carotid interventions with stroke/death within 30 days (Stroke Unit)
    public function patient_feedback_CQI4j16()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j16',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j17 - Percentage of patients undergoing intracranial angioplasty/stenting with stroke/death within 30 days (Stroke Unit)
    public function patient_feedback_CQI4j17()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j17',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j18 - Percentage of patients with stroke/death within 24h of diagnostic cerebral-angiography (Stroke Unit)
    public function patient_feedback_CQI4j18()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j18',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j19 - Percentage of ischemic stroke patients undergoing EVD developing ventriculitis (Stroke Unit)
    public function patient_feedback_CQI4j19()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j19',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j20 - Percentage ischemic stroke patients with post-treatment reperfusion grade TICI 2B or higher (Stroke Unit)
    public function patient_feedback_CQI4j20()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j20',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j21 - Percentage ischemic stroke patients with large vessel occlusion receiving MER within 120 min and achieving TICI 2B+ (Stroke Unit)
    public function patient_feedback_CQI4j21()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j21',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }
    
    // CQI4j22 - Percentage ischemic stroke patients with large vessel occlusion achieving TICI 2B+ 60 min from skin puncture (Stroke Unit)
    public function patient_feedback_CQI4j22()
    {
        if ($this->session->userdata('isLogIn')==false) redirect('login');
        if (ismodule_active('QUALITY')===true){
            $data['title']='QUALITY KPI ANALYSIS';
            $data['content']=$this->load->view('qualitymodules/patient_feedback_CQI4j22',$data,true);
            $this->load->view('layout/main_wrapper',$data);
        } else { redirect('dashboard/noaccess'); }
    }












    




















    //Edit page for all KPI

    public function edit_feedback_CQI3a1()
    {

        if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
            $this->session->set_userdata('referred_from', current_url());
        } else {
            $this->session->set_userdata('referred_from', NULL);
        }


        $LOAD = pagetoload($this->module);
        if ($LOAD == 'inpatient_modules') {
            $data['title'] = 'EDIT KPI FORM';

            if (isfeature_active('QUALITY-DASHBOARD') === true) {
                $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a1', $data, true);
            } else {
                $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a1', $data, true);
            }
            //    $data['content'] = $this->load->view('qualitymodules/ticket_track', $data, true);

            $this->load->view('layout/main_wrapper', $data);
        }
    }


    public function edit_feedback_CQI3a1_byid($id)
{
    // Check if form is submitted
    if ($this->input->post()) {

        // 1 Handle time formatting
        $hr = intval($this->input->post('initial_assessment_hr')) ?: 0;
        $min = intval($this->input->post('initial_assessment_min')) ?: 0;
        $sec = intval($this->input->post('initial_assessment_sec')) ?: 0;
        $timeString = sprintf('%02d:%02d:%02d', $hr, $min, $sec);

        // 2 Format datetime
        $dataCollected = $this->input->post('dataCollected');
        $formattedDatetime = date('Y-m-d H:i:s', strtotime($dataCollected));
        $formattedDatet = date('Y-m-d', strtotime($dataCollected));

        // 3 Fetch existing dataset and files
        
        $existing = $this->quality_model->get_feedback_CQI3a1_byid($id);
        $dataset = json_decode($existing->dataset ?? '{}', true) ?: [];
        $existingFiles = $dataset['files_name'] ?? [];

        // 4 Remove files if requested
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        // 5 Upload new files
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'  => './api/file_uploads/',
                'allowed_types'=> 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'     => 50000,
                'encrypt_name' => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        // 6 Update other form fields into dataset
        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files','remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        // 7 Prepare final data for DB update
        $data = [
            'time_taken_initial_assessment' => $timeString,
            'number_of_admission'           => $this->input->post('total_admission'),
            'average_time_taken_initial_assessment' => $this->input->post('calculatedResult'),
            'bench_mark_time'               => $this->input->post('benchmark'),
            'data_analysis'                 => $this->input->post('dataAnalysis'),
            'corrective_action'             => $this->input->post('correctiveAction'),
            'preventive_action'             => $this->input->post('preventiveAction'),
            'datetime'                      => $formattedDatetime,
            'datet'                          => $formattedDatet,
            'dataset'                        => json_encode($dataset)
        ];

        // 8 Update database
        $this->quality_model->update_feedback_CQI3a1($id, $data);

        // 9 Redirect after update
        redirect('quality/patient_feedback_CQI3a1?id=' . $id);
    } else {
        // Load the view with the form and existing record
        $data['param'] = $this->quality_model->get_feedback_CQI3a1_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a1', $data);
    }
}

    public function edit_feedback_CQI3a4()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';

        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a4', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a4', $data, true);
        }

        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a2()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';

        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a2', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a2', $data, true);
        }

        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a2_byid($id)
{
    if ($this->input->post()) {

        // Get existing record
        $existing = $this->quality_model->get_feedback_CQI3a2_byid($id);

        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) {
            $dataset = [];
        }

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];

        // Handle file removal
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        // Handle file uploads
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        // Add/Update form fields to dataset
        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        // Compute KPI (average time or percentage)
        $numerator = intval($this->input->post('initial_assessment_hr')) ?: 0;
        $denominator = intval($this->input->post('total_admission')) ?: 0;
        $percentage = ($denominator > 0) ? ($numerator / $denominator) * 100 : 0;

        $data = [
            'dataset' => json_encode($dataset),
        ];

        log_message('debug', 'POST data: ' . json_encode($_POST));
        log_message('debug', 'Updating ID: ' . $id);
        log_message('debug', 'Data being saved: ' . json_encode($data));

        $this->quality_model->update_feedback_CQI3a2($id, $data);

        if ($this->db->affected_rows() > 0) {
            log_message('debug', 'CQI3a2 record updated successfully for ID: ' . $id);
        } else {
            log_message('error', 'CQI3a2 update failed or no changes detected for ID: ' . $id);
        }

        redirect('quality/patient_feedback_CQI3a2?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a2_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a2', $data);
    }
}
public function edit_feedback_CQI3a3()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';

        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a3', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a3', $data, true);
        }

        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a3_byid($id)
{
    if ($this->input->post()) {

        $existing = $this->quality_model->get_feedback_CQI3a3_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];

        // Remove old files
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        // Upload new files
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        // Update dataset fields
        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        // KPI computation (example)
        $numerator = intval($this->input->post('initial_assessment_hr')) ?: 0;
        $denominator = intval($this->input->post('total_emergency_patients')) ?: 0;
        $percentage = ($denominator > 0) ? ($numerator / $denominator) * 100 : 0;

        $data = [
            'dataset' => json_encode($dataset),
        ];

        log_message('debug', 'Updating CQI3a3 ID: ' . $id);
        $this->quality_model->update_feedback_CQI3a3($id, $data);

        redirect('quality/patient_feedback_CQI3a3?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a3_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a3', $data);
    }
}




public function edit_feedback_CQI3a4_byid($id)
{
    if ($this->input->post()) {

        
        $existing = $this->quality_model->get_feedback_CQI3a4_byid($id);

        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) {
            $dataset = [];
        }

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];


        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        $numerator = intval($this->input->post('initial_assessment_hr')) ?: 0;
        $denominator = intval($this->input->post('total_admission')) ?: 0;
        $percentage = ($denominator > 0) ? ($numerator / $denominator) * 100 : 0;

        $data = [
            'dataset' => json_encode($dataset),
        ];

        log_message('debug', 'POST data: ' . json_encode($_POST));
        log_message('debug', 'Updating ID: ' . $id);
        log_message('debug', 'Data being saved: ' . json_encode($data));

        $this->quality_model->update_feedback_CQI3a4($id, $data);

        if ($this->db->affected_rows() > 0) {
            log_message('debug', 'CQI3a4 record updated successfully for ID: ' . $id);
        } else {
            log_message('error', 'CQI3a4 update failed or no changes detected for ID: ' . $id);
        }

        redirect('quality/patient_feedback_CQI3a4?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a4_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a4', $data);
    }
}
public function edit_feedback_CQI3a5()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';

        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a5', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a5', $data, true);
        }

        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a5_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a5_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];

        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        // KPI Calculation
        $numerator = intval($this->input->post('nutritional_assessment_done')) ?: 0;
        $denominator = intval($this->input->post('total_inpatients')) ?: 0;
        $percentage = ($denominator > 0) ? ($numerator / $denominator) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];

        $this->quality_model->update_feedback_CQI3a5($id, $data);
        redirect('quality/patient_feedback_CQI3a5?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a5_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a5', $data);
    }
}
public function edit_feedback_CQI3a6()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';

        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a6', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a6', $data, true);
        }

        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a6_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a6_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        // KPI Calculation
        $numerator = intval($this->input->post('nursing_care_documented')) ?: 0;
        $denominator = intval($this->input->post('total_inpatients')) ?: 0;
        $percentage = ($denominator > 0) ? ($numerator / $denominator) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a6($id, $data);
        redirect('quality/patient_feedback_CQI3a6?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a6_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a6', $data);
    }
}
public function edit_feedback_CQI3a7()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';

        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a7', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a7', $data, true);
        }

        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a7_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a7_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);
        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        // KPI Calculation - Average time (minutes)
        $total_time = floatval($this->input->post('total_time_assessment')) ?: 0;
        $total_patients = intval($this->input->post('total_patients_assessed')) ?: 0;
        $avg_time = ($total_patients > 0) ? ($total_time / $total_patients) : 0;
        $dataset['average_time'] = round($avg_time, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a7($id, $data);
        redirect('quality/patient_feedback_CQI3a7?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a7_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a7', $data);
    }
}
// =============================
//  CQI3a8  Avg. Time for Initial Assessment of Inpatients (Nursing-ICU)
// =============================
public function edit_feedback_CQI3a8()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';

        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a8', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a8', $data, true);
        }

        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a8_byid($id)
{
    if ($this->input->post()) {

        $existing = $this->quality_model->get_feedback_CQI3a8_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];

        //  Remove files
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        //  Update dataset
        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (Average Time)
        $sum_time = floatval($this->input->post('sum_time')) ?: 0;
        $total_patients = intval($this->input->post('total_patients')) ?: 0;
        $average_time = ($total_patients > 0) ? ($sum_time / $total_patients) : 0;
        $dataset['average_time'] = round($average_time, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a8($id, $data);
        redirect('quality/patient_feedback_CQI3a8?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a8_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a8', $data);
    }
}



// =============================
//  CQI3a9  Avg. Time for Initial Assessment of Inpatients (Nursing-Ward)
// =============================
public function edit_feedback_CQI3a9()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';

        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a9', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a9', $data, true);
        }

        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a9_byid($id)
{
    if ($this->input->post()) {

        $existing = $this->quality_model->get_feedback_CQI3a9_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];

        //  Remove files
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        //  Update dataset
        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (Average Time)
        $sum_time = floatval($this->input->post('sum_time')) ?: 0;
        $total_patients = intval($this->input->post('total_patients')) ?: 0;
        $average_time = ($total_patients > 0) ? ($sum_time / $total_patients) : 0;
        $dataset['average_time'] = round($average_time, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a9($id, $data);
        redirect('quality/patient_feedback_CQI3a9?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a9_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a9', $data);
    }
}



// =============================
//  CQI3a10  % Blood Culture Contamination Rate (Lab Services)
// =============================
public function edit_feedback_CQI3a10()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';

        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a10', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a10', $data, true);
        }

        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a10_byid($id)
{
    if ($this->input->post()) {

        $existing = $this->quality_model->get_feedback_CQI3a10_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];

        //  Remove files
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        //  Update dataset
        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (Contamination %)
        $contaminated = intval($this->input->post('contaminated_samples')) ?: 0;
        $total_samples = intval($this->input->post('total_samples')) ?: 0;
        $percentage = ($total_samples > 0) ? ($contaminated / $total_samples) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a10($id, $data);
        redirect('quality/patient_feedback_CQI3a10?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a10_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a10', $data);
    }
}
//  CQI3a11 - Percentage of Beta-blocker prescriptions with a diagnosis of CHF with reduced EF
public function edit_feedback_CQI3a11()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a11', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a11', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a11_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a11_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        $patients = intval($this->input->post('patients_with_beta_blocker')) ?: 0;
        $total_chf = intval($this->input->post('total_chf_patients')) ?: 0;
        $percentage = ($total_chf > 0) ? ($patients / $total_chf) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a11($id, $data);
        redirect('quality/patient_feedback_CQI3a11?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a11_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a11', $data);
    }
}
public function edit_feedback_CQI3a12()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a12', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a12', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a12_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a12_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);
        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        $achieved = intval($this->input->post('target_achieved_patients')) ?: 0;
        $total = intval($this->input->post('total_hypoglycemia_patients')) ?: 0;
        $percentage = ($total > 0) ? ($achieved / $total) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a12($id, $data);
        redirect('quality/patient_feedback_CQI3a12?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a12_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a12', $data);
    }
}
public function edit_feedback_CQI3a13()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a13', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a13', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a13_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a13_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);
        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        $tears = intval($this->input->post('spontaneous_tears')) ?: 0;
        $deliveries = intval($this->input->post('total_vaginal_deliveries')) ?: 0;
        $percentage = ($deliveries > 0) ? ($tears / $deliveries) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a13($id, $data);
        redirect('quality/patient_feedback_CQI3a13?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a13_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a13', $data);
    }
}
public function edit_feedback_CQI3a14()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a14', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a14', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a14_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a14_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);
        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        // KPI Formula: (Sepsis patients received HOUR-1 care / Total sepsis patients) * 100
        $hour1 = intval($this->input->post('hour1_care_patients')) ?: 0;
        $total = intval($this->input->post('total_sepsis_patients')) ?: 0;
        $percentage = ($total > 0) ? ($hour1 / $total) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a14($id, $data);
        redirect('quality/patient_feedback_CQI3a14?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a14_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a14', $data);
    }
}
public function edit_feedback_CQI3a15()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a15', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a15', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a15_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a15_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);
        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        // KPI Formula: (COPD patients with action plan / Total COPD discharged patients) * 100
        $action_plan = intval($this->input->post('copd_with_action_plan')) ?: 0;
        $total = intval($this->input->post('total_copd_discharges')) ?: 0;
        $percentage = ($total > 0) ? ($action_plan / $total) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a15($id, $data);
        redirect('quality/patient_feedback_CQI3a15?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a15_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a15', $data);
    }
}
public function edit_feedback_CQI3a16()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a16', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a16', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a16_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a16_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);
        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        // KPI Formula: (Inappropriately treated / Total bronchiolitis patients) * 100
        $inappropriate = intval($this->input->post('inappropriate_treatments')) ?: 0;
        $total = intval($this->input->post('total_bronchiolitis_patients')) ?: 0;
        $percentage = ($total > 0) ? ($inappropriate / $total) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a16($id, $data);
        redirect('quality/patient_feedback_CQI3a16?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a16_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a16', $data);
    }
}
public function edit_feedback_CQI3a17()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a17', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a17', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a17_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a17_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI: Percentage of oncology patients initiated after MDM
        $initiated = intval($this->input->post('patients_initiated_after_mdm')) ?: 0;
        $total = intval($this->input->post('total_oncology_patients')) ?: 0;
        $percentage = ($total > 0) ? ($initiated / $total) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a17($id, $data);
        redirect('quality/patient_feedback_CQI3a17?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a17_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a17', $data);
    }
}
public function edit_feedback_CQI3a18()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a18', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a18', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a18_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a18_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI: Percentage of Extravasation
        $extravasation = intval($this->input->post('extravasation_cases')) ?: 0;
        $total_cases = intval($this->input->post('total_contrast_cases')) ?: 0;
        $percentage = ($total_cases > 0) ? ($extravasation / $total_cases) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a18($id, $data);
        redirect('quality/patient_feedback_CQI3a18?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a18_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a18', $data);
    }
}
public function edit_feedback_CQI3a19()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a19', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a19', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a19_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a19_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI: Average Time Taken
        $total_time = floatval($this->input->post('total_time_minutes')) ?: 0;
        $total_patients = intval($this->input->post('total_patients')) ?: 0;
        $average = ($total_patients > 0) ? ($total_time / $total_patients) : 0;
        $dataset['average_time'] = round($average, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a19($id, $data);
        redirect('quality/patient_feedback_CQI3a19?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a19_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a19', $data);
    }
}
public function edit_feedback_CQI3a20()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a20', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a20', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a20_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a20_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI: Percentage of patients at target Hb
        $achieved = intval($this->input->post('patients_achieved_target')) ?: 0;
        $total = intval($this->input->post('total_dialysis_patients')) ?: 0;
        $percentage = ($total > 0) ? ($achieved / $total) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a20($id, $data);
        redirect('quality/patient_feedback_CQI3a20?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a20_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a20', $data);
    }
}
// ==================== CQI3a21 ====================
public function edit_feedback_CQI3a21()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a21', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a21', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a21_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a21_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        //  File Removal
        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation
        $responded = intval($this->input->post('responded_on_time')) ?: 0;
        $reported = intval($this->input->post('reported_cases')) ?: 0;
        $percentage = ($reported > 0) ? ($responded / $reported) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a21($id, $data);
        redirect('quality/patient_feedback_CQI3a21?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a21_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a21', $data);
    }
}



// ==================== CQI3a22 ====================
public function edit_feedback_CQI3a22()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3a22', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a22', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3a22_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3a22_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        //  File Removal
        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation
        $compliant = intval($this->input->post('compliant_cases')) ?: 0;
        $total = intval($this->input->post('total_cases')) ?: 0;
        $percentage = ($total > 0) ? ($compliant / $total) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3a22($id, $data);
        redirect('quality/patient_feedback_CQI3a22?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3a22_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3a22', $data);
    }
}
public function edit_feedback_CQI3b1()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3b1', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b1', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3b1_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3b1_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        //  Handle existing + new files
        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        // File Uploads
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation: Number of reporting errors per 1000 investigations
        $errors = intval($this->input->post('reporting_errors')) ?: 0;
        $total = intval($this->input->post('total_investigations')) ?: 0;
        $rate = ($total > 0) ? ($errors / $total) * 1000 : 0;
        $dataset['rate'] = round($rate, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3b1($id, $data);
        redirect('quality/patient_feedback_CQI3b1?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3b1_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b1', $data);
    }
}
public function edit_feedback_CQI3b2()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3b2', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b2', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3b2_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3b2_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        // Upload New Files
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation: Rate of redo in 1000 tests
        $redo = intval($this->input->post('redo_tests')) ?: 0;
        $total = intval($this->input->post('total_tests')) ?: 0;
        $rate = ($total > 0) ? ($redo / $total) * 1000 : 0;
        $dataset['rate'] = round($rate, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3b2($id, $data);
        redirect('quality/patient_feedback_CQI3b2?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3b2_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b2', $data);
    }
}
public function edit_feedback_CQI3b3()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3b3', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b3', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3b3_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3b3_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        // Upload New Files
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation: Percentage of reports correlating to clinical diagnosis
        $correlated = intval($this->input->post('correlated_reports')) ?: 0;
        $total = intval($this->input->post('total_reports')) ?: 0;
        $percentage = ($total > 0) ? ($correlated / $total) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3b3($id, $data);
        redirect('quality/patient_feedback_CQI3b3?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3b3_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b3', $data);
    }
}
public function edit_feedback_CQI3b4()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3b4', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b4', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3b4_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3b4_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        // File Upload Handling
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation: Percentage of employees adhering to safety precautions
        $adhered = intval($this->input->post('employees_adhered')) ?: 0;
        $total = intval($this->input->post('total_employees')) ?: 0;
        $percentage = ($total > 0) ? ($adhered / $total) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3b4($id, $data);
        redirect('quality/patient_feedback_CQI3b4?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3b4_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b4', $data);
    }
}
public function edit_feedback_CQI3b5()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3b5', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b5', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3b5_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3b5_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        // File logic (same pattern)
        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        // File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation: Rate of redo per 1000 tests
        $redo = intval($this->input->post('redo_tests')) ?: 0;
        $total = intval($this->input->post('total_tests')) ?: 0;
        $rate = ($total > 0) ? ($redo / $total) * 1000 : 0;
        $dataset['rate'] = round($rate, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3b5($id, $data);
        redirect('quality/patient_feedback_CQI3b5?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3b5_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b5', $data);
    }
}
//  CQI3b6 - Number of reporting errors per 1000 investigations (Radiology)
public function edit_feedback_CQI3b6()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3b6', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b6', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3b6_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3b6_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        //  Handle file uploads/removals
        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI: Number of reporting errors per 1000 investigations
        $errors = intval($this->input->post('reporting_errors')) ?: 0;
        $total = intval($this->input->post('total_investigations')) ?: 0;
        $rate = ($total > 0) ? ($errors / $total) * 1000 : 0;
        $dataset['rate_per_1000'] = round($rate, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3b6($id, $data);
        redirect('quality/patient_feedback_CQI3b6?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3b6_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b6', $data);
    }
}
//  CQI3b7 - Percentage of reports correlating to clinical diagnosis (Radiology)
public function edit_feedback_CQI3b7()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3b7', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b7', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3b7_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3b7_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI: Percentage of reports correlating to clinical diagnosis
        $correlated = intval($this->input->post('correlated_reports')) ?: 0;
        $total = intval($this->input->post('total_reports')) ?: 0;
        $percentage = ($total > 0) ? ($correlated / $total) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3b7($id, $data);
        redirect('quality/patient_feedback_CQI3b7?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3b7_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b7', $data);
    }
}
//  CQI3b8 - Percentage of employees in diagnostics adhering to safety precautions (Radiology)
public function edit_feedback_CQI3b8()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3b8', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b8', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3b8_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3b8_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI: Percentage of employees adhering to safety precautions
        $compliant = intval($this->input->post('employees_following_safety')) ?: 0;
        $total = intval($this->input->post('total_employees')) ?: 0;
        $percentage = ($total > 0) ? ($compliant / $total) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3b8($id, $data);
        redirect('quality/patient_feedback_CQI3b8?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3b8_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b8', $data);
    }
}
//  CQI3b9 - Percentage of employees in diagnostics adhering to safety precautions (Radiology - OT)
public function edit_feedback_CQI3b9()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3b9', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b9', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3b9_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3b9_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation
        $compliant = intval($this->input->post('employees_following_safety')) ?: 0;
        $total = intval($this->input->post('total_employees')) ?: 0;
        $percentage = ($total > 0) ? ($compliant / $total) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3b9($id, $data);
        redirect('quality/patient_feedback_CQI3b9?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3b9_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b9', $data);
    }
}
//  CQI3b10 - Percentage of employees in diagnostics adhering to safety precautions (Radiology - Nursing)
public function edit_feedback_CQI3b10()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3b10', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b10', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3b10_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3b10_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation
        $compliant = intval($this->input->post('employees_following_safety')) ?: 0;
        $total = intval($this->input->post('total_employees')) ?: 0;
        $percentage = ($total > 0) ? ($compliant / $total) * 100 : 0;
        $dataset['percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3b10($id, $data);
        redirect('quality/patient_feedback_CQI3b10?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3b10_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b10', $data);
    }
}
// CQI3b11 - Number of reporting errors before dispatch (Lab)
public function edit_feedback_CQI3b11()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3b11', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b11', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3b11_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3b11_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (Rate per 1000 samples)
        $errors = intval($this->input->post('reporting_errors')) ?: 0;
        $total = intval($this->input->post('total_tests')) ?: 0;
        $rate = ($total > 0) ? ($errors / $total) * 1000 : 0;
        $dataset['rate_per_1000'] = round($rate, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3b11($id, $data);
        redirect('quality/patient_feedback_CQI3b11?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3b11_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b11', $data);
    }
}
// CQI3b12 - Waiting time for Laboratory services
public function edit_feedback_CQI3b12()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3b12', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b12', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3b12_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3b12_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (Average waiting time)
        $total_wait_time = floatval($this->input->post('total_wait_time')) ?: 0;
        $patients = intval($this->input->post('total_patients')) ?: 0;
        $average = ($patients > 0) ? ($total_wait_time / $patients) : 0;
        $dataset['average_waiting_time'] = round($average, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3b12($id, $data);
        redirect('quality/patient_feedback_CQI3b12?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3b12_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b12', $data);
    }
}
// CQI3b13 - Patient safety events or errors related to pathology samples (JCI8-QPS 3.04) - (Lab Services)
public function edit_feedback_CQI3b13()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3b13', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b13', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3b13_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3b13_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (Error rate per 1000 samples)
        $errors = intval($this->input->post('safety_events')) ?: 0;
        $total_samples = intval($this->input->post('total_samples')) ?: 0;
        $rate = ($total_samples > 0) ? ($errors / $total_samples) * 1000 : 0;
        $dataset['error_rate_per_1000'] = round($rate, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3b13($id, $data);
        redirect('quality/patient_feedback_CQI3b13?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3b13_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3b13', $data);
    }
}
//  CQI3c1 - Medication errors Rate (Clinical Pharmacy)
public function edit_feedback_CQI3c1()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3c1', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c1', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3c1_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3c1_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (Medication error rate per 1000 prescriptions)
        $errors = intval($this->input->post('medication_errors')) ?: 0;
        $total_prescriptions = intval($this->input->post('total_prescriptions')) ?: 0;
        $rate = ($total_prescriptions > 0) ? ($errors / $total_prescriptions) * 1000 : 0;
        $dataset['medication_error_rate_per_1000'] = round($rate, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3c1($id, $data);
        redirect('quality/patient_feedback_CQI3c1?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3c1_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c1', $data);
    }
}
//  CQI3c2 - Incidence of medication errors - Prescription errors (IP)
public function edit_feedback_CQI3c2()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3c2', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c2', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3c2_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3c2_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (Prescription Error Rate per 100 prescriptions)
        $errors = intval($this->input->post('prescription_errors')) ?: 0;
        $total = intval($this->input->post('total_prescriptions_checked')) ?: 0;
        $rate = ($total > 0) ? ($errors / $total) * 100 : 0;
        $dataset['prescription_error_rate'] = round($rate, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3c2($id, $data);
        redirect('quality/patient_feedback_CQI3c2?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3c2_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c2', $data);
    }
}
//  CQI3c3 - Incidence of medication errors - Dispensing errors (IP)
public function edit_feedback_CQI3c3()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3c3', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c3', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3c3_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3c3_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (Dispensing Error Rate per 1000 prescriptions)
        $dispensing_errors = intval($this->input->post('dispensing_errors')) ?: 0;
        $total_dispensed = intval($this->input->post('total_doses_dispensed')) ?: 0;
        $rate = ($total_dispensed > 0) ? ($dispensing_errors / $total_dispensed) * 1000 : 0;
        $dataset['dispensing_error_rate_per_1000'] = round($rate, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3c3($id, $data);
        redirect('quality/patient_feedback_CQI3c3?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3c3_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c3', $data);
    }
}
//  CQI3c4 - Percentage of admissions with ADR (Adverse Drug Reaction)
public function edit_feedback_CQI3c4()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3c4', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c4', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3c4_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3c4_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (ADR %)
        $adr_cases = intval($this->input->post('adr_cases')) ?: 0;
        $total_admissions = intval($this->input->post('total_admissions')) ?: 0;
        $percentage = ($total_admissions > 0) ? ($adr_cases / $total_admissions) * 100 : 0;
        $dataset['adr_percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3c4($id, $data);
        redirect('quality/patient_feedback_CQI3c4?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3c4_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c4', $data);
    }
}
//  CQI3c5 - Percentage of medication charts with error prone abbreviations
public function edit_feedback_CQI3c5()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3c5', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c5', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3c5_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3c5_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);

        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        //  File Upload
        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (Error-Prone Abbreviation %)
        $charts_with_errors = intval($this->input->post('charts_with_error_abbreviations')) ?: 0;
        $total_charts = intval($this->input->post('total_charts_reviewed')) ?: 0;
        $percentage = ($total_charts > 0) ? ($charts_with_errors / $total_charts) * 100 : 0;
        $dataset['error_prone_abbreviation_percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3c5($id, $data);
        redirect('quality/patient_feedback_CQI3c5?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3c5_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c5', $data);
    }
}
// CQI3c6 - Percentage of patients receiving high-risk medication developing adverse drug event (Clinical Pharmacy)
public function edit_feedback_CQI3c6()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3c6', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c6', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3c6_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3c6_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        //  Handle File Upload and Removal (common logic)
        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (Adverse event %)
        $adverse_cases = intval($this->input->post('adverse_cases')) ?: 0;
        $total_high_risk_patients = intval($this->input->post('total_high_risk_patients')) ?: 0;
        $percentage = ($total_high_risk_patients > 0) ? ($adverse_cases / $total_high_risk_patients) * 100 : 0;
        $dataset['adverse_event_percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3c6($id, $data);
        redirect('quality/patient_feedback_CQI3c6?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3c6_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c6', $data);
    }
}
// CQI3c7 - Incidence of Medication Administering Errors (As per NABH 4th edition) - (Clinical Pharmacy)
public function edit_feedback_CQI3c7()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3c7', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c7', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3c7_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3c7_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        //  File Handling
        $existingFiles = $dataset['files_name'] ?? [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }
        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value)
            if (!in_array($key, ['uploaded_files', 'remove_files_json']))
                $dataset[$key] = $value;

        //  KPI Formula (Incidence rate per 1000 administrations)
        $errors = intval($this->input->post('admin_errors')) ?: 0;
        $total_admins = intval($this->input->post('total_admins')) ?: 0;
        $rate = ($total_admins > 0) ? ($errors / $total_admins) * 1000 : 0;
        $dataset['admin_error_rate_per_1000'] = round($rate, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3c7($id, $data);
        redirect('quality/patient_feedback_CQI3c7?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3c7_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c7', $data);
    }
}
// CQI3c8 - Percentage of in-patients developing adverse drug reaction (PSQ3a) (Clinical Pharmacy)
public function edit_feedback_CQI3c8()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3c8', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c8', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3c8_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3c8_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        // File upload and cleanup
        $existingFiles = $dataset['files_name'] ?? [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);
        foreach ($_POST as $key => $value)
            if (!in_array($key, ['uploaded_files', 'remove_files_json']))
                $dataset[$key] = $value;

        //  KPI Calculation
        $adr_cases = intval($this->input->post('adr_cases')) ?: 0;
        $total_inpatients = intval($this->input->post('total_inpatients')) ?: 0;
        $percentage = ($total_inpatients > 0) ? ($adr_cases / $total_inpatients) * 100 : 0;
        $dataset['adr_percentage'] = round($percentage, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3c8($id, $data);
        redirect('quality/patient_feedback_CQI3c8?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3c8_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c8', $data);
    }
}
// CQI3c9 - Incidence of Medication Administering Errors (Clinical Pharmacy)
public function edit_feedback_CQI3c9()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3c9', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c9', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3c9_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3c9_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        //  Handle File Upload and Removal
        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (Incidence Rate)
        $admin_error_cases = intval($this->input->post('admin_error_cases')) ?: 0;
        $total_administered = intval($this->input->post('total_administered')) ?: 0;
        $incidence_rate = ($total_administered > 0) ? ($admin_error_cases / $total_administered) * 100 : 0;
        $dataset['admin_error_rate'] = round($incidence_rate, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3c9($id, $data);
        redirect('quality/patient_feedback_CQI3c9?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3c9_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c9', $data);
    }
}
// CQI3c10 - Incidence of medication errors - Dispensing errors (IP) (Clinical Pharmacy)
public function edit_feedback_CQI3c10()
{
    if (!isset($this->session->userdata['isLogIn']) || ($this->session->userdata('isLogIn') === false)) {
        $this->session->set_userdata('referred_from', current_url());
    } else {
        $this->session->set_userdata('referred_from', NULL);
    }

    $LOAD = pagetoload($this->module);
    if ($LOAD == 'inpatient_modules') {
        $data['title'] = 'EDIT KPI FORM';
        if (isfeature_active('QUALITY-DASHBOARD') === true) {
            $data['content'] = $this->load->view('qualitymodules/edit_feedback_CQI3c10', $data, true);
        } else {
            $data['content'] = $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c10', $data, true);
        }
        $this->load->view('layout/main_wrapper', $data);
    }
}

public function edit_feedback_CQI3c10_byid($id)
{
    if ($this->input->post()) {
        $existing = $this->quality_model->get_feedback_CQI3c10_byid($id);
        $dataset = json_decode($existing->dataset, true);
        if (!is_array($dataset)) $dataset = [];

        //  File Upload and Removal Logic
        $existingFiles = !empty($dataset['files_name']) ? $dataset['files_name'] : [];
        $removeIndexes = json_decode($this->input->post('remove_files_json') ?? '[]', true);
        if (!empty($removeIndexes)) {
            foreach ($removeIndexes as $index) {
                if (isset($existingFiles[$index])) {
                    $oldFilePath = str_replace(base_url(), '', $existingFiles[$index]['url']);
                    $absolutePath = FCPATH . $oldFilePath;
                    if (file_exists($absolutePath)) @unlink($absolutePath);
                    unset($existingFiles[$index]);
                }
            }
            $existingFiles = array_values($existingFiles);
        }

        if (!empty($_FILES['uploaded_files']['name'][0])) {
            $filesCount = count($_FILES['uploaded_files']['name']);
            $config = [
                'upload_path'   => './api/file_uploads/',
                'allowed_types' => 'jpg|jpeg|png|pdf|csv|doc|docx|xls|xlsx',
                'max_size'      => 50000,
                'encrypt_name'  => FALSE
            ];
            $this->load->library('upload');
            for ($i = 0; $i < $filesCount; $i++) {
                $_FILES['file'] = [
                    'name'     => $_FILES['uploaded_files']['name'][$i],
                    'type'     => $_FILES['uploaded_files']['type'][$i],
                    'tmp_name' => $_FILES['uploaded_files']['tmp_name'][$i],
                    'error'    => $_FILES['uploaded_files']['error'][$i],
                    'size'     => $_FILES['uploaded_files']['size'][$i]
                ];
                $this->upload->initialize($config);
                if ($this->upload->do_upload('file')) {
                    $uploadData = $this->upload->data();
                    $existingFiles[] = [
                        'url'  => base_url('api/file_uploads/' . $uploadData['file_name']),
                        'name' => $uploadData['file_name']
                    ];
                }
            }
        }

        $dataset['files_name'] = array_values($existingFiles);

        foreach ($_POST as $key => $value) {
            if (!in_array($key, ['uploaded_files', 'remove_files_json'])) {
                $dataset[$key] = $value;
            }
        }

        //  KPI Calculation (Dispensing Error Rate)
        $dispense_errors = intval($this->input->post('dispense_errors')) ?: 0;
        $total_dispenses = intval($this->input->post('total_dispenses')) ?: 0;
        $error_rate = ($total_dispenses > 0) ? ($dispense_errors / $total_dispenses) * 100 : 0;
        $dataset['dispensing_error_rate'] = round($error_rate, 2);

        $data = ['dataset' => json_encode($dataset)];
        $this->quality_model->update_feedback_CQI3c10($id, $data);
        redirect('quality/patient_feedback_CQI3c10?id=' . $id);
    } else {
        $data['param'] = $this->quality_model->get_feedback_CQI3c10_byid($id);
        $this->load->view('qualitymodules/dephead/edit_feedback_CQI3c10', $data);
    }
}















    //START REPORTS




    public function overall_CQI3a1_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_CQI3a1';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Sum of time taken for initial assessment of in-patients in MRD-ICU (in Hrs)';
            $header[3] = 'Total number of in-patients (in No.s)';
            $header[4] = 'Avg. time taken for initial assessment of in-patients in MRD-ICU (in Hrs)';

            $j = 5;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Average Time for initial assessment of in-patients (Doctors) in MRD(ICU) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_CQI3a2_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_CQI3a2';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Sum of time taken for initial assessment of in-patients in MRD-WARD (in Hrs)';
            $header[3] = 'Total number of in-patients (in No.s)';
            $header[4] = 'Avg. time taken for initial assessment of in-patients in MRD-WARD (in Hrs)';

            $j = 5;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Average Time for initial assessment of in-patients (Doctors)- (MRI WARD) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_CQI3a3_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_CQI3a3';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Sum of time taken for initial assessment emergency patients (in Hrs)';
            $header[3] = 'Total number of emergency patients (in No.s)';
            $header[4] = 'Avg.Time for initial assessment of in-patients (in Hrs)';

            $j = 5;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Average Time for initial assessment of in-patients (Doctors)-(Emergency Department) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_CQI3a4_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_CQI3a4';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Number of case sheets where care plan is documented (in No.s)';
            $header[3] = 'Total number of in-patients for the month (in No.s)';
            $header[4] = 'Percentage of Care-plan is documented for inpatients(MRD) (in %)';

            $j = 5;

            // $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Percentage of Care-plan is documented for inpatients (MRD) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_CQI3a5_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_CQI3a5';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Number of case sheets where care plan is documented (in No.s)';
            $header[3] = 'Total number of in-patients for the month (in No.s)';
            $header[4] = 'Percentage of Care-plan is documented for inpatients(MRD) (in %)';

            $j = 5;

            // $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Percentage of Nutritional assessment is documented for inpatients (Clinical Nutrition and Dietetics) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_CQI3a6_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_CQI3a6';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Number of case sheets where nursing plan is documented (in No.s)';
            $header[3] = 'Total number of in-patients for the month (in No.s)';
            $header[4] = 'Percentage of Nursing care is documented for inpatients(MRD - Nursing) (in %)';

            $j = 5;

            // $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Percentage of Nursing care is documented for inpatients (MRD - Nursing) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_CQI3a7_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_CQI3a7';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Sum of time taken for initial assessment Emergency patients';
            $header[3] = 'Total number of emergency patients (in No.s)';
            $header[4] = 'Avg.Time for initial assessment of Emergency patients(Nurses)-(Emergency Department)';

            $j = 5;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Average Time for initial assessment of Emergency patients(Nurses)-(Emergency Department) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_CQI3a8_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_CQI3a8';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Sum of time taken for assessment in patients';
            $header[3] = 'Total number of in-patients (in No.s)';
            $header[4] = 'Avg. Time for initial assessment of in-patients (Nurses)-(Nursing-ICU) (in Hrs)';

            $j = 5;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Average Time for initial assessment of in-patients (Nurses)-(Nursing-ICU) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_CQI3a9_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_CQI3a9';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Sum of time taken for assessment in patients (in Hrs)';
            $header[3] = 'Total number of in-patients  (in No.s)';
            $header[4] = 'Avg. Time for initial assessment of in-patients (Nurses)-(Nursing-Ward) (in Hrs)';

            $j = 5;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Average Time for initial assessment of in-patients (Nurses)-(Nursing-Ward) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_CQI3a10_report()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $table_feedback = 'bf_feedback_CQI3a10';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);

            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }

            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Total number of Contaminated blood culture (in No.s)';
            $header[3] = 'Total number of blood culture test Performed (in No.s)';
            $header[4] = 'Percentage of Blood culture contamination rate(Lab Service) (in %)';
            $j = 5;

            // $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                // $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }

            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Percentage of Blood culture contamination rate (Lab Service) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_CQI3a11_report()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $table_feedback = 'bf_feedback_CQI3a11';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);

            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }

            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Number of patients discharged with a diagnosis of CHF with reduced EF and prescribed a beta blocker at discharge (in No.s)';
            $header[3] = 'Number of patients discharged with a diagnosis of CHF (in No.s)';
            $header[4] = 'Percentage of Beta-blocker prescriptions with a diagnosis of CHF with reduced EF (Cardiology - Emergency Department) (in %)';
            $j = 5;

            // $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                // $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }

            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Percentage of Beta-blocker prescriptions with a diagnosis of CHF with reduced EF (Cardiology - Emergency Department) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_CQI3a12_report()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $table_feedback = 'bf_feedback_CQI3a12';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);

            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }

            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Number of patients with hypoglycemic events where the target glucose level was achieved post-treatment (in No.s)';
            $header[3] = 'Number of patients with Hypoglycemic events (in No.s)';
            $header[4] = 'Percentage of Hospitalized patients with hypoglycemia who achieved targeted blood glucose level(Endocrinology and Diabetes - Emergency Department) (in %)';
            $j = 5;

            // $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                // $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }

            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Percentage of Hospitalized patients with hypoglycemia who achieved targeted blood glucose level (Endocrinology and Diabetes - Emergency Department) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_CQI3a13_report()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $table_feedback = 'bf_feedback_CQI3a13';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);

            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }

            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Number of cases where a spontaneous perineal tear occurs (in No.s)';
            $header[3] = 'Total number of Vaginal deliveries (in No.s)';
            $header[4] = 'Percentage of Spontaneous perineal Tear Rate (in %)';
            $j = 5;

            // $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                // $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
                $i++;
            }

            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Percentage of Spontaneous perineal Tear Rate - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_CQI3a14_report()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $table_feedback = 'bf_feedback_CQI3a14';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);

            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }

            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Number of sepsis patients who receive care as per the hour-1 sepsis bundle (in No.s)';
            $header[3] = 'Total number of sepsis cases (in No.s)';
            $header[4] = 'Percentage of sepsis patients who receive care as per the HOUR-1 sepsis bundle(Critical Care Medicine - Medical records) (in %)';
            $j = 5;

            // $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                // $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
                $i++;
            }

            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Percentage of sepsis patients who receive care as per the HOUR-1 sepsis bundle (Critical Care Medicine - Medical records) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_CQI3a15_report()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $table_feedback = 'bf_feedback_CQI3a15';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);

            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }

            $header[0] = 'KPI Recorded by';
            $header[1] = 'KPI Recorded on';
            $header[2] = 'Number of COPD patients provided with a COPD action plan at the time of discharge (in No.s)';
            $header[3] = 'Number of COPD patients discharged (in No.s)';
            $header[4] = 'Percentage of COPD patients receiving COPD Action plan at the time of discharge (Pulmonary Medicine) (in %)';
            $j = 5;

            // $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
                $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                // $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
                $i++;
            }

            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- Percentage of COPD patients receiving COPD Action plan at the time of discharge (Pulmonary Medicine) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }
    public function overall_CQI3a16_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3a16';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of bronchiolitis patients treated inappropriately (in No.s)';
        $header[3] = 'Total bronchiolitis patients (in No.s)';
        $header[4] = 'Percentage of patients treated inappropriately (in %)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Percentage of bronchiolitis patients treated inappropriately (Pediatrics) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3a17_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3a17';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of oncology patients who had treatment initiated after tumour board (in No.s)';
        $header[3] = 'Total oncology patients discussed (in No.s)';
        $header[4] = 'Percentage with treatment initiated after tumour board (in %)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Percentage of oncology patients who had treatment initiated following multidisciplinary meeting (Oncology) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3a18_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3a18';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of Intravenous Contrast Media Extravasation events (in No.s)';
        $header[3] = 'Total contrast administrations (in No.s)';
        $header[4] = 'Percentage of extravasation events (in %)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Percentage of Intravenous Contrast Media Extravasation (Radiology) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3a19_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3a19';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Sum of time taken for triage (in Mins)';
        $header[3] = 'Total number of triage cases (in No.s)';
        $header[4] = 'Average time taken for triage (in Mins)';

        $j = 5;
        $header[$j++] = 'Benchmark time';
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['benchmark'] = isset($data['benchmark']) ? $data['benchmark'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Average Time taken for triage (Emergency Department) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}
public function overall_CQI3a20_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3a20';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of dialysis patients achieving target hemoglobin (in No.s)';
        $header[3] = 'Total dialysis patients (in No.s)';
        $header[4] = 'Percentage achieving target hemoglobin (in %)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Percentage of patients undergoing dialysis achieving target hemoglobin levels (Nephrology) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3a21_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3a21';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of critical results responded by physician within time (in No.s)';
        $header[3] = 'Total critical results reported (in No.s)';
        $header[4] = 'Percentage compliance of timely physician response (in %)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Percentage of Compliance rate of timeliness of physician responding to critical results (Medical Administration) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3a22_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3a22';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number complying with Holding area care (in No.s)';
        $header[3] = 'Total patients requiring Holding area care (in No.s)';
        $header[4] = 'Percentage compliance to Holding area care (in %)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Percentage of compliance to Holding area care (Nursing) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}
public function overall_CQI3b1_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3b1';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of reporting errors (in No.s)';
        $header[3] = 'Number of investigations (in No.s)';
        $header[4] = 'Reporting errors per 1000 investigations';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Number of reporting errors per 1000 investigations (Lab) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3b2_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3b2';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of redo tests (in No.s)';
        $header[3] = 'Total tests performed (in No.s)';
        $header[4] = 'Rate of redo per 1000 tests';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Rate of redo in 1000 tests (Lab) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3b3_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3b3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of reports correlating to clinical diagnosis (in No.s)';
        $header[3] = 'Total reports (in No.s)';
        $header[4] = 'Percentage reports correlating to clinical diagnosis (in %)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Percentage of reports correlating to clinical diagnosis (Lab) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3b4_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3b4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of employees adhering to safety precautions (in No.s)';
        $header[3] = 'Total employees observed (in No.s)';
        $header[4] = 'Percentage adherence to safety precautions (in %)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Percentage of employees in diagnostics adhering to safety precautions (Lab) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3b5_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3b5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of redo tests (in No.s)';
        $header[3] = 'Total radiology tests (in No.s)';
        $header[4] = 'Rate of redo per 1000 tests (Radiology)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Rate of redo in 1000 tests (Radiology) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3b6_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3b6';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of reporting errors (in No.s)';
        $header[3] = 'Number of radiology investigations (in No.s)';
        $header[4] = 'Reporting errors per 1000 investigations (Radiology)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Number of reporting errors per 1000 investigations (Radiology) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3b7_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3b7';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of reports correlating to clinical diagnosis (in No.s)';
        $header[3] = 'Total radiology reports (in No.s)';
        $header[4] = 'Percentage reports correlating to clinical diagnosis (Radiology)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Percentage of reports correlating to clinical diagnosis (Radiology) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}
public function overall_CQI3b8_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3b8';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of employees adhering to safety precautions (in No.s)';
        $header[3] = 'Total employees observed (in No.s)';
        $header[4] = 'Percentage adherence to safety precautions (in %)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Percentage of employees in diagnostics adhering to safety precautions (Radiology) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3b9_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3b9';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of employees adhering to safety precautions (OT) (in No.s)';
        $header[3] = 'Total employees observed (OT) (in No.s)';
        $header[4] = 'Percentage adherence to safety precautions (OT) (in %)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Percentage of employees in diagnostics adhering to safety precautions (Radiology-OT) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3b10_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3b10';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of employees adhering to safety precautions (Nursing) (in No.s)';
        $header[3] = 'Total employees observed (Nursing) (in No.s)';
        $header[4] = 'Percentage adherence to safety precautions (Nursing) (in %)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Percentage of employees in diagnostics adhering to safety precautions (Radiology-Nursing) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3b11_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3b11';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of reporting errors before dispatch (in No.s)';
        $header[3] = 'Total reports dispatched (in No.s)';
        $header[4] = 'Reporting errors before dispatch (in No.s)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Number of reporting errors before dispatch (Lab) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3b12_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3b12';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Total waiting time for laboratory services (in Mins)';
        $header[3] = 'Number of patients served (in No.s)';
        $header[4] = 'Average waiting time (in Mins)';

        $j = 5;
        $header[$j++] = 'Benchmark time';
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['benchmark'] = isset($data['benchmark']) ? $data['benchmark'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Waiting time for Laboratory services - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3b13_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3b13';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of patient safety events related to pathology samples (in No.s)';
        $header[3] = 'Total relevant specimens handled (in No.s)';
        $header[4] = 'Number/Percentage of patient safety events';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = isset($data['initial_assessment_total']) ? $data['initial_assessment_total'] : '';
            $dataexport[$i]['total_admission'] = isset($data['total_admission']) ? $data['total_admission'] : '';
            $dataexport[$i]['calculatedResult'] = isset($data['calculatedResult']) ? $data['calculatedResult'] : '';
            $dataexport[$i]['dataAnalysis'] = isset($data['dataAnalysis']) ? $data['dataAnalysis'] : '';
            $dataexport[$i]['correctiveAction'] = isset($data['correctiveAction']) ? $data['correctiveAction'] : '';
            $dataexport[$i]['preventiveAction'] = isset($data['preventiveAction']) ? $data['preventiveAction'] : '';

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Patient safety events related to pathology samples (Lab Services) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}
public function overall_CQI3c1_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c1';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of Medication Errors (in No.s)';
        $header[3] = 'Total number of Prescriptions/Dispensations (in No.s)';
        $header[4] = 'Medication Errors Rate (in %)';

        $j = 5;

        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
            $dataexport[$i]['total_admission'] = $data['total_admission'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- Medication errors Rate (Clinical Pharmacy) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}
public function overall_CQI3c2_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c2';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of cases';
        $header[3] = 'Total prescriptions';
        $header[4] = 'Percentage / Rate';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
            $dataexport[$i]['total_admission'] = $data['total_admission'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3c2 - Incidence of medication errors -Prescription errors(IP) (Clinical Pharmacy) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3c3_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Number of cases';
        $header[3] = 'Total dispensing';
        $header[4] = 'Percentage / Rate';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
            $dataexport[$i]['total_admission'] = $data['total_admission'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3c3 - Incidence of medication errors -Dispensing errors(IP) (Clinical Pharmacy) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}
public function overall_CQI3c4_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Total admissions';
        $header[3] = 'Number of ADR cases';
        $header[4] = 'Percentage of admissions with ADR (in %)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_admission'] = $data['total_admission'];
            $dataexport[$i]['adr_cases'] = $data['adr_cases'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3c4 - Percentage of admissions with ADR (Clinical Pharmacy) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3c5_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);
        $setarray = array();
        $questioarray = array();
        foreach ($sresult as $r) {
            $setarray[$r->type] = $r->title;
        }
        foreach ($sresult as $r) {
            $questioarray[$r->type][$r->shortkey] = $r->shortname;
        }

        $arraydata = array();
        foreach ($questioarray as $setr) {
            foreach ($setr as $k => $v) {
                $arraydata[$k] = $v;
            }
        }

        $header[0] = 'KPI Recorded by';
        $header[1] = 'KPI Recorded on';
        $header[2] = 'Total medication charts';
        $header[3] = 'Number of charts with error-prone abbreviations';
        $header[4] = 'Percentage of medication charts with error-prone abbreviations (in %)';

        $j = 5;
        $header[$j++] = 'Data analysis (RCA, Reason for Variation etc.)';
        $header[$j++] = 'Corrective action';
        $header[$j++] = 'Preventive action';

        $dataexport = [];
        $i = 0;
        foreach ($feedbacktaken as $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_charts'] = $data['total_charts'];
            $dataexport[$i]['error_charts'] = $data['error_charts'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

            $i++;
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3c5 - Percentage of medication charts with error-prone abbreviations (Clinical Pharmacy) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (isset($dataexport[0])) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3c6_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c6';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
        $sresult = $this->quality_model->setup_result($setup);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total patients receiving high-risk medications',
            'Number developing adverse drug events',
            'Percentage developing adverse drug events (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);

            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_patients'] = $data['total_patients'];
            $dataexport[$i]['adverse_events'] = $data['adverse_events'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3c6 - Percentage of patients receiving high-risk medication developing adverse drug events - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3c7_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c7';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $setup = 'setup';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total medication administrations',
            'Number of administering errors',
            'Percentage of administering errors (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_administration'] = $data['total_administration'];
            $dataexport[$i]['errors'] = $data['errors'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3c7 - Incidence of Medication Administering errors - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3c8_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c8';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total in-patients',
            'Number developing adverse drug reactions',
            'Percentage of patients developing ADR (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_inpatients'] = $data['total_inpatients'];
            $dataexport[$i]['adr_cases'] = $data['adr_cases'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3c8 - Percentage of in-patients developing adverse drug reaction - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3c9_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c9';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total medication administrations',
            'Number of administering errors',
            'Percentage of administering errors (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_administration'] = $data['total_administration'];
            $dataexport[$i]['errors'] = $data['errors'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3c9 - Incidence of Medication Administering errors - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3c10_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c10';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total medication dispensed',
            'Number of dispensing errors',
            'Percentage of dispensing errors (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_dispensed'] = $data['total_dispensed'];
            $dataexport[$i]['errors'] = $data['errors'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3c10 - Incidence of medication errors - Dispensing errors(IP) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3c11_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c11';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total prescriptions',
            'Number of prescription errors',
            'Percentage of prescription errors (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_prescriptions'] = $data['total_prescriptions'];
            $dataexport[$i]['errors'] = $data['errors'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3c11 - Incidence of medication errors - Prescription errors(IP) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3c12_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c12';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total high-risk infections',
            'Number of cases compliant with empirical antibiotics therapy',
            'Compliance rate (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_cases'] = $data['total_cases'];
            $dataexport[$i]['compliant_cases'] = $data['compliant_cases'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3c12 - Empirical Antibiotics therapy compliance rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3c13_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c13';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total restricted antibiotics prescribed',
            'Number of compliant cases',
            'Compliance rate (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_cases'] = $data['total_cases'];
            $dataexport[$i]['compliant_cases'] = $data['compliant_cases'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3c13 - Restricted antibiotics usage compliance rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}

public function overall_CQI3c14_report()
{
    if ($this->session->userdata('isLogIn') == false)
        redirect('login');
    if (ismodule_active('QUALITY') === true) {

        $table_feedback = 'bf_feedback_CQI3c14';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total new drug prescriptions',
            'Number with appropriate indication',
            'Appropriateness rate (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['initial_assessment_total'] = $data['initial_assessment_total'];
            $dataexport[$i]['total_admission'] = $data['total_admission'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3c14 - Monitor appropriateness of indication for new drugs - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) {
                fputcsv($fp, $values, ',');
            }
            fclose($fp);
        }
        ob_flush();
        exit;
    } else {
        redirect('dashboard/noaccess');
    }
}
public function overall_CQI3d1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3d1';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total anaesthesia cases',
            'Number of modifications of anaesthesia plan',
            'Percentage of modifications (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_cases'] = $data['total_cases'];
            $dataexport[$i]['modified_cases'] = $data['modified_cases'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3d1 - Percentage of modification of anaesthesia plan - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3d2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3d2';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total anaesthesia cases',
            'Number of unplanned ventilations',
            'Percentage of unplanned ventilations (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_cases'] = $data['total_cases'];
            $dataexport[$i]['unplanned_ventilation'] = $data['unplanned_ventilation'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3d2 - Percentage of unplanned ventilation following anaesthesia - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3d3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3d3';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total anaesthesia cases',
            'Number of adverse anaesthesia events',
            'Percentage of adverse events (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_cases'] = $data['total_cases'];
            $dataexport[$i]['adverse_events'] = $data['adverse_events'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3d3 - Percentage of adverse anaesthesia events - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3d4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3d4';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total anaesthesia cases',
            'Number of anaesthesia-related deaths',
            'Anaesthesia mortality rate (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_cases'] = $data['total_cases'];
            $dataexport[$i]['deaths'] = $data['deaths'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3d4 - Anaesthesia related mortality rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3d5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3d5';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total prescriptions',
            'Number of safe and rational prescriptions',
            'Percentage of safe prescriptions (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_prescriptions'] = $data['total_prescriptions'];
            $dataexport[$i]['safe_prescriptions'] = $data['safe_prescriptions'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3d5 - Percentage of safe and rational prescriptions - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
public function overall_CQI3e1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3e1';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total OT cases',
            'Number of unplanned returns to OT',
            'Percentage of unplanned returns (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_cases'] = $data['total_cases'];
            $dataexport[$i]['unplanned_return'] = $data['unplanned_return'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3e1 - Percentage of unplanned return to OT - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3e2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3e2';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total OT cases',
            'Number of rescheduled surgeries',
            'Percentage of rescheduled surgeries (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_cases'] = $data['total_cases'];
            $dataexport[$i]['rescheduled_cases'] = $data['rescheduled_cases'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3e2 - Percentage of rescheduling of surgeries - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
public function overall_CQI3e3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3e3';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total OT cases',
            'Number of cases with adherence to surgery error prevention procedure',
            'Percentage adherence (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_cases'] = $data['total_cases'];
            $dataexport[$i]['adherence_cases'] = $data['adherence_cases'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3e3 - Adherence to surgery error prevention procedure - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3e4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3e4';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total cases receiving surgery',
            'Number of cases receiving prophylactic antibiotics on time',
            'Percentage compliance (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_cases'] = $data['total_cases'];
            $dataexport[$i]['on_time_antibiotics'] = $data['on_time_antibiotics'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3e4 - Prophylactic antibiotics compliance - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3e5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3e5';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total planned surgeries',
            'Number of surgeries changed intraoperatively',
            'Percentage changed (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_surgeries'] = $data['total_surgeries'];
            $dataexport[$i]['changed_surgeries'] = $data['changed_surgeries'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3e5 - Surgeries changed intraoperatively - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3e6_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3e6';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total OT cases',
            'Number of re-explorations',
            'Re-exploration rate (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_cases'] = $data['total_cases'];
            $dataexport[$i]['reexplorations'] = $data['reexplorations'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3e6 - Re-exploration rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3e7_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3e7';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total deliveries',
            'Number of primary cesareans',
            'Primary Cesarean Rate (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_deliveries'] = $data['total_deliveries'];
            $dataexport[$i]['primary_cesareans'] = $data['primary_cesareans'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3e7 - Primary Cesarean Rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3e8_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3e8';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total implant cases',
            'Number of adverse events related to implant devices',
            'Adverse event rate (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_cases'] = $data['total_cases'];
            $dataexport[$i]['adverse_events'] = $data['adverse_events'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3e8 - Adverse events related to implant devices - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3e9_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3e9';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total surgical cases',
            'Number of major patient safety events',
            'Event rate (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_cases'] = $data['total_cases'];
            $dataexport[$i]['major_events'] = $data['major_events'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3e9 - Major patient safety events in surgical procedures - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
public function overall_CQI3f1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3f1';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total transfusions',
            'Number of transfusion reactions',
            'Percentage of transfusion reactions (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_transfusions'] = $data['total_transfusions'];
            $dataexport[$i]['reactions'] = $data['reactions'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3f1 - Percentage of transfusion reactions - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3f2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3f2';
        $table_patients = 'bf_patients';
        $desc = 'desc';

        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total blood units issued',
            'Number of wasted units among issued',
            'Percentage waste among issued (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_units_issued'] = $data['total_units_issued'];
            $dataexport[$i]['wasted_units'] = $data['wasted_units'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3f2 - Percentage of waste among issued blood units - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
public function overall_CQI3f3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3f3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total blood units stored',
            'Number of wasted units among stored',
            'Percentage waste among stored (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_units_stored'] = $data['total_units_stored'];
            $dataexport[$i]['wasted_units_stored'] = $data['wasted_units_stored'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3f3 - Percentage of waste among stored blood units - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3f4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3f4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total blood component units used',
            'Total patients receiving transfusions',
            'Percentage of blood component units used (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['total_units_used'] = $data['total_units_used'];
            $dataexport[$i]['total_patients'] = $data['total_patients'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3f4 - Percentage of blood component units used - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3f5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3f5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Sum of turnaround time for cross matched/reserved blood (in Hrs)',
            'Total number of requests',
            'Average turnaround time (in Hrs)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['turnaround_total'] = $data['turnaround_total'];
            $dataexport[$i]['total_requests'] = $data['total_requests'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3f5 - Turnaround time for cross matched/reserved blood - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
public function overall_CQI3f6_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3f6';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of adverse/near miss events in blood/transfusion services',
            'Total transfusions/units',
            'Percentage of adverse/near miss events (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['adverse_events'] = $data['adverse_events'];
            $dataexport[$i]['total_units'] = $data['total_units'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3f6 - Adverse/Near miss events in blood/transfusion - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3f7_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3f7';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total blood units required',
            'Total units available',
            'Blood availability rate (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['units_required'] = $data['units_required'];
            $dataexport[$i]['units_available'] = $data['units_available'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3f7 - Blood availability rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3f8_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3f8';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total units cross matched',
            'Total units transfused',
            'CT Ratio (cross match to transfusion)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['units_cross_matched'] = $data['units_cross_matched'];
            $dataexport[$i]['units_transfused'] = $data['units_transfused'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3f8 - CT Ratio (Cross match to transfusion) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3f9_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3f9';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Sum of turnaround time for Platelet Apheresis (in Hrs)',
            'Total number of procedures',
            'Average turnaround time (in Hrs)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['turnaround_total'] = $data['turnaround_total'];
            $dataexport[$i]['total_procedures'] = $data['total_procedures'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3f9 - Turnaround time for Platelet Apheresis - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3f10_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3f10';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Sum of turnaround time for blood donation (in Hrs)',
            'Total donors',
            'Average turnaround time (in Hrs)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['turnaround_total'] = $data['turnaround_total'];
            $dataexport[$i]['total_donors'] = $data['total_donors'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3f10 - Turnaround time for blood donation - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
public function overall_CQI3g1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3g1';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of catheter-associated UTIs',
            'Total catheter-days',
            'CAUTI Rate (per 1000 catheter days)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_infections'] = $data['num_infections'];
            $dataexport[$i]['total_catheter_days'] = $data['total_catheter_days'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3g1 - Catheter associated UTI rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3g2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3g2';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of ventilator-associated pneumonias',
            'Total ventilator days',
            'VAP Rate (per 1000 ventilator days)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_vap'] = $data['num_vap'];
            $dataexport[$i]['total_vent_days'] = $data['total_vent_days'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3g2 - VAP rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3g3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3g3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of CLABSI events',
            'Total central line days',
            'CLABSI Rate (per 1000 central line days)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_clabsi'] = $data['num_clabsi'];
            $dataexport[$i]['total_central_line_days'] = $data['total_central_line_days'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3g3 - CLABSI rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3g4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3g4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of surgical site infections',
            'Total number of surgeries',
            'SSI Rate (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_ssi'] = $data['num_ssi'];
            $dataexport[$i]['total_surgeries'] = $data['total_surgeries'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3g4 - Surgical Site Infection rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3g5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3g5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of late onset sepsis cases (>72 hrs)',
            'Total NICU admissions',
            'Late Onset Sepsis Rate (in %)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_late_sepsis'] = $data['num_late_sepsis'];
            $dataexport[$i]['total_nicu'] = $data['total_nicu'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3g5 - Late Onset Sepsis Rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3g6_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3g6';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of environmental cleaning audits conducted',
            'Total cleaning audits planned',
            'Compliance rate (%)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_audits'] = $data['num_audits'];
            $dataexport[$i]['total_audits'] = $data['total_audits'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3g6 - Environmental cleaning & disinfection compliance - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
public function overall_CQI3h1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3h1';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of deaths',
            'Total in-patients (MRD)',
            'Mortality rate (%)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_deaths'] = $data['num_deaths'];
            $dataexport[$i]['total_inpatients'] = $data['total_inpatients'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3h1 - Mortality rate (MRD) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3h2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3h2';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of ICU1 readmissions within 48 hours',
            'Total ICU1 discharges',
            'Return to ICU within 48 hours (%)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_readmissions'] = $data['num_readmissions'];
            $dataexport[$i]['total_discharges'] = $data['total_discharges'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3h2 - Return to ICU within 48 hours (ICU1) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3h3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3h3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of ICU2 readmissions within 48 hours',
            'Total ICU2 discharges',
            'Return to ICU 2 within 48 hours (%)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_readmissions'] = $data['num_readmissions'];
            $dataexport[$i]['total_discharges'] = $data['total_discharges'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3h3 - Return to ICU 2 within 48 hours (ICU2) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3h4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3h4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of CICU readmissions within 48 hours',
            'Total CICU discharges',
            'Return to ICU 3 within 48 hours (%)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_readmissions'] = $data['num_readmissions'];
            $dataexport[$i]['total_discharges'] = $data['total_discharges'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3h4 - Return to ICU 3 within 48 hours (CICU) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3h5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3h5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of ED returns after 72 hours',
            'Total ED discharges',
            'Return to emergency dept. after 72 hours (%)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_returns'] = $data['num_returns'];
            $dataexport[$i]['total_discharges'] = $data['total_discharges'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3h5 - Return to emergency department after 72 hours - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3h6_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3h6';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of reintubations ICU1',
            'Total extubations ICU1',
            'Reintubation rate (%)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_reintubations'] = $data['num_reintubations'];
            $dataexport[$i]['total_extubations'] = $data['total_extubations'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3h6 - Reintubation rate ICU1 - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3h7_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3h7';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of reintubations ICU2',
            'Total extubations ICU2',
            'Reintubation rate (%)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_reintubations'] = $data['num_reintubations'];
            $dataexport[$i]['total_extubations'] = $data['total_extubations'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3h7 - Reintubation rate ICU2 - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3h8_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3h8';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of reintubations CICU',
            'Total extubations CICU',
            'Reintubation rate (%)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_reintubations'] = $data['num_reintubations'];
            $dataexport[$i]['total_extubations'] = $data['total_extubations'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3h8 - Reintubation rate CICU - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3h9_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3h9';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of NICU readmissions',
            'Total NICU discharges',
            'Re Admission Rate (%)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['num_readmissions'] = $data['num_readmissions'];
            $dataexport[$i]['total_discharges'] = $data['total_discharges'];
            $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3h9 - Re Admission Rate NICU - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);
        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
public function overall_CQI3j1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j1';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Shift change handover communication (Nurses) ED/ICU/Ward',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handover'] = $data['handover'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j1 - Shift change handover communication (Nurses ED/ICU/Ward) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j2';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Shift change handover communication (Nurses) ED/ICU/Ward - ICU',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handover'] = $data['handover'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j2 - Shift change handover communication (Nurses ICU) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Shift change handover communication (Nurses) ED/ICU/Ward - Ward',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handover'] = $data['handover'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j3 - Shift change handover communication (Nurses Ward) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Incidence of patient identification error (Quality Office)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['error_incidence'] = $data['error_incidence'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j4 - Incidence of patient identification error - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of missed hand hygiene opportunities (Infection Control - Nursing)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['missed_hygiene'] = $data['missed_hygiene'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j5 - Missed hand hygiene opportunities - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j6_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j6';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Compliance rate to medication prescription in capitals (Clinical Pharmacy)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['compliance'] = $data['compliance'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j6 - Compliance to medication prescription - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j7_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j7';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Shift change handover communication (Doctors) (MRD - Emergency Department)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handover'] = $data['handover'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j7 - Shift change handover (Doctors ED) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j8_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j8';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Shift change handover communication (Doctors) - MRD ICU',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handover'] = $data['handover'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j8 - Shift change handover (Doctors ICU) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j9_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j9';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Compliance to patient identification - IPD (Nursing)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['compliance'] = $data['compliance'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j9 - Compliance to patient identification - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j10_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j10';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Compliance rate of timeliness of reporting Critical results in Radiology (within 30 min)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['timeliness'] = $data['timeliness'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j10 - Timeliness of reporting Critical results in Radiology - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
public function overall_CQI3j11_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j11';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 2.2 - Hand off communication interdepartmental shift (MRD - Emergency Department)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handoff'] = $data['handoff'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j11 - IPSG 2.2 Hand off MRD-ED - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j12_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j12';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 2.2 - Hand off communication interdepartmental shift (MRD - ICU)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handoff'] = $data['handoff'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j12 - IPSG 2.2 Hand off MRD-ICU - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j13_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j13';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 2.2 - Hand off communication interdepartmental Shift(Nurses) - Nursing - Emergency Department',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handoff'] = $data['handoff'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j13 - IPSG 2.2 Hand off ED Nurses - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j14_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j14';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 2.2 - Hand off communication interdepartmental Shift(Nurses) - Nursing - ICU',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handoff'] = $data['handoff'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j14 - IPSG 2.2 Hand off ICU Nurses - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j15_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j15';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 2.2 - Hand off communication interdepartmental Shift(Nurses) - Nursing - Ward',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handoff'] = $data['handoff'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j15 - IPSG 2.2 Hand off Ward Nurses - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j16_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j16';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 2.2 - Hand off communication among doctors (During shift change) - MRD - Emergency Department',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handoff'] = $data['handoff'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j16 - Hand off Doctors ED - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j17_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j17';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 2.2 - Hand off communication among doctors (During shift change) - MRD - ICU',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handoff'] = $data['handoff'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j17 - Hand off Doctors ICU - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j18_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j18';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 2.2 - Hand off communication among nurses (During shift change) - Nursing - Emergency Department',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handoff'] = $data['handoff'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j18 - Hand off Nurses ED - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j19_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j19';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 2.2 - Hand off communication among nurses (During shift change) - Nursing - ICU',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handoff'] = $data['handoff'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j19 - Hand off Nurses ICU - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j20_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j20';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 2.2 - Hand off communication among nurses (During shift change) - Nursing - Ward',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['handoff'] = $data['handoff'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j20 - Hand off Nurses Ward - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
public function overall_CQI3j21_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j21';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 4 - Ensure correct site, correct procedure, correct patient surgery - Quality Office - Endoscopy',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j21 - Correct site surgery Endoscopy - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j22_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j22';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 4 - Ensure correct site, correct procedure, correct patient surgery - Quality Office - ICU',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j22 - Correct site surgery ICU - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j23_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j23';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 4 - Ensure correct site, correct procedure, correct patient surgery - Quality Office - OT',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j23 - Correct site surgery OT - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j24_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j24';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'PSG 6 - Compliance to Fall prevention measures in IPD - Nursing - IPD',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j24 - Fall prevention IPD - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j25_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j25';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'PSG 6 - Compliance to Fall prevention measures in OPD - Nursing - OPD',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j25 - Fall prevention OPD - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
public function overall_CQI3j26_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j26';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 6 - Compliance to Fall prevention measures in Physiotherapy OP patients - Physical therapy and Rehabilitation Department - Physiotherapy',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j26 - Fall prevention Physiotherapy OP - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j27_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j27';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Compliance to hand hygiene practice (New) - Infection Control - Nursing',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j27 - Hand hygiene compliance - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j28_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j28';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Compliance to patient identification OPD - Nursing - OPD',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j28 - Patient ID compliance OPD - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j29_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j29';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Shift change handover communication (Doctors - ward) - Medical Administration',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j29 - Handover Doctors Ward - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j30_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j30';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Incidence of Adverse events in Physiotherapy (IPD) - Physical therapy and Rehabilitation Department - Physiotherapy',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j30 - Adverse events Physiotherapy IPD - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
public function overall_CQI3j31_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j31';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Incidence of Adverse events in Physiotherapy (OPD) - Physical therapy and Rehabilitation Department - Physiotherapy',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j31 - Adverse events Physiotherapy OPD - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j32_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j32';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'IPSG 4 - Ensure correct site, correct procedure, correct patient surgery - Quality Office - OT',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j32 - Correct site procedure OT - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j33_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j33';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Security incidents rate (JCI8-FMS 4.0) - Safety & Security',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j33 - Security incidents rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

public function overall_CQI3j34_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3j34';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Safety incidents rate (JCI8-FMS 3.0)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3j34 - Safety incidents rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI4a1 - Percentage of drugs and consumables procured by local purchases within the formulary (Pharmacy)
public function overall_CQI4a1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4a1';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Percentage of drugs and consumables procured by local purchases within the formulary (Pharmacy)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4a1 - Local purchases within formulary - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4a2 - Percentage of drugs and consumables procured by local purchase outside the formulary (Pharmacy)
public function overall_CQI4a2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4a2';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Percentage of drugs and consumables procured by local purchase outside the formulary (Pharmacy)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4a2 - Local purchases outside formulary - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI4a3 - Stock out rate of emergency medications (Pharmacy)
public function overall_CQI4a3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4a3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Stock out rate of emergency medications (Pharmacy)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4a3 - Stock out rate of emergency medications - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4a4 - Percentage of drugs and consumables rejected before preparation of Goods Receipt Note (SCM-Store)
public function overall_CQI4a4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4a4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Percentage of drugs and consumables rejected before preparation of Goods Receipt Note (SCM-Store)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4a4 - Rejected drugs/consumables before GRN - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4a5 - Percentage of variations from procurement process (SCM-Purchase)
public function overall_CQI4a5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4a5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Percentage of variations from procurement process (SCM-Purchase)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4a5 - Variations from procurement process - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI4b1 - Incidence of bed sores (hospital associated pressure ulcers) after admission (in 1000 patient days) - Nursing
public function overall_CQI4b1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4b1';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Incidence of bed sores (hospital associated pressure ulcers) after admission (in 1000 patient days) - Nursing',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4b1 - Incidence of bed sores - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4b2 - Incidence of falls (in 1000 IPD days) - Office-Quality
public function overall_CQI4b2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4b2';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Incidence of falls (in 1000 IPD days) - Office-Quality',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4b2 - Incidence of falls - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4b3 - Number of variations observed in mock drill (Safety & Security)
public function overall_CQI4b3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4b3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of variations observed in mock drill (Safety & Security)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4b3 - Mock drill variations - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4b4 - Percentage of staff provided with pre-exposure prophylaxis (Infection Control)
public function overall_CQI4b4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4b4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Percentage of staff provided with pre-exposure prophylaxis (Infection Control)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4b4 - Pre-exposure prophylaxis - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4b5 - Number of Fire Incidents (Safety & Security)
public function overall_CQI4b5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4b5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of Fire Incidents (Safety & Security)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4b5 - Fire Incidents - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4b6 - Incidence of device associated pressure ulcer after admission (Nursing)
public function overall_CQI4b6_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4b6';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Incidence of device associated pressure ulcer after admission (Nursing)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4b6 - Device associated pressure ulcer - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4b7 - Number of Extravasation (Nursing)
public function overall_CQI4b7_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4b7';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Number of Extravasation (Nursing)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4b7 - Extravasation - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4b8 - Monitoring of Clinical Errors (JCI8-PCC 2.3) - Quality Office
public function overall_CQI4b8_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4b8';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Monitoring of Clinical Errors (JCI8-PCC 2.3) - Quality Office',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4b8 - Clinical Errors Monitoring - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI4c1 - Bed occupancy rate (MRD)
public function overall_CQI4c1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c1';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Bed occupancy rate (MRD)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c1 - Bed occupancy rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4c2 - Average length of stay (MRD)
public function overall_CQI4c2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c2';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Average length of stay (MRD)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c2 - Average length of stay - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4c3 - OT Utilisation Rate (OT)
public function overall_CQI4c3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'OT Utilisation Rate (OT)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c3 - OT Utilisation Rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI4c4 - ICU equipment utilisation rate (Nursing - ICU1)
public function overall_CQI4c4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'ICU equipment utilisation rate (Nursing - ICU1)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c4 - ICU equipment utilisation rate (ICU1) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4c5 - ICU equipment utilisation rate (Nursing - ICU2)
public function overall_CQI4c5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'ICU equipment utilisation rate (Nursing - ICU2)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c5 - ICU equipment utilisation rate (ICU2) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4c6 - ICU equipment utilisation rate (Nursing - ICU3)
public function overall_CQI4c6_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c6';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'ICU equipment utilisation rate (Nursing - ICU3)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c6 - ICU equipment utilisation rate (ICU3) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4c7 - ICU Bed utilisation rate (Nursing - ICU)
public function overall_CQI4c7_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c7';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'ICU Bed utilisation rate (Nursing - ICU)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c7 - ICU Bed utilisation rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI4c8 - Critical equipment downtime (Biomedical Engineering)
public function overall_CQI4c8_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c8';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Critical equipment downtime (Biomedical Engineering)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c8 - Critical equipment downtime - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4c9 - Cath lab utilization rate (Cath Lab - Nursing)
public function overall_CQI4c9_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c9';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Cath lab utilization rate (Cath Lab - Nursing)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c9 - Cath lab utilization rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4c10 - Nurse patient ratio for ICU Ventilated (Nursing-ICU)
public function overall_CQI4c10_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c10';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Nurse patient ratio for ICU Ventilated (Nursing-ICU)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c10 - Nurse patient ratio for ICU Ventilated - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4c11 - Nurse patient ratio for ICU Non Ventilated (Nursing-ICU)
public function overall_CQI4c11_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c11';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Nurse patient ratio for ICU Non Ventilated (Nursing-ICU)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c11 - Nurse patient ratio for ICU Non Ventilated - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4c12 - Nurse patient ratio for HDU (Nursing-HDU)
public function overall_CQI4c12_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c12';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Nurse patient ratio for HDU (Nursing-HDU)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c12 - Nurse patient ratio for HDU - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4c13 - Nurse patient ratio for Ward (Nursing-Ward)
public function overall_CQI4c13_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c13';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Nurse patient ratio for Ward (Nursing-Ward)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c13 - Nurse patient ratio for Ward - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4c14 - Engineering Critical equipment downtime (Engineering & Maintenance)
public function overall_CQI4c14_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4c14';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Engineering Critical equipment downtime',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4c14 - Engineering Critical equipment downtime - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI4d1 - Out patient satisfaction index (Patient Care Services - OPD)
public function overall_CQI4d1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4d1';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Out patient satisfaction index (Patient Care Services - OPD)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4d1 - Out patient satisfaction index - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4d2 - Inpatient satisfaction index (Patient Care Services - IPD)
public function overall_CQI4d2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4d2';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Inpatient satisfaction index (Patient Care Services - IPD)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4d2 - Inpatient satisfaction index - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4d3 - Time taken for discharge - Cash Patients (Patient Care Services - Cash)
public function overall_CQI4d3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4d3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Time taken for discharge - Cash Patients (Patient Care Services - Cash)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4d3 - Time taken for discharge - Cash Patients - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4d4 - Time taken for discharge Cashless Patients (Patient Care Services - Cashless)
public function overall_CQI4d4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4d4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Time taken for discharge Cashless Patients (Patient Care Services - Cashless)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4d4 - Time taken for discharge Cashless Patients - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI4d5 - Waiting time for diagnostic services (Radiology - CT)
public function overall_CQI4d5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4d5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Waiting time for diagnostic services (Radiology - CT)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4d5 - Waiting time for diagnostic services (CT) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4d6 - Waiting time for diagnostic services (Radiology - MRI)
public function overall_CQI4d6_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4d6';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Waiting time for diagnostic services (Radiology - MRI)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4d6 - Waiting time for diagnostic services (MRI) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4d7 - Waiting time for diagnostic services (Radiology - USG)
public function overall_CQI4d7_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4d7';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Waiting time for diagnostic services (Radiology - USG)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4d7 - Waiting time for diagnostic services (USG) - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4d8 - Waiting Time for OPD appointments (Patient Care Services - OPD)
public function overall_CQI4d8_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4d8';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Waiting Time for OPD appointments (Patient Care Services - OPD)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4d8 - Waiting Time for OPD appointments - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4d9 - Waiting Time for OPD Walkin (Patient Care Services - OPD)
public function overall_CQI4d9_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4d9';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Waiting Time for OPD Walkin (Patient Care Services - OPD)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4d9 - Waiting Time for OPD Walkin - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4d10 - Patient Satisfaction Rate (Nursing - OBG)
public function overall_CQI4d10_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4d10';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Patient Satisfaction Rate (Nursing - OBG)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4d10 - Patient Satisfaction Rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4d11 - Turn-around Time for Nursing call bell responds (Nursing)
public function overall_CQI4d11_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4d11';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Turn-around Time for Nursing call bell responds (Nursing)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4d11 - Turn-around Time for Nursing call bell responds - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI4e1 - Employee satisfaction index (HR)
public function overall_CQI4e1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4e1';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Employee satisfaction index (HR)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4e1 - Employee satisfaction index - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4e2 - Employee attrition rate (HR)
public function overall_CQI4e2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4e2';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Employee attrition rate (HR)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4e2 - Employee attrition rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4e3 - Employee absenteeism rate (HR)
public function overall_CQI4e3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4e3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Employee absenteeism rate (HR)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4e3 - Employee absenteeism rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4e4 - Percentage of employees aware of rights, responsibility and welfare schemes (HR)
public function overall_CQI4e4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4e4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Percentage of employees aware of rights, responsibility and welfare schemes (HR)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4e4 - Employees aware of rights & welfare - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4e5 - Average number of training hours (HR)
public function overall_CQI4e5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4e5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Average number of training hours (HR)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4e5 - Average training hours - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4e6 - Nurses Attrition Rate (Nursing)
public function overall_CQI4e6_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4e6';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Nurses Attrition Rate (Nursing)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4e6 - Nurses Attrition Rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4e7 - Outsourced employee absenteeism rate (Nursing Assistants) (Patient Care Services - OPD)
public function overall_CQI4e7_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4e7';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Outsourced employee absenteeism rate (Nursing Assistants) - OPD',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4e7 - Outsourced absenteeism rate - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4e8 - Average number of unpaid leave per month (HR)
public function overall_CQI4e8_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4e8';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Average number of unpaid leave per month (HR)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4e8 - Average unpaid leave - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI4f1 - Incidence of needle stick injuries IPD area (in 1000 IPD days) (Infection Control - IPD)
public function overall_CQI4f1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4f1';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Incidence of needle stick injuries IPD area (in 1000 IPD days)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4f1 - Needle Stick Injuries IPD - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4f2 - Incidence of needle stick injuries OPD area (in 1000 OPD days) (Infection Control - OPD)
public function overall_CQI4f2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4f2';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Incidence of needle stick injuries OPD area (in 1000 OPD days)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4f2 - Needle Stick Injuries OPD - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4f3 - Percentage of sentinel events, reported, collected and analysed within defined time frame (Quality Office)
public function overall_CQI4f3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4f3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Percentage of sentinel events reported, collected & analysed',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4f3 - Sentinel Events - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4f4 - Percentage of near misses (Quality Office)
public function overall_CQI4f4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4f4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Percentage of near misses',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4f4 - Near Misses - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4f5 - Incidence of blood body fluid exposure IPD (Infection Control - IPD)
public function overall_CQI4f5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4f5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Incidence of blood body fluid exposure IPD',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4f5 - Blood Body Fluid Exposure IPD - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4f6 - Incidence of blood body fluid exposure OPD (Infection Control - OPD)
public function overall_CQI4f6_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4f6';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Incidence of blood body fluid exposure OPD',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4f6 - Blood Body Fluid Exposure OPD - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4f7 - Adverse events related to SUDs (JCI8-PCI 3.1) (CSSD)
public function overall_CQI4f7_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4f7';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Adverse events related to SUDs (JCI8-PCI 3.1)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4f7 - Adverse Events SUDs - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI4g1 - Percentage of Medical records not having discharge summary (MRD)
public function overall_CQI4g1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4g1';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Percentage of Medical records not having discharge summary',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4g1 - Discharge Summary Missing - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4g2 - Percentage of Medical records not having codification as per ICD (MRD)
public function overall_CQI4g2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4g2';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Percentage of Medical records not having codification as per ICD',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4g2 - ICD Codification Missing - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4g3 - Percentage of Medical records having improper or incomplete consent (MRD)
public function overall_CQI4g3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4g3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Percentage of Medical records having improper or incomplete consent',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4g3 - Incomplete Consent - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI4g4 - Percentage of missing medical records (MRD)
public function overall_CQI4g4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4g4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Percentage of missing medical records',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4g4 - Missing Medical Records - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI4g5 - Compliance rate of adhering with policies and procedures for care of patients at risk for suicide and self-harm (JCI8-COP 5) (MRD)
public function overall_CQI4g5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4g5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Compliance rate of adhering with policies and procedures for care of patients at risk for suicide and self-harm',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4g5 - Suicide/Self-Harm Policy Compliance - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI4g6 - Monthly Abbreviation Compliance(MRD)
public function overall_CQI4g6_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI4g6';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Monthly Abbreviation Compliance',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI4g6 - Monthly Abbreviation Compliance - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI3k1 - Total number of LAMA cases with Reasons (MRD)
public function overall_CQI3k1_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3k1';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Total number of LAMA cases with Reasons',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3k1 - Total LAMA Cases with Reasons - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI3k2 - Adverse events due to handover(Quality Office)
public function overall_CQI3k2_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3k2';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Adverse events due to handover',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3k2 - Adverse Events due to Handover - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}
// CQI3k3 - Inguinal herniorrhaphy with mesh (Infection Control)
public function overall_CQI3k3_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3k3';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Inguinal herniorrhaphy with mesh',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3k3 - Inguinal Herniorrhaphy with Mesh - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI3k4 - Coronary artery bypass grafting (CABG) (Infection Control)
public function overall_CQI3k4_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3k4';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Coronary artery bypass grafting (CABG)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3k4 - CABG - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI3k5 - Laparoscopic cholecystectomy (Infection Control)
public function overall_CQI3k5_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3k5';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Laparoscopic cholecystectomy',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3k5 - Laparoscopic Cholecystectomy - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI3k6 - Monitoring the duration of antibiotic usage in surgical prophylaxis (After 48 hours) (Clinical Pharmacy)
public function overall_CQI3k6_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3k6';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'Monitoring the duration of antibiotic usage in surgical prophylaxis (After 48 hours)',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3k6 - Antibiotic Usage Monitoring - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI3k7 - De-escalation of antibiotics (Clinical Pharmacy)
public function overall_CQI3k7_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3k7';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'De-escalation of antibiotics',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3k7 - De-escalation of Antibiotics - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}

// CQI3k8 - High Alert Medication Segregation, storage & labelling Compliance rate (Pharmacy - Store)
public function overall_CQI3k8_report()
{
    if ($this->session->userdata('isLogIn') == false) redirect('login');
    if (ismodule_active('QUALITY') === true) {
        $table_feedback = 'bf_feedback_CQI3k8';
        $table_patients = 'bf_patients';
        $desc = 'desc';
        $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);

        $header = [
            'KPI Recorded by',
            'KPI Recorded on',
            'High Alert Medication Segregation, Storage & Labelling Compliance rate',
            'Data analysis (RCA, Reason for Variation etc.)',
            'Corrective action',
            'Preventive action'
        ];

        $dataexport = [];
        foreach ($feedbacktaken as $i => $row) {
            $data = json_decode($row->dataset, true);
            $dataexport[$i]['name'] = $data['name'];
            $dataexport[$i]['date'] = date('d-M-Y', strtotime($row->datetime)) . "\n" . date('h:i A', strtotime($row->datetime));
            $dataexport[$i]['value'] = $data['value'];
            $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
            $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
            $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];
        }

        $fdate = $_SESSION['from_date'];
        $tdate = $_SESSION['to_date'];
        ob_end_clean();
        $fileName = 'EF- CQI3k8 - High Alert Medication Compliance - ' . $tdate . ' to ' . $fdate . '.csv';
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Cache-Control: private', false);
        header('Content-Type: text/csv');
        header('Content-Disposition: attachment;filename=' . $fileName);

        if (!empty($dataexport)) {
            $fp = fopen('php://output', 'w');
            fputcsv($fp, $header, ',');
            foreach ($dataexport as $values) fputcsv($fp, $values, ',');
            fclose($fp);
        }
        ob_flush();
        exit;
    } else redirect('dashboard/noaccess');
}




















    




    



    

    











    public function overall_6psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_6PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of patients developing adverse drug reactions';
            $header[4] = 'Number of in-patients';
            $header[5] = 'Percentage of in-patients developing adverse drug reaction';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 6.PSQ3a- Percentage of in-patients developing adverse drug reaction(s) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_7psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_7PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of unplanned return to OT';
            $header[4] = 'Number of patients who underwent surgeries in the OT';
            $header[5] = 'Percentage of unplanned return to OT';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 7.PSQ3a- Percentage of unplanned return to OT - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_8psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_8PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of surgeries where the procedure was followed';
            $header[4] = 'Number of surgeries performed';
            $header[5] = 'Percentage of Surgeries following adverse event prevention procedures';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 8.PSQ3a- Percentage of surgeries where the organisations procedure to prevent adverse events - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_9psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_9PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of transfusion reactions';
            $header[4] = 'Number of units transfused (in Units)';
            $header[5] = 'Percentage of transfusion reactions';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 9.PSQ3a- Percentage of transfusion reactions - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_10psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_10PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Actual deaths in ICU';
            $header[4] = 'Predicted deaths in ICU';
            $header[5] = 'Percentage of standardised mortality ratio for ICU';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 10.PSQ3a- Standardised mortality ratio for ICU - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_11psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_11PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of returns to emergency within 72 hrs with similar complaints';
            $header[4] = 'Number of patients who have come to the emergency';
            $header[5] = 'Percentage of returns to emergency within 72 hrs with similar complaints';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 11.PSQ3a- Return to the emergency within 72 hours with similar complaints - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_12psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_12PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of patients who develop new / worsening of pressure ulcer';
            $header[4] = 'Total no. of patient days';
            $header[5] = 'Incidence of hospital associated pressure ulcers after admission';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 12.PSQ3a- Incidence of hospital associated pressure ulcers after admission - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_13psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_13PSQ3b';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of urinary catheter associated UTIs';
            $header[4] = 'Number of urinary catheter days';
            $header[5] = 'Catheter associated Urinary tract infection rate';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 13.PSQ3b- Catheter associated urinary tract infection rate - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_14psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_14PSQ3b';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of ventilator associated pneumonia';
            $header[4] = 'Number of ventilator days';
            $header[5] = 'Ventilator associated pneumonia rate';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 14.PSQ3b- Ventilator associated pneumonia rate - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_15psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_15PSQ3b';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of central line - associated blood stream infections';
            $header[4] = 'No. of central line days';
            $header[5] = 'Central line - associated blood stream infection rate';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 15.PSQ3b- Central line - associated blood stream infection rate - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_16psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_16PSQ3b';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of surgical site infections';
            $header[4] = 'Number of surgeries performed';
            $header[5] = 'Surgical site infection rate';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 16.PSQ3b- Surgical site infection rate - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_17psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_17PSQ3b';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of hand hygiene actions performed';
            $header[4] = 'Number of hand hygiene opportunities';
            $header[5] = 'Hand hygiene compliance rate';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 17.PSQ3b- Hand hygiene compliance rate - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_18psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_18PSQ3b';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of patients who receive appropriate prophylactic antibiotic';
            $header[4] = 'Number of patients who underwent surgeries in the OT';
            $header[5] = 'Percentage of cases who received appropriate prophylactic antibiotics';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 18.PSQ3b- Percentage of cases who received appropriate prophylactic antibiotics - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_19psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_19PSQ3c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of cases rescheduled';
            $header[4] = 'Number of surgeries planned';
            $header[5] = 'Percentage of re-scheduling of surgeries';

            $j = 6;


            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                echo '<pre>';
                print_r($data);
                echo '</pre>';
                exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 19.PSQ3c- Percentage of re- scheduling of surgeries - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_20psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_20PSQ3c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of cases rescheduled';
            $header[4] = 'Number of surgeries planned';
            $header[5] = 'Percentage of re-scheduling of surgeries';

            $j = 6;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 20.PSQ3c- Turn around time for issue of blood and blood components - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_21psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_21PSQ3c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of nursing staff';
            $header[4] = 'Number of occupied beds';
            $header[5] = 'Nurse-patient ratio for ICU';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 21.PSQ3c- Nurse-patient ratio for ICUs - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_21apsq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_21aPSQ3c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of nursing staff';
            $header[4] = 'Number of occupied beds';
            $header[5] = 'Nurse-patient ratio for Ward';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 21a.PSQ3c- Nurse-patient ratio for Wards - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_22psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_22PSQ3c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Sum of total time for consultation';
            $header[4] = 'Total number of out-patients';
            $header[5] = 'Avg. waiting time for out-patient consultation';

            $j = 6;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 22.PSQ3c - Waiting time for out- patient consultation - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_23apsq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_23aPSQ4c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Sum of total patient reporting time';
            $header[4] = 'Number of patients reported in laboratory';
            $header[5] = 'Avg. waiting time for laboratory';

            $j = 6;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 23a.PSQ4c- Waiting time for laboratory diagnostics - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_23bpsq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_23bPSQ4c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Sum of total patient reporting time';
            $header[4] = 'Number of patients reported in X-Ray';
            $header[5] = 'Avg. waiting time for X-Ray';

            $j = 6;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 23b.PSQ4c- Waiting time for X-ray diagnostics - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_23cpsq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_23cPSQ4c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Sum of total patient reporting time';
            $header[4] = 'Number of patients reported in USG';
            $header[5] = 'Avg. waiting time for USG';

            $j = 6;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 23c.PSQ4c- Waiting time for USG diagnostics - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_23dpsq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_23dPSQ4c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Sum of total patient reporting time';
            $header[4] = 'Number of patients reported in CT scan';
            $header[5] = 'Avg. waiting time for CT scan';

            $j = 6;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 23d.PSQ4c- Waiting time for CT scan diagnostics - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }



    public function overall_24gpsq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_24PSQ4c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Sum of time taken for discharge';
            $header[4] = 'Number of patients discharged';
            $header[5] = 'Avg. time taken for discharge';

            $j = 6;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 24.PSQ4c- Time taken for discharge(General Patients) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_24ipsq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_24PSQ4c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Sum of time taken for discharge';
            $header[4] = 'Number of patients discharged';
            $header[5] = 'Avg. time taken for discharge';

            $j = 6;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 24.PSQ4c- Time taken for discharge(Insurance Patients) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_24cpsq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_24PSQ4c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Sum of time taken for discharge';
            $header[4] = 'Number of patients discharged';
            $header[5] = 'Avg. time taken for discharge';

            $j = 6;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 24.PSQ4c- Time taken for discharge(Corporate Patients) - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_25psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_25PSQ4c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of medical records having incomplete/ improper consent';
            $header[4] = 'Number of discharges and deaths';
            $header[5] = 'Percentage of medical records having incomplete/ improper consent';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 25.PSQ4c- Percentage of medical records having incomplete/ improper consent - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_26psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_26PSQ4c';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of stock outs of emergency drugs';
            $header[4] = 'Number of drugs listed as emergency drugs';
            $header[5] = 'Percentage of stock out rate for emergency medications';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 26.PSQ4c- Stock out rate of emergency medications - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_27psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_27PSQ4d';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of variations observed in a mock drill';
            $header[4] = 'Number of opportunities of variations';
            $header[5] = 'Percentage of number of variations observed in mock';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 27.PSQ4d- Number of variations observed in mock drills - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_28psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_28PSQ4d';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of patient falls';
            $header[4] = 'Total number of patient days';
            $header[5] = 'Patient fall rate';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 28.PSQ4d- Patient fall rate - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_29psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_29PSQ4d';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of near misses reported';
            $header[4] = 'Number of incidents reported';
            $header[5] = 'Percentage of near misses';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 29.PSQ4d- Percentage of near misses - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_30psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_30PSQ3d';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of parenteral exposures';
            $header[4] = 'Number of in-patient days';
            $header[5] = 'Incidence of needle stick injuries';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 30.PSQ3d- Incidence of needle stick injuries - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_31psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_31PSQ3d';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of handovers done appropriately';
            $header[4] = 'Number of handover opportunities';
            $header[5] = 'Percentage of appropriate handovers during shift change';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 31.PSQ3d- Appropriate handovers during shift change - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_32psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_32PSQ3d';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of prescriptions in capital letters';
            $header[4] = 'Number of prescriptions';
            $header[5] = 'Percentage of compliance rate to prescription in capitals';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- 32.PSQ3d- Compliance rate to medication prescription in capitals - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of readmission to ICU within 48 hours';
            $header[4] = 'Number of admissions';
            $header[5] = 'Percentage of readmission rate';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a - Readmission to ICU within 48 hours after being discharged - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_33psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_33PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of patients discharged with diagnosis of CHF with reduced EF';
            $header[4] = 'Number of patients discharged with diagnosis of CHF';
            $header[5] = 'Percentage of Beta-blocker prescription with diagnosis of CHF with reduced EF';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a - Percentage of Beta-blocker prescription with a diagnosis of CHF with reduced EF - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_34psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_34PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of AMI patients during primary angioplasty for whom door to balloon time of 90 minutes is achieved';
            $header[4] = 'Number of AMI patients undergoing primary angioplasty';
            $header[5] = 'Percentage of patients with myocardial infarction for whom door to balloon time of 90 minutes';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Percentage of patients with myocardial infarction for whom door to balloon time of 90 minutes is achieved - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_35psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_35PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of patients with hypoglycemic events where the target glucose level was achieved';
            $header[4] = 'Number of patients with hypoglycemic events';
            $header[5] = 'Percentage of hospitalized patients with hypoglycemia who achieved blood glucose level';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Percentage of Hospitalized patients with hypoglycemia who achieved targeted blood glucose level - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_36psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_36PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of cases where a spontaneous perineal tear occurs';
            $header[4] = 'Number of vaginal deliveries';
            $header[5] = 'Percentage of cases where a spontaneous perineal tear occurs';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Spontaneous Perineal Tear Rate - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_37psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_37PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of cases of postoperative endophthalmitis';
            $header[4] = 'Number of ophthalmic surgeries';
            $header[5] = 'Percentage of cases where postoperative endophthalmitis occurs';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Postoperative Endophthalmitis Rate - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_38psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_38PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of patients sedated for the colonoscopy procedure';
            $header[4] = 'Number of patients undergoing colonoscopy';
            $header[5] = 'Percentage of patients undergoing colonoscopy who are sedated';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Percentage of patients undergoing colonoscopy who are sedated - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_39psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_39PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of cases where bile duct injuries occurred';
            $header[4] = 'Laparoscopic cholecystectomies performed';
            $header[5] = 'Bile Duct Injury Rate';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a - Bile Duct injury rate requiring operative intervention during Laparoscopic cholecystectomy - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_40psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_40PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Number of POCT tests which resulted in clinical intervention';
            $header[4] = 'Number of POCT tests where clinical intervention was necessary';
            $header[5] = 'Percentage of POCT results that led to clinical intervention';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Percentage of POCT results which led to a clinical intervention - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_41psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_41PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Sum of functional gain patients in neurorehabilitation';
            $header[4] = 'Number of patients undergoing neurorehabilitation';
            $header[5] = 'Percentage of neurorehabilitation patient with functional gain';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Functional gain following rehabilitation - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_42psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_42PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'No.of sepsis patients receiving Hour-1 bundle care';
            $header[4] = 'Total number of sepsis cases';
            $header[5] = 'Percentage of sepsis patients receiving Hour-1 bundle care';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Percentage of sepsis patients who receive care as per the Hour-1 sepsis bundle - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_43psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_43PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'No. of COPD patients provided with COPD action plan';
            $header[4] = 'No. of COPD patients discharged';
            $header[5] = 'Percentage of COPD patients receiving COPD action plan at the time of discharge';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Percentage of COPD patients receiving COPD Action plan at the time of discharge - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_44psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_44PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'No. of stroke patients with DTN time within 60 minutes';
            $header[4] = 'No. of stroke patients receiving thrombolytic therapy';
            $header[5] = 'Percentage of stroke patients with DTN time within 60 minutes';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Percentage of stroke patients in whom the Door-to-Needle Time (DTN) of 60 minutes is achieved  - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_45psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_45PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'No. of patients treated inappropriately';
            $header[4] = 'Total no. of patients with bronchiolitis';
            $header[5] = 'Percentage of bronchiolitis patients treated inappropriately';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Percentage of bronchiolitis patients treated inappropriately  - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_46psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_46PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'No. of oncology patients treated post tumour board';
            $header[4] = 'No. of oncology cases treated';
            $header[5] = 'Percentage of oncology patients treated post tumour board';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Percentage of oncology patients who had treatment initiated following Multidisciplinary meeting  - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_47psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_47PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'No. of patients who developed adverse reaction';
            $header[4] = 'No. of patients receiving the radiopharmaceutical';
            $header[5] = 'Percentage of adverse reaction to radiopharmaceutical';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Percentage of adverse reaction to radiopharmaceutical  - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_48psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_48PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'No. of contrast extravasation';
            $header[4] = 'No. of patients receiving contrast';
            $header[5] = 'Percentage of Intravenous contrast media extravasation';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Percentage of Intravenous Contrast Media Extravasation  - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_49psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_49PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'Sum of time taken for triage';
            $header[4] = 'Total no. of patients coming to the emergency';
            $header[5] = 'Avg. waiting time for triage';

            $j = 6;

            $header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                $dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a- Time taken for triage  - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_50psq3a_report()
    {

        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback_50PSQ3a';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $header[0] = 'Recorded by';
            $header[1] = 'Month - Year';
            $header[2] = 'Employee details';
            $header[3] = 'No. of dialysis patients with target hemoglobin';
            $header[4] = 'Total no. of patients undergoing dialysis';
            $header[5] = 'Percentage of dialysis patients with target hemoglobin levels';

            $j = 6;

            //$header[$j++] = 'Benchmark time';
            $header[$j++] = 'Data analysis';
            $header[$j++] = 'Corrective action';
            $header[$j++] = 'Preventive action';

            $dataexport = [];
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);

                // echo '<pre>';
                // print_r($data);
                // echo '</pre>';
                // exit;

                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['date'] = date('M-Y', strtotime($row->datetime));
                $dataexport[$i]['patient_id'] = $data['name'] . "<" . $data['patientid'] . ">\n" .
                    $data['contactnumber'] . "\n" .
                    $data['email'];

                $dataexport[$i]['initial_assessment_hr'] = $data['initial_assessment_hr'];
                $dataexport[$i]['total_admission'] = $data['total_admission'];
                $dataexport[$i]['calculatedResult'] = $data['calculatedResult'];
                //$dataexport[$i]['benchmark'] = $data['benchmark'];
                $dataexport[$i]['dataAnalysis'] = $data['dataAnalysis'];
                $dataexport[$i]['correctiveAction'] = $data['correctiveAction'];
                $dataexport[$i]['preventiveAction'] = $data['preventiveAction'];

                $i++;
            }


            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF- PSQ3a-  Percentage of patients undergoing dialysis who are able to achieve target hemoglobin levels  - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    //consoldited report 
    public function export_all_kpi()
    {
        $this->load->library('spreadsheet');

        // Define KPI tables and headers
        $kpiList = [
            [
                'table' => 'bf_feedback_1PSQ3a',
                'sheet' => '1.PSQ3a- Initial Assessment',
                'header' => [
                    'Recorded by',
                    'Month - Year',
                    'Employee details',
                    'Sum of time taken for initial assessment',
                    'Total number of admissions',
                    'Avg. time taken for initial assessment',
                    'Benchmark time',
                    'Data analysis',
                    'Corrective action',
                    'Preventive action'
                ]
            ],
            [
                'table' => 'bf_feedback_2PSQ3a',
                'sheet' => '2.PSQ3a- Number of reporting errors',
                'header' => [
                    'Recorded by',
                    'Month - Year',
                    'Employee details',
                    'No. of reporting errors',
                    'No. of tests performed',
                    'No. of reporting errors per 1000 investigations',
                    'Data analysis',
                    'Corrective action',
                    'Preventive action'
                ]
            ],
        ];

        $firstSheet = true;
        foreach ($kpiList as $kpi) {
            $feedbackData = $this->quality_model->patient_and_feedback('bf_patients', $kpi['table'], 'desc');

            // Create valid sheet name (max 31 chars)
            $sheetName = substr($kpi['sheet'], 0, 31);

            if ($firstSheet) {
                $sheet = $this->spreadsheet->getActiveSheet();
                $sheet->setTitle($sheetName);
                $firstSheet = false;
            } else {
                $sheet = $this->spreadsheet->addSheetWithTitle($sheetName);
            }

            $sheet->fromArray([$kpi['header']], null, 'A1');

            $rowIndex = 2;
            foreach ($feedbackData as $row) {
                $data = json_decode($row->dataset, true);

                if ($kpi['table'] === 'bf_feedback_1PSQ3a') {
                    $rowValues = [
                        $data['name'],
                        date('M-Y', strtotime($row->datetime)),
                        $data['name'] . "<" . $data['patientid'] . ">\n" . $data['contactnumber'] . "\n" . $data['email'],
                        $data['initial_assessment_total'],
                        $data['total_admission'],
                        $data['calculatedResult'],
                        $data['benchmark'],
                        $data['dataAnalysis'],
                        $data['correctiveAction'],
                        $data['preventiveAction']
                    ];
                } elseif ($kpi['table'] === 'bf_feedback_2PSQ3a') {
                    $rowValues = [
                        $data['name'],
                        date('M-Y', strtotime($row->datetime)),
                        $data['name'] . "<" . $data['patientid'] . ">\n" . $data['contactnumber'] . "\n" . $data['email'],
                        $data['initial_assessment_hr'],
                        $data['total_admission'],
                        $data['calculatedResult'],
                        $data['dataAnalysis'],
                        $data['correctiveAction'],
                        $data['preventiveAction']
                    ];
                }

                $sheet->fromArray([$rowValues], null, 'A' . $rowIndex);
                $sheet->getStyle('C' . $rowIndex)->getAlignment()->setWrapText(true);
                $rowIndex++;
            }
        }

        $this->spreadsheet->download('NABH_KPI_Report.xlsx');
    }



    //END OF QUAILTY KPI




    // IP DASHBOARD DOWNLOADS

    public function downloadcomments()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $table_feedback = 'bf_feedback';
            $table_patients = 'bf_patients';
            $desc = 'desc';
            $setup = 'setup';

            $feedbacktaken = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $desc);
            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();
            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }
            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();
            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }

            $header[0] = 'Date';
            $header[1] = 'Patient Name';
            $header[2] = 'Patient ID';
            $header[3] = 'Floor/Ward';
            $header[4] = 'Room/Bed';
            $header[5] = 'Mobile Number';
            $j = 6;
            $header[$j++] = 'Average Rating';
            $header[$j++] = 'NPS Score';
            $header[$j++] = 'Comments';
            foreach ($setarray as $r) {
                $header[$j] = $r;
                $j++;
            }
            $dataexport = array();
            $i = 0;
            foreach ($feedbacktaken as $row) {
                $data = json_decode($row->dataset, true);
                $dataexport[$i]['date'] = date('d-m-Y', strtotime($row->datetime));
                $dataexport[$i]['name'] = $data['name'];
                $dataexport[$i]['patient_id'] = $data['patientid'];
                $dataexport[$i]['ward'] = $data['ward'];
                $dataexport[$i]['bedno'] = $data['bedno'];
                $dataexport[$i]['mobile'] = $data['contactnumber'];
                $dataexport[$i]['overallScore'] = $data['overallScore'];
                $dataexport[$i]['recommend1Score'] = ($data['recommend1Score']) * 2;

                $dataexport[$i]['suggestionText'] = $data['suggestionText'];
                foreach ($setarray as $key => $t) {
                    if ($data['comment'][$key] != '') {
                        $dataexport[$i][$key] = $data['comment'][$key];
                    } else {
                        $dataexport[$i][$key] = '';
                    }
                }
                $i++;
            }
            $newdataset = $dataexport;
            $d = array();
            $p = array();
            $n = array();
            $para = array();
            $for5 = array();
            $for4 = array();
            $for3 = array();
            $for2 = array();
            $for1 = array();
            foreach ($dataexport as $row) {
                foreach ($row as $k => $r) {
                    if ($r * 1 > 0) {
                        $d[$k] = $d[$k] + 1;
                        if ($r > 2) {
                            $p[$k] = $p[$k] + 1;
                        } else {
                            $n[$k] = $n[$k] + 1;
                        }
                        $para[$k] = $para[$k] + $r;
                        if ($k == 'overallScore') {
                            if ($r == 5) {
                                $for5[$k] = $for5[$k] + 1;
                            }
                            if ($r == 4) {
                                $for4[$k] = $for4[$k] + 1;
                            }
                            if ($r == 3) {
                                $for3[$k] = $for3[$k] + 1;
                            }
                            if ($r == 2) {
                                $for2[$k] = $for2[$k] + 1;
                            }
                            if ($r == 1) {
                                $for1[$k] = $for1[$k] + 1;
                            }
                        }
                    }
                }
            }

            ob_end_clean();
            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];

            $fileName = 'EF- IPD PATIENT COMMENTS - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }



    public function overall_excel_report()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $table_feedback = 'bf_feedback';
            $table_patients = 'bf_patients';
            $sorttime = 'asc';
            $setup = 'setup';
            $asc = 'asc';
            $desc = 'desc';
            $table_tickets = 'tickets';
            $open = 'Open';
            $closed = 'Closed';
            $addressed = 'Addressed';
            $type = 'inpatient';

            $ip_feedbacks_count = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $sorttime, $setup);
            $ticket_resolution_rate = $this->quality_model->ticket_resolution_rate($table_tickets, $closed, $table_feedback);
            $ip_tickets_count = $this->tickets_model->alltickets();
            $ip_open_tickets = $this->tickets_model->read();
            $ip_closed_tickets = $this->tickets_model->read_close();
            $ip_addressed_tickets = $this->tickets_model->addressedtickets();

            $ip_nps = $this->quality_model->nps_analytics($table_feedback, $asc, $setup);
            $ip_psat = $this->quality_model->psat_analytics($table_patients, $table_feedback, $table_tickets, $sorttime);

            $dataexport = array();
            $i = 0;

            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];

            $dataexport[$i]['row1'] = 'IPD FEEDBACK OVERALL REPORT';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'FROM DATE';
            $dataexport[$i]['row2'] = $tdate;
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'TO DATE';
            $dataexport[$i]['row2'] = $fdate;
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'TOTAL FEEDBACKS SUBMITTED';
            $dataexport[$i]['row2'] = count($ip_feedbacks_count);
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = '';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;


            $dataexport[$i]['row1'] = 'SATISFACTION INDEX';
            $dataexport[$i]['row2'] = $ip_psat['psat_score'] . '%';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'SATISFIED PATIENTS';
            $dataexport[$i]['row2'] =  $ip_psat['satisfied_count'];
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'UNSATISFIED PATIENTS';
            $dataexport[$i]['row2'] = $ip_psat['unsatisfied_count'];
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = '';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            //add here
            $dataexport[$i]['row1'] = 'NET PROMOTER SCORE';
            $dataexport[$i]['row2'] =  $ip_nps['nps_score'] . '%';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'NO. OF PROMOTERS';
            $dataexport[$i]['row2'] = $ip_nps['promoters_count'];
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'NO. OF PASSIVES';
            $dataexport[$i]['row2'] = $ip_nps['passives_count'];
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'NO. OF DETRACTORS';
            $dataexport[$i]['row2'] = $ip_nps['detractors_count'];
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;


            $dataexport[$i]['row1'] = '';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;


            $dataexport[$i]['row1'] = 'TICKETS REPORT';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'TOTAL TICKETS';
            $dataexport[$i]['row2'] = count($ip_tickets_count);
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'TICKET RESOLUTION RATE';
            $dataexport[$i]['row2'] = $ticket_resolution_rate . '%';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;
            $dataexport[$i]['row1'] = 'OPEN TICKETS';
            $dataexport[$i]['row2'] = count($ip_open_tickets);
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;
            if (ticket_addressal('ip_addressal') === true) {
                $dataexport[$i]['row1'] = 'ADDRESSED TICKETS';
                $dataexport[$i]['row2'] = count($ip_addressed_tickets);
                $dataexport[$i]['row3'] = '';
                $dataexport[$i]['row4'] = '';
                $i++;
            }
            $dataexport[$i]['row1'] = 'CLOSED TICKETS';
            $dataexport[$i]['row2'] = count($ip_closed_tickets);
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = '';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;



            $dataexport[$i]['row1'] = 'TICKETS RECEIVED BY DEPARTMENT';
            $dataexport[$i]['row2'] = 'PERCENTAGE';
            $dataexport[$i]['row3'] = 'COUNT';
            $dataexport[$i]['row4'] = 'OPEN';
            if (ticket_addressal('ip_addressal') === true) {

                $dataexport[$i]['row5'] = 'ADDRESSED';
            }
            $dataexport[$i]['row6'] = 'CLOSED';
            $dataexport[$i]['row7'] = 'RESOLUTION RATE';
            $dataexport[$i]['row8'] = 'RESOLUTION TIME';
            $dataexport[$i]['row9'] = '';
            $i++;

            $ticket = $this->quality_model->tickets_recived_by_department($type, $table_feedback, $table_tickets);
            foreach ($ticket as $ps) {
                $time = secondsToTimeforreport($ps['res_time']);
                $dataexport[$i]['row1'] = $ps['department'];
                $dataexport[$i]['row2'] = $ps['percentage'] . '%';
                $dataexport[$i]['row3'] = $ps['count'];
                $dataexport[$i]['row4'] = $ps['open_tickets'];
                if (ticket_addressal('ip_addressal') === true) {

                    $dataexport[$i]['row5'] = $ps['addressed_tickets'];
                }
                $dataexport[$i]['row6'] = $ps['closed_tickets'];
                $dataexport[$i]['row6'] = $ps['closed_tickets'];
                $dataexport[$i]['row7'] = $ps['tr_rate'] . '%';
                $dataexport[$i]['row8'] = $time;
                $dataexport[$i]['row9'] = '';
                $i++;
            }

            $dataexport[$i]['row1'] = '';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;


            $dataexport[$i]['row1'] = 'WHY PATIENTS CHOSE YOUR HOSPITAL';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'REASON';
            $dataexport[$i]['row2'] = 'PERCENTAGE';
            $dataexport[$i]['row3'] = 'COUNT';
            $dataexport[$i]['row4'] = '';
            $i++;


            $choice_of_hospitals = $this->quality_model->reason_to_choose_hospital($table_feedback, $sorttime);

            foreach ($choice_of_hospitals as $key => $object) {

                $dataexport[$i]['row1'] = $object->title;
                $dataexport[$i]['row2'] =  $object->percentage . '%';
                $dataexport[$i]['row3'] = $object->count;
                $dataexport[$i]['row4'] = '';
                $i++;
            }


            $dataexport[$i]['row1'] = '';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = '';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;
            //echo '<pre>';
            //print_r($dataexport); exit; 
            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            ob_end_clean();
            $fileName = 'EF - OVERALL IPD FEEDBACKS REPORT  - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                //fputcsv($fp, $header,',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }


    public function overall_department_excel()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {


            $dataexport = array();
            $i = 0;
            $table_feedback = 'bf_feedback';
            $table_patients = 'bf_patients';
            $sorttime = 'asc';
            $setup = 'setup';
            $asc = 'asc';
            $desc = 'desc';
            $table_tickets = 'tickets';
            $open = 'Open';
            $closed = 'Closed';
            $addressed = 'Addressed';
            $type = 'inpatient';

            $ip_tickets_count = $this->tickets_model->alltickets();
            $ip_open_tickets = $this->tickets_model->read();
            $ip_closed_tickets = $this->tickets_model->read_close();
            $ip_addressed_tickets = $this->tickets_model->addressedtickets();
            $ip_feedbacks_count = $this->quality_model->patient_and_feedback($table_patients, $table_feedback, $sorttime, $setup);

            $ticket_resolution_rate = $this->quality_model->ticket_resolution_rate($table_tickets, $closed, $table_feedback);

            $sresult = $this->quality_model->setup_result($setup);
            $setarray = array();
            $questioarray = array();

            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];

            $dataexport[$i]['row1'] = 'TICKETS REPORT';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;


            $dataexport[$i]['row1'] = 'FROM DATE';
            $dataexport[$i]['row2'] = $tdate;
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'TO DATE';
            $dataexport[$i]['row2'] = $fdate;
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'TOTAL FEEDBACKS SUBMITTED';
            $dataexport[$i]['row2'] = count($ip_feedbacks_count);
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = '';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;


            $dataexport[$i]['row1'] = 'TOTAL TICKETS';
            $dataexport[$i]['row2'] = count($ip_tickets_count);
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'TICKET RESOLUTION RATE';
            $dataexport[$i]['row2'] = $ticket_resolution_rate . '%';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = 'OPEN TICKETS';
            $dataexport[$i]['row2'] = count($ip_open_tickets);
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;


            if (ticket_addressal('ip_addressal') === true) {
                $dataexport[$i]['row1'] = 'ADDRESSED TICKETS';
                $dataexport[$i]['row2'] = count($ip_addressed_tickets);
                $dataexport[$i]['row3'] = '';
                $dataexport[$i]['row4'] = '';
                $i++;
            }

            $dataexport[$i]['row1'] = 'CLOSED TICKETS';
            $dataexport[$i]['row2'] = count($ip_closed_tickets);
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $dataexport[$i]['row1'] = '';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;


            $dataexport[$i]['row1'] = 'TICKETS RECEIVED BY DEPARTMENT';
            $dataexport[$i]['row2'] = 'PERCENTAGE';
            $dataexport[$i]['row3'] = 'COUNT';
            $dataexport[$i]['row4'] = 'OPEN';
            if (ticket_addressal('ip_addressal') === true) {
                $dataexport[$i]['row5'] = 'ADDRESSED';
            }
            $dataexport[$i]['row6'] = 'CLOSED';
            $dataexport[$i]['row7'] = 'RESOLUTION RATE';
            $dataexport[$i]['row8'] = 'RESOLUTION TIME';
            $dataexport[$i]['row9'] = '';
            $i++;

            $ticket = $this->quality_model->tickets_recived_by_department($type, $table_feedback, $table_tickets);
            foreach ($ticket as $ps) {
                $time = secondsToTimeforreport($ps['res_time']);
                $dataexport[$i]['row1'] = $ps['department'];
                $dataexport[$i]['row2'] = $ps['percentage'] . '%';
                $dataexport[$i]['row3'] = $ps['count'];
                $dataexport[$i]['row4'] = $ps['open_tickets'];
                if (ticket_addressal('ip_addressal') === true) {
                    $dataexport[$i]['row5'] = $ps['addressed_tickets'];
                }
                $dataexport[$i]['row6'] = $ps['closed_tickets'];
                $dataexport[$i]['row7'] = $ps['tr_rate'] . '%';
                $dataexport[$i]['row8'] = $time;
                $dataexport[$i]['row9'] = '';
                $i++;
            }


            $dataexport[$i]['row1'] = '';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;


            foreach ($sresult as $r) {
                $setarray[$r->type] = $r->title;
            }

            foreach ($sresult as $r) {
                $questioarray[$r->type][$r->shortkey] = $r->shortname;
            }

            $arraydata = array();

            foreach ($questioarray as $setr) {
                foreach ($setr as $k => $v) {
                    $arraydata[$k] = $v;
                }
            }


            $dataexport[$i]['row1'] = 'DEPARTMENT WISE FEEDBACK REPORT';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            $k = 2;
            $dataexport[$i]['name'] = 'TITLE';
            foreach ($arraydata as $k => $r) {
                $dataexport[$i][$k] = $r;
                $k++;
            }
            $i++;



            $d = array();
            $p = array();
            $n = array();
            $para = array();
            $for5 = array();
            $for4 = array();
            $for3 = array();
            $for2 = array();
            $for1 = array();

            foreach ($ip_feedbacks_count as $row) {
                $data = json_decode($row->dataset, true);
                $dataexportt[$i]['name'] = $data['name'];
                $dataexportt[$i]['patient_id'] = $data['patientid'];
                $dataexportt[$i]['mobile'] = $data['mobile'];
                $dataexportt[$i]['email'] = $data['email'];
                foreach ($arraydata as $k => $r) {
                    $dataexportt[$i][$k] = $data[$k];
                }
                $dataexportt[$i]['overallScore'] = $data['overallScore'];
                $i++;
            }
            $i++;

            foreach ($dataexportt as $row) {
                foreach ($row as $k => $r) {
                    if ($r * 1 > 0) {
                        $d[$k] = $d[$k] + 1;
                        if ($r > 2) {
                            $p[$k] = $p[$k] + 1;
                        } else {
                            $n[$k] = $n[$k] + 1;
                        }
                        $para[$k] = $para[$k] + $r;
                        if ($k == 'overallScore') {
                            if ($r == 5) {
                                $for5[$k] = $for5[$k] + 1;
                            }
                            if ($r == 4) {
                                $for4[$k] = $for4[$k] + 1;
                            }
                            if ($r == 3) {
                                $for3[$k] = $for3[$k] + 1;
                            }
                            if ($r == 2) {
                                $for2[$k] = $for2[$k] + 1;
                            }
                            if ($r == 1) {
                                $for1[$k] = $for1[$k] + 1;
                            }
                        }
                    }
                }
            }

            $dataexport[$i]['name'] = 'RELATIVE PERFORMANCE';
            foreach ($arraydata as $k => $r) {
                if ($d[$k] * 5 != 0) {
                    $dataexport[$i][$k] = round(($para[$k] / ($d[$k] * 5)) * 100) . '%';
                } else {
                    $dataexport[$i][$k] = '-';  // or some other value that indicates undefined or not applicable
                }
            }
            $i++;

            $dataexport[$i]['name'] = 'MAXIMUM SCORE';
            foreach ($arraydata as $k => $r) {
                $dataexport[$i][$k] = $d[$k] * 5;
            }
            $i++;

            $dataexport[$i]['name'] = 'PARAMETER SCORE';
            foreach ($arraydata as $k => $r) {
                $dataexport[$i][$k] = $para[$k];
            }
            $i++;

            $dataexport[$i]['name'] = 'POSITIVE RATINGS RECIEVED';
            foreach ($arraydata as $k => $r) {
                $dataexport[$i][$k] = $p[$k];
            }
            $i++;

            $dataexport[$i]['name'] =  'NEGATIVE RATINGS RECIEVED';
            foreach ($arraydata as $k => $r) {
                $dataexport[$i][$k] = $n[$k];
            }
            $i++;


            $dataexport[$i]['name'] = 'TOTAL RESPONSES';
            foreach ($arraydata as $k => $r) {
                $dataexport[$i][$k] = $d[$k];
            }
            $i++;


            $dataexport[$i]['row1'] = '';
            $dataexport[$i]['row2'] = '';
            $dataexport[$i]['row3'] = '';
            $dataexport[$i]['row4'] = '';
            $i++;

            // $header1='sdgf';
            ob_end_clean();
            $fileName = 'EF- IPD DEPARTMENT WISE TICKET REPORT - ' . $tdate . ' to ' . $fdate . '.csv';
            header('Pragma: public');
            header('Expires: 0');
            header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
            header('Cache-Control: private', false);
            header('Content-Type: text/csv');
            header('Content-Disposition: attachment;filename=' . $fileName);
            if (isset($dataexport[0])) {
                $fp = fopen('php://output', 'w');
                //print_r($header);
                fputcsv($fp, $header, ',');
                foreach ($dataexport as $values) {
                    //print_r($values); exit;
                    fputcsv($fp, $values, ',');
                }
                fclose($fp);
            }
            ob_flush();
            exit;
        } else {
            redirect('dashboard/noaccess');
        }
    }

    public function overall_pdf_report()
    {
        if ($this->session->userdata('isLogIn') == false)
            redirect('login');
        if (ismodule_active('QUALITY') === true) {

            $fdate = $_SESSION['from_date'];
            $tdate = $_SESSION['to_date'];
            redirect('pdfreport/ip_pdf_report?fdate=' . $tdate . '&tdate=' . $fdate);
            // redirect('report/ip_capa_report');

        } else {
            redirect('dashboard/noaccess');
        }
    }
}
